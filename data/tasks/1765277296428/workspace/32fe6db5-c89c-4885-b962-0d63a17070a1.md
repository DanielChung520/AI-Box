# Mermaid 图表转 PNG 工具使用说明

## 功能

将 Markdown 文件中的 Mermaid 代码块自动转换为 PNG 图片。

## 安装依赖

### 方法一：全局安装（推荐）

```bash
npm install -g @mermaid-js/mermaid-cli
```

### 方法二：项目本地安装

```bash
npm install
```

这会安装 `@mermaid-js/mermaid-cli` 作为开发依赖。

## 使用方法

### 基本用法

```bash
# 使用 npm 脚本
npm run mermaid <markdown文件路径>

# 或直接使用
node src/mermaid-to-png.js <markdown文件路径>
```

### 示例

```bash
# 转换单个文件
npm run mermaid pages/傑羅德/宏康需求規劃-AI智能商業培訓平台計劃書.md

# 转换后图片会保存在 mermaid-images/ 目录
```

### 高级选项

```bash
# 指定输出目录
npm run mermaid pages/文件.md --output-dir images

# 指定输出格式（png, svg, pdf）
npm run mermaid pages/文件.md --format svg

# 指定主题（default, dark, forest, neutral）
npm run mermaid pages/文件.md --theme dark

# 指定背景色
npm run mermaid pages/文件.md --background "#ffffff"

# 组合使用
npm run mermaid pages/文件.md -o images -f png -t dark -b "#1e1e1e"
```

## 选项说明

| 选项 | 简写 | 说明 | 默认值 |
|------|------|------|--------|
| `--output-dir` | `-o` | 输出目录 | `mermaid-images` |
| `--format` | `-f` | 输出格式：png, svg, pdf | `png` |
| `--theme` | `-t` | 主题：default, dark, forest, neutral | `default` |
| `--background` | `-b` | 背景色 | `white` |

## 输出文件命名规则

输出文件名格式：`<原文件名>-<类型>-<序号>.<格式>`

例如：
- `宏康需求規劃-AI智能商業培訓平台計劃書-timeline-1.png`
- `宏康需求規劃-AI智能商業培訓平台計劃書-gantt-2.png`

## 支持的 Mermaid 图表类型

- Timeline（时间线）
- Gantt（甘特图）
- Graph/Flowchart（流程图）
- Sequence Diagram（时序图）
- Class Diagram（类图）
- ER Diagram（实体关系图）

## 注意事项

1. **首次使用前**：需要先安装 `@mermaid-js/mermaid-cli`
2. **输出目录**：如果输出目录不存在，会自动创建
3. **临时文件**：转换过程中会创建临时文件，转换完成后自动删除
4. **错误处理**：如果某个图表转换失败，会继续处理其他图表

## 故障排除

### 问题：提示 "未安装 mermaid-cli"

**解决方案**：
```bash
# 全局安装
npm install -g @mermaid-js/mermaid-cli

# 或使用项目本地安装
npm install
npx mmdc --version
```

### 问题：转换失败

**可能原因**：
1. Mermaid 代码语法错误
2. 图表类型不支持
3. 输出目录权限问题

**解决方案**：
1. 检查 Mermaid 代码语法
2. 确认输出目录有写入权限
3. 查看错误信息中的具体提示

## 示例工作流程

```bash
# 1. 安装依赖（首次使用）
npm install

# 2. 转换 Mermaid 图表
npm run mermaid pages/傑羅德/宏康需求規劃-AI智能商業培訓平台計劃書.md

# 3. 查看生成的图片
ls mermaid-images/

# 4. 使用不同主题转换
npm run mermaid pages/文件.md -t dark -o dark-images
```

## 批量转换

如果需要批量转换多个文件，可以创建一个简单的脚本：

```bash
#!/bin/bash
for file in pages/傑羅德/*.md; do
  npm run mermaid "$file" -o "mermaid-images/$(basename "$file" .md)"
done
```

