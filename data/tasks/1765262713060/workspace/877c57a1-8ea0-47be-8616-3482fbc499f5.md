# Notion CLI 使用指南

## 🚀 快速开始

```bash
# 使用 npm 脚本（推荐）
npm run notion <command>

# 或直接使用
node src/cli.js <command>
```

---

## 📋 命令列表

### 1️⃣ 查找页面（精确查询）

**命令：**
```bash
npm run notion find "页面标题"
```

**示例：**
```bash
npm run notion find "培訓學院暨媒合平台 AI 助手-系統分析SA"
```

**输出：**
- ✅ 显示匹配的页面列表
- 📄 包含页面 ID、URL、最后更新时间

---

### 2️⃣ 从 Notion 下载

**命令：**
```bash
npm run notion download "页面标题" [输出文件名]
```

**选项：**
- `-d, --dir <dir>`: 指定输出目录（默认：`pages`）

**示例：**
```bash
# 下载到默认目录
npm run notion download "页面标题"

# 下载到指定目录
npm run notion download "页面标题" -d my-docs

# 指定输出文件名
npm run notion download "页面标题" "自定义文件名.md"
```

**功能：**
- ✅ 带进度条显示下载进度
- ✅ 自动创建输出目录
- ✅ 显示文件大小和路径

---

### 3️⃣ 上传新文件

**命令：**
```bash
npm run notion upload <文件路径> <页面标题> [父页面ID]
```

**选项：**
- `-f, --force`: 强制更新（如果页面已存在）

**示例：**
```bash
# 创建新页面（需要父页面 ID）
npm run notion upload pages/新文件.md "新页面标题" <parent_page_id>

# 更新现有页面
npm run notion upload pages/文件.md "页面标题" --force

# 先查找父页面 ID
npm run notion find "父页面标题"
npm run notion upload pages/新文件.md "新页面标题" <parent_page_id>
```

**功能：**
- ✅ 自动检测页面是否存在
- ✅ 带进度条显示上传进度
- ✅ 支持创建新页面或更新现有页面

---

### 4️⃣ 同步文件

**命令：**
```bash
npm run notion sync "页面标题" [输出文件名]
```

**选项：**
- `-d, --dir <dir>`: 指定输出目录（默认：`pages`）

**示例：**
```bash
# 同步到默认目录
npm run notion sync "页面标题"

# 同步到指定目录
npm run notion sync "页面标题" -d my-docs
```

**功能：**
- ✅ 下载并覆盖本地文件
- ✅ 带进度条显示同步进度
- ✅ 自动检测文件是否存在（更新或新建）

---

## 📖 完整工作流程

### 场景 1: 编辑现有 Notion 页面

```bash
# 1. 查找页面
npm run notion find "页面标题"

# 2. 同步到本地
npm run notion sync "页面标题"

# 3. 在 Cursor 中编辑文件
# 文件位置: pages/页面标题.md

# 4. 上传回 Notion（更新）
npm run notion upload pages/页面标题.md "页面标题" --force
```

### 场景 2: 创建新 Notion 页面

```bash
# 1. 在本地创建 Markdown 文件
# 文件位置: pages/新文件.md

# 2. 查找父页面 ID
npm run notion find "父页面标题"

# 3. 上传到 Notion（创建新页面）
npm run notion upload pages/新文件.md "新页面标题" <parent_page_id>
```

### 场景 3: 批量下载多个页面

```bash
# 1. 列出所有页面
npm run list

# 2. 逐个下载
npm run notion download "页面1"
npm run notion download "页面2"
npm run notion download "页面3"
```

---

## 💡 提示

1. **精确匹配**：所有命令都使用精确匹配页面标题，确保标题完全一致
2. **进度条**：大文件会自动显示进度条，小文件可能不显示
3. **文件路径**：可以使用相对路径或绝对路径
4. **输出目录**：默认保存在 `pages/` 目录，可通过 `-d` 选项自定义

---

## 🔧 故障排除

### 问题：找不到页面

**解决方案：**
- 确保页面标题完全匹配（包括空格、标点符号）
- 使用 `npm run list` 查看所有可访问的页面
- 确保页面已分享给你的 Integration

### 问题：上传失败

**解决方案：**
- 检查父页面 ID 是否正确
- 确保父页面已分享给你的 Integration
- 使用 `--force` 参数更新现有页面

### 问题：进度条不显示

**解决方案：**
- 进度条只在处理大量内容时显示
- 这是正常现象，不影响功能

---

## 📚 更多信息

查看 `README.md` 获取更多详细信息。

