# Markdown 轉 DOCX MCP Server 配置指南

## ✅ 已安裝的開源 MCP Server

我已經為您安裝並配置了 **md-to-word-mcp**，這是一個開源的 MCP server，專門用於將 Markdown 轉換為 DOCX 格式。

### 安裝信息
- **包名**：`md-to-word-mcp`
- **版本**：0.1.1
- **依賴**：`pypandoc-binary`（內含 Pandoc，無需單獨安裝）
- **狀態**：✅ 已安裝並配置

## 📋 配置詳情

### MCP 配置文件
位置：`~/.cursor/mcp.json`

已添加的配置：
```json
{
  "mcpServers": {
    "md-to-word": {
      "command": "python3",
      "args": ["-m", "md_to_word_mcp"],
      "cwd": "/Users/Daniel/Documents/Notion"
    }
  }
}
```

**注意**：`cwd` 參數指定了 MCP 服務器的工作目錄，這樣可以確保模板文件能被正確找到。

## 🛠️ 可用工具

### convert_md_to_word
將 Markdown 文件轉換為 Word (DOCX) 文檔

**參數**：
- `input_file` (必需)：輸入的 Markdown 文件路徑（建議使用絕對路徑）
- `output_file` (可選)：輸出的 Word 文件路徑，如果不提供會自動生成
- `template` (可選)：Word 模板文件路徑（建議使用絕對路徑，如果不提供會使用默認模板 `product_manual_black.docx`）
- `title` (可選)：文檔標題
- `author` (可選)：文檔作者

**使用示例**：
```
請使用 convert_md_to_word 工具將 /Users/Daniel/Documents/Notion/document.md 轉換為 DOCX
```

**注意**：
- 如果使用模板，請使用絕對路徑指定模板文件
- 默認模板文件 `product_manual_black.docx` 已創建在 `/Users/Daniel/Documents/Notion/` 目錄下
- 如果不使用模板，可以傳遞空字符串或使用絕對路徑指向一個不存在的文件（工具會自動處理）

## 🚀 使用步驟

### 1. 重啟 Cursor
完全關閉並重新開啟 Cursor，讓 MCP 配置生效。

### 2. 驗證連接
重啟後，MCP server 應該會自動連接。您可以在 Cursor 中看到 `md-to-word` 服務器已連接。

### 3. 使用轉換功能
在 Cursor 中，您可以：
- 直接要求 AI 將 Markdown 文件轉換為 DOCX
- 使用 `convert_md_to_word` 工具進行轉換

## 📚 其他開源的 Markdown 轉 DOCX MCP Server

### 1. mcp-pandoc
使用 Pandoc 進行文檔轉換的 MCP server

**安裝**：
```bash
npm install -g mcp-pandoc
```

**配置**：
```json
{
  "mcpServers": {
    "pandoc": {
      "command": "npx",
      "args": ["-y", "mcp-pandoc"]
    }
  }
}
```

### 2. md2doc MCP Server
由 Yorick-Ryu 開發，支持自定義模板和多語言

**資源**：
- 網站：https://mcp.so/server/md2doc/Yorick-Ryu
- 功能：支持自定義模板、多語言（包括中文）、自動下載

### 3. Mdtoword MCP Server
由 jackdark425 開發，支持標準 Markdown 語法

**資源**：
- 網站：https://chat.mcp.so/server/mdtoword/jackdark425
- 功能：支持標題、段落、列表、表格、代碼塊、引用等

## 🔧 故障排除

### 問題 1：服務器無法啟動
**錯誤訊息**：`ModuleNotFoundError: No module named 'md_to_word_mcp'`

**解決方案**：
```bash
pip3 install md-to-word-mcp pypandoc-binary
```

### 問題 2：轉換失敗
**可能原因**：
- Markdown 文件格式不正確
- 文件路徑錯誤
- Pandoc 轉換錯誤

**解決方案**：
1. 檢查 Markdown 文件是否有效
2. 確認文件路徑正確
3. 查看 Cursor 開發者工具中的錯誤訊息

### 問題 3：轉換結果格式不正確
**解決方案**：
1. 使用自定義 Word 模板（`template` 參數）
2. 調整 Markdown 源文件的格式
3. 嘗試其他 MCP server（如 mcp-pandoc）

## 📖 參考資源

- **md-to-word-mcp**：
  - PyPI：https://pypi.org/project/md-to-word-mcp/
  - 功能：支持自定義模板、模板管理、Markdown 驗證

- **Pandoc**：
  - 官方網站：https://pandoc.org/
  - 支持格式：Markdown、DOCX、PDF、HTML 等

- **MCP 官方文檔**：
  - https://modelcontextprotocol.io

## 💡 使用建議

1. **批量轉換**：如果需要批量轉換多個文件，可以創建腳本循環調用工具
2. **自定義模板**：使用 Word 模板可以更好地控制輸出格式
3. **格式驗證**：轉換前建議先驗證 Markdown 文件格式
4. **備份原文件**：轉換前建議備份原始 Markdown 文件

## ⚠️ 注意事項

1. **文件路徑**：確保使用絕對路徑或相對於工作目錄的正確路徑
2. **文件權限**：確保對輸入和輸出目錄有讀寫權限
3. **文件大小**：大文件轉換可能需要較長時間
4. **格式限制**：某些複雜的 Markdown 格式可能無法完美轉換

## ✅ 測試結果

**測試時間**：2025-11-18

**測試文件**：`MD_TO_DOCX_MCP_GUIDE.md`

**測試結果**：
- ✅ MCP 工具轉換成功
- ✅ 生成文件：`MD_TO_DOCX_MCP_GUIDE_MCP.docx` (25KB)
- ✅ 處理時間：0.56 秒
- ✅ 使用模板：`product_manual_black.docx`

**重要提示**：
- 使用 MCP 工具時，建議使用**絕對路徑**指定模板文件
- 默認模板文件已創建在 `/Users/Daniel/Documents/Notion/product_manual_black.docx`
- 如果不指定模板，工具會嘗試使用默認模板，如果不存在會報錯

## 🎯 下一步

1. ✅ 已配置並測試 MCP Server
2. ✅ 已創建默認模板文件
3. ✅ 已驗證轉換功能正常

**使用建議**：
- 對於需要自定義格式的文檔，可以創建自己的 Word 模板
- 對於簡單轉換，可以使用默認模板或不使用模板（傳遞空字符串）

如有問題，請查看服務器日誌或聯繫我協助解決。

