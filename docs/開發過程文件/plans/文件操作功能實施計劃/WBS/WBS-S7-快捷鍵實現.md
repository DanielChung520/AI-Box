# WBS計劃 - 階段七：快捷鍵實現（S7 - 新增）

**創建日期**: 2025-01-27
**創建人**: Daniel Chung
**最後修改日期**: 2025-01-27

## 階段概述

**目標**: 實現全局快捷鍵功能
**工作量**: 3 天
**優先級**: P2（低優先級）
**依賴**: S1, S2, S3

**更新說明**（2025-01-27）：

- 根據《文件操作功能檢核報告》新增快捷鍵實現階段

---

## 任務分解

### S7.1 全局快捷鍵實現（1 天）

**任務描述**: 實現全局快捷鍵功能

**實施位置**: `ai-bot/src/lib/hooks/useKeyboardShortcuts.ts`（新建）

**快捷鍵列表**:

- `Cmd/Ctrl + P`: 打開搜尋檔案對話框
- `Esc`: 關閉當前對話框或取消操作

**實現步驟**:

1. [ ] 創建 `useKeyboardShortcuts.ts` Hook
2. [ ] 實現全局快捷鍵監聽
3. [ ] 實現 `Cmd/Ctrl + P` 快捷鍵（打開搜尋檔案對話框）
4. [ ] 實現 `Esc` 快捷鍵（關閉對話框或取消操作）
5. [ ] 實現快捷鍵衝突處理
6. [ ] 實現快捷鍵提示（可選，顯示快捷鍵列表）
7. [ ] 添加錯誤處理

**重用組件**:

- 搜尋檔案對話框（已實現）

**驗收標準**:

- [ ] `Cmd/Ctrl + P` 快捷鍵正常（打開搜尋檔案對話框）
- [ ] `Esc` 快捷鍵正常（關閉對話框或取消操作）
- [ ] 快捷鍵衝突處理正確
- [ ] 錯誤處理完善

---

### S7.2 文件操作快捷鍵（1 天）

**任務描述**: 實現文件操作快捷鍵

**實施位置**: `ai-bot/src/lib/hooks/useKeyboardShortcuts.ts` 或 `ai-bot/src/components/FileTree.tsx`

**快捷鍵列表**:

- `F2`: 重新命名選中的文件或資料夾
- `Delete`: 刪除選中的文件或資料夾（需要確認）
- `Cmd/Ctrl + C`: 複製選中的文件或資料夾
- `Cmd/Ctrl + X`: 剪下選中的文件或資料夾
- `Cmd/Ctrl + V`: 貼上已複製或剪下的文件或資料夾
- `Cmd/Ctrl + A`: 全選當前資料夾中的所有文件

**實現步驟**:

1. [ ] 實現 `F2` 快捷鍵（重新命名）
2. [ ] 實現 `Delete` 快捷鍵（刪除，需要確認對話框）
3. [ ] 實現 `Cmd/Ctrl + C` 快捷鍵（複製，重用S3.1剪貼板功能）
4. [ ] 實現 `Cmd/Ctrl + X` 快捷鍵（剪下，重用S3.1剪貼板功能）
5. [ ] 實現 `Cmd/Ctrl + V` 快捷鍵（貼上，重用S3.1剪貼板功能）
6. [ ] 實現 `Cmd/Ctrl + A` 快捷鍵（全選，重用S3.2批量選擇功能）
7. [ ] 實現選中狀態管理（確保有選中的文件/資料夾時才響應快捷鍵）
8. [ ] 實現快捷鍵衝突處理（如輸入框聚焦時不響應）
9. [ ] 添加錯誤處理

**重用功能**:

- 剪貼板功能（S3.1）
- 批量選擇功能（S3.2）
- 文件操作API（S1）

**驗收標準**:

- [ ] `F2` 快捷鍵正常（重新命名）
- [ ] `Delete` 快捷鍵正常（刪除，需要確認）
- [ ] `Cmd/Ctrl + C` 快捷鍵正常（複製）
- [ ] `Cmd/Ctrl + X` 快捷鍵正常（剪下）
- [ ] `Cmd/Ctrl + V` 快捷鍵正常（貼上）
- [ ] `Cmd/Ctrl + A` 快捷鍵正常（全選）
- [ ] 選中狀態管理正確
- [ ] 快捷鍵衝突處理正確
- [ ] 錯誤處理完善

---

### S7.3 文件瀏覽快捷鍵（0.5 天）

**任務描述**: 實現文件瀏覽快捷鍵

**實施位置**: `ai-bot/src/components/FileTree.tsx`

**快捷鍵列表**:

- `↑/↓`: 在文件列表中上下移動選擇
- `Enter`: 打開選中的文件或展開/折疊資料夾
- `←`: 折疊當前資料夾
- `→`: 展開當前資料夾

**實現步驟**:

1. [ ] 實現 `↑/↓` 快捷鍵（上下移動選擇）
2. [ ] 實現 `Enter` 快捷鍵（打開文件或展開/折疊資料夾）
3. [ ] 實現 `←` 快捷鍵（折疊當前資料夾）
4. [ ] 實現 `→` 快捷鍵（展開當前資料夾）
5. [ ] 實現鍵盤導航狀態管理（當前選中的項目）
6. [ ] 實現視圖滾動（選中項目不在視圖中時自動滾動）
7. [ ] 添加錯誤處理

**驗收標準**:

- [ ] `↑/↓` 快捷鍵正常（上下移動選擇）
- [ ] `Enter` 快捷鍵正常（打開文件或展開/折疊資料夾）
- [ ] `←` 快捷鍵正常（折疊當前資料夾）
- [ ] `→` 快捷鍵正常（展開當前資料夾）
- [ ] 鍵盤導航狀態管理正確
- [ ] 視圖滾動正常
- [ ] 錯誤處理完善

---

### S7.4 搜尋快捷鍵（0.5 天）

**任務描述**: 實現搜尋快捷鍵

**實施位置**: `ai-bot/src/components/FileTree.tsx` 或 `ai-bot/src/components/Sidebar.tsx`

**快捷鍵列表**:

- `Cmd/Ctrl + F`: 在當前視圖中搜尋

**實現步驟**:

1. [ ] 實現 `Cmd/Ctrl + F` 快捷鍵（在當前視圖中搜尋）
2. [ ] 實現搜尋對話框（如果沒有）
3. [ ] 實現搜尋結果高亮
4. [ ] 實現搜尋結果導航（下一個/上一個）
5. [ ] 實現快捷鍵衝突處理（如輸入框聚焦時不響應）
6. [ ] 添加錯誤處理

**注意**: 如果已有全局搜尋功能（`Cmd/Ctrl + P`），此功能為當前視圖內的搜尋。

**驗收標準**:

- [ ] `Cmd/Ctrl + F` 快捷鍵正常（在當前視圖中搜尋）
- [ ] 搜尋對話框正常顯示
- [ ] 搜尋結果高亮正確
- [ ] 搜尋結果導航正常
- [ ] 快捷鍵衝突處理正確
- [ ] 錯誤處理完善

---

## 階段交付物

- ✅ 全局快捷鍵實現完成
- ✅ 文件操作快捷鍵實現完成
- ✅ 文件瀏覽快捷鍵實現完成
- ✅ 搜尋快捷鍵實現完成
- ✅ 單元測試完成
- ✅ 集成測試完成

---

## 測試要求

### 單元測試

- [ ] 測試全局快捷鍵
- [ ] 測試文件操作快捷鍵
- [ ] 測試文件瀏覽快捷鍵
- [ ] 測試搜尋快捷鍵
- [ ] 測試快捷鍵衝突處理
- [ ] 測試錯誤處理

### 集成測試

- [ ] 測試與文件樹組件的集成
- [ ] 測試與右鍵選單的集成
- [ ] 測試與剪貼板功能的集成
- [ ] 測試與批量選擇功能的集成
- [ ] 測試UI交互

---

## 注意事項

- ✅ **完全前端實現，不涉及後端**
- ✅ **確保快捷鍵與現有功能協同工作**（剪貼板、批量選擇等）
- ✅ **實現快捷鍵衝突處理**（如輸入框聚焦時不響應）
- ✅ **快捷鍵功能為低優先級（P2），可根據實際需求調整實施順序**
- ✅ **建議提供快捷鍵提示或幫助文檔**（可選）
