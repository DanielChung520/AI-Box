# AI-Box æœ€æ–°èªç¾©èˆ‡ä»»å‹™åˆ†æè©³ç´°èªªæ˜

**ä»£ç¢¼åŠŸèƒ½èªªæ˜**: AI-Box èªç¾©èˆ‡ä»»å‹™åˆ†æç³»çµ±çš„æœ€æ–°èªªæ˜æ–‡ä»¶ï¼ŒåŸºæ–¼ v4 æ¶æ§‹ï¼ŒåŒ…å«å®Œæ•´çš„å‰ç«¯åˆ°å¾Œç«¯çš„è™•ç†æµç¨‹å’Œä»£ç¢¼å¯¦ç¾ç›¤é»
**å‰µå»ºæ—¥æœŸ**: 2026-01-23
**å‰µå»ºäºº**: Daniel Chung
**æœ€å¾Œä¿®æ”¹æ—¥æœŸ**: 2026-02-03

ç‰ˆæœ¬ï¼š4.2

---

## ğŸ“‹ æ–‡æª”æ¦‚è¿°

æœ¬æ–‡æª”åŸºæ–¼ã€ŠAI-Boxèªç¾©èˆ‡ä»»å‹™v4é‡æ§‹è¨ˆåŠƒ.mdã€‹ã€ã€Šæ–‡ä»¶ç·¨è¼¯Agentèªç¾©è·¯ç”±æ¸¬è©¦è¨ˆåŠƒ-v4.mdã€‹ç­‰æœ€æ–°è¨­è¨ˆæ–‡æª”ï¼Œæ•´ç†å‡º AI-Box èªç¾©èˆ‡ä»»å‹™åˆ†æç³»çµ±çš„å®Œæ•´èªªæ˜ã€‚

### ç³»çµ±å®šä½

AI-Box èªç¾©èˆ‡ä»»å‹™åˆ†æç³»çµ±æ˜¯ä¸€å€‹ **Agent-first Enterprise AI Orchestration Platform**ï¼Œè² è²¬å°‡ç”¨æˆ¶çš„è‡ªç„¶èªè¨€è¼¸å…¥è½‰æ›ç‚ºçµæ§‹åŒ–çš„ä»»å‹™åŸ·è¡Œã€‚

### æ ¸å¿ƒæ¶æ§‹

ç³»çµ±æ¡ç”¨ **5å±¤æ¼¸é€²å¼è™•ç†æ¶æ§‹**ï¼ˆL1-L5ï¼‰ï¼š

```
L1: Semantic Understandingï¼ˆèªç¾©ç†è§£ï¼‰
L2: Intent & Task Abstractionï¼ˆæ„åœ–èˆ‡ä»»å‹™æŠ½è±¡ï¼‰
L3: Capability Mapping & Task Planningï¼ˆèƒ½åŠ›æ˜ å°„èˆ‡ä»»å‹™è¦åŠƒï¼‰
L4: Constraint Validation & Policy Checkï¼ˆç´„æŸé©—è­‰èˆ‡ç­–ç•¥æª¢æŸ¥ï¼‰
L5: Execution + Observationï¼ˆåŸ·è¡Œèˆ‡è§€å¯Ÿï¼‰
```

---

## ğŸ”„ å®Œæ•´è™•ç†æµç¨‹



### å‰ç«¯åˆ°å¾Œç«¯å®Œæ•´æµç¨‹

```mermaid
graph TD
    A[ç”¨æˆ¶è¼¸å…¥ Prompt/æŒ‡ä»¤] --> B[API Gateway: /api/v1/chat/stream]
    B --> C[Layer 0: Cheap Gating å¿«é€Ÿéæ¿¾]
    C -->|ç°¡å–®æŸ¥è©¢| D[ç›´æ¥è¿”å›ç­”æ¡ˆ]
    C -->|è¤‡é›œæŸ¥è©¢| E[Layer 1: Fast Answer Layer]
    E -->|å¯ç›´æ¥å›ç­”| F[é«˜ç´š LLM ç›´æ¥å›ç­”]
    E -->|éœ€è¦ç³»çµ±è¡Œå‹•| G[Layer 2: Semantic Understanding]
    G --> H[Router LLM èªç¾©ç†è§£]
    H --> I[Layer 3: Intent & Task Abstraction]
    I --> J[Intent DSL åŒ¹é…]
    J --> K[Layer 4: Capability Mapping & Planning]
    K --> L[RAG-2 èƒ½åŠ›ç™¼ç¾]
    L --> M[Task Planner ç”Ÿæˆ DAG]
    M --> N[Layer 5: Constraint Validation]
    N --> O[Policy Service æª¢æŸ¥]
    O --> P[Layer 6: Execution + Observation]
    P --> Q[Agent Orchestrator åŸ·è¡Œ]
    Q --> R[è¿”å›çµæœ]
    R --> S[Routing Memory è¨˜éŒ„]
```

### é—œéµæ•¸æ“šæµ

1. **ç”¨æˆ¶è¼¸å…¥** â†’ **API å…¥å£**
2. **Layer 0-1** â†’ **å¿«é€Ÿéæ¿¾å’Œåˆæ­¥åˆ¤æ–·**
3. **Layer 2-3** â†’ **èªç¾©ç†è§£å’Œæ„åœ–æŠ½è±¡**
4. **Layer 4-5** â†’ **èƒ½åŠ›æ˜ å°„å’Œä»»å‹™è¦åŠƒ**
5. **Layer 6** â†’ **ç´„æŸæª¢æŸ¥å’ŒåŸ·è¡Œ**
6. **Layer 7** â†’ **è§€å¯Ÿå’Œè¨˜æ†¶**

---

## ğŸ“Š å„å±¤ç´šè©³ç´°èªªæ˜

### L1: Semantic Understandingï¼ˆèªç¾©ç†è§£ï¼‰

#### è·è²¬å®šç¾©

å›ç­”ã€Œä½¿ç”¨è€…èªªäº†ä»€éº¼ã€ï¼Œä¸å›ç­”ã€Œè¦åšä»€éº¼ã€

#### è¼¸å…¥

- åŸå§‹è‡ªç„¶èªè¨€
- æœ€è¿‘å°è©±æ‘˜è¦
- ç³»çµ±æ¨¡å¼ï¼ˆdesign/execution/sandboxï¼‰

#### è¼¸å‡º Schema

```json
{
  "topics": ["document", "system_design"],
  "entities": ["Document Editing Agent", "API Spec", "Patch Format"],
  "action_signals": ["design", "refine", "structure"],
  "modality": "instruction",
  "certainty": 0.92
}
```

#### ç¾æœ‰å¯¦ç¾

**æ–‡ä»¶ä½ç½®**: `agents/task_analyzer/router_llm.py`

**é—œéµä»£ç¢¼**:

```python
class RouterDecision(BaseModel):
    intent_type: Literal["conversation", "retrieval", "analysis", "execution"]
    complexity: Literal["low", "mid", "high"]
    needs_agent: bool
    needs_tools: bool
    determinism_required: bool
    risk_level: Literal["low", "mid", "high"]
    confidence: float
```

**å¯¦ç¾ç‹€æ…‹**: âœ… å·²å¯¦ç¾ï¼ˆæ“´å±•ç‰ˆï¼‰

### L2: Intent & Task Abstractionï¼ˆæ„åœ–èˆ‡ä»»å‹™æŠ½è±¡ï¼‰

#### è·è²¬å®šç¾©

å°‡èªç¾©ç†è§£è½‰æ›ç‚ºçµæ§‹åŒ–æ„åœ–

#### Intent DSL è¨­è¨ˆ

```plain
INTENT modify_document {
  domain: "system_architecture"
  target: "Document Editing Agent"
  output_format: ["Engineering Spec"]
  depth: "Advanced"
}
```

#### ç¾æœ‰å¯¦ç¾

**æ–‡ä»¶ä½ç½®**: `agents/task_analyzer/intent_registry.py`ï¼ˆè¨ˆåŠƒä¸­ï¼‰

**å¯¦ç¾ç‹€æ…‹**: âš ï¸ éƒ¨åˆ†å¯¦ç¾ï¼ˆå‹•æ…‹åˆ†é¡ç‚ºä¸»ï¼ŒDSLåŒ–è¨ˆåŠƒä¸­ï¼‰

### L3: Capability Mapping & Task Planningï¼ˆèƒ½åŠ›æ˜ å°„èˆ‡ä»»å‹™è¦åŠƒï¼‰

#### è·è²¬å®šç¾©

ç™¼ç¾å¯ç”¨èƒ½åŠ›ä¸¦ç”Ÿæˆä»»å‹™åŸ·è¡Œè¨ˆåŠƒ

#### Capability Registry è¨­è¨ˆ

```json
{
  "agent": "DocumentEditingAgent",
  "capabilities": [
    {
      "name": "generate_patch_design",
      "input": "SemanticSpec",
      "output": "PatchPlan"
    }
  ],
  "constraints": {
    "environment": "design_only",
    "writes_system": false
  }
}
```

#### Task DAG è¼¸å‡º

```json
{
  "task_graph": [
    { "id": "T1", "capability": "generate_patch_design" },
    { "id": "T2", "capability": "produce_openapi_spec", "depends_on": ["T1"] }
  ]
}
```

#### ç¾æœ‰å¯¦ç¾

**æ–‡ä»¶ä½ç½®**:

- `agents/task_analyzer/capability_matcher.py` âœ… å·²å¯¦ç¾
- `agents/task_analyzer/task_planner.py` âš ï¸ è¨ˆåŠƒä¸­

**å¯¦ç¾ç‹€æ…‹**: ğŸŸ¡ ä¸­ç­‰å¯¦ç¾ï¼ˆCapability Matching å·²å¯¦ç¾ï¼ŒTask DAG è¨ˆåŠƒä¸­ï¼‰

### L4: Constraint Validation & Policy Checkï¼ˆç´„æŸé©—è­‰èˆ‡ç­–ç•¥æª¢æŸ¥ï¼‰

#### è·è²¬å®šç¾©

é©—è­‰ä»»å‹™åŸ·è¡Œæ˜¯å¦ç¬¦åˆç³»çµ±ç´„æŸå’Œç­–ç•¥

#### é©—è­‰é …ç›®

- æ¬Šé™æª¢æŸ¥
- é¢¨éšªè©•ä¼°
- ç­–ç•¥ç¬¦åˆæ€§
- è³‡æºé™åˆ¶

#### è¼¸å‡ºæ ¼å¼

```json
{
  "allowed": true,
  "requires_confirmation": false,
  "risk_level": "low"
}
```

#### ç¾æœ‰å¯¦ç¾

**æ–‡ä»¶ä½ç½®**: `agents/task_analyzer/policy_service.py`ï¼ˆè¨ˆåŠƒä¸­ï¼‰

**å¯¦ç¾ç‹€æ…‹**: âŒ æœªå¯¦ç¾ï¼ˆè¨ˆåŠƒä¸­ï¼‰

### L5: Execution + Observationï¼ˆåŸ·è¡Œèˆ‡è§€å¯Ÿï¼‰

#### è·è²¬å®šç¾©

åŸ·è¡Œä»»å‹™ä¸¦è¨˜éŒ„åŸ·è¡ŒæŒ‡æ¨™

#### è¨˜éŒ„çµæ§‹

```json
{
  "intent": "modify_document",
  "task_count": 2,
  "execution_success": true,
  "user_correction": false,
  "latency_ms": 4200
}
```

#### çŸ¥è­˜åº«æ¬Šé™ç®¡ç†ï¼ˆ2026-02-03 æ–°å¢ï¼‰

**è¨­è¨ˆç›®æ¨™**ï¼š

1. **çµ±ä¸€å…¥å£**: æ‰€æœ‰çŸ¥è­˜åº«æª¢ç´¢å¿…é ˆé€šé KA-Agent
2. **æ¬Šé™æ§åˆ¶**: Agent éœ€è¦é€šé capabilities æ¨™è¨˜ç²å¾—æ¬Šé™
3. **æœªä¾†æ“´å±•**: è‹¥æª¢ç´¢å‡ç´šï¼Œåªéœ€ä¿®æ”¹ KA-Agentï¼Œå…¶ä»– Agent ç„¡éœ€èª¿æ•´

**æ¬Šé™æ¨™è­˜**ï¼š

| Capability åç¨±        | èªªæ˜                    | æˆæ¬Šå°è±¡                       |
| ---------------------- | ----------------------- | ------------------------------ |
| `mm_agent_knowledge` | MM-Agent çŸ¥è­˜åº«è¨ªå•æ¬Šé™ | éœ€è¦è¨ªå•ç‰©æ–™ç®¡ç†çŸ¥è­˜åº«çš„ Agent |

**æ¬Šé™æª¢æŸ¥æµç¨‹**ï¼š

```
ç”¨æˆ¶é¸æ“‡ Agent + å•é¡Œ
    â†“
Task Analyzer æª¢æ¸¬çŸ¥è­˜æŸ¥è©¢ (Knowledge Signal)
    â†“
Decision Engine æª¢æŸ¥æ¬Šé™
    â”œâ”€ æœ‰æ¬Šé™ â†’ é¸æ“‡ç”¨æˆ¶é¸æ“‡çš„ Agent
    â””â”€ ç„¡æ¬Šé™ â†’ é¸æ“‡ KA-Agent
    â†“
Agent åŸ·è¡Œä»»å‹™
    â”œâ”€ æœ‰æ¬Šé™çš„ Agent â†’ èª¿ç”¨ KA-Agent æª¢ç´¢
    â””â”€ KA-Agent â†’ ç›´æ¥æª¢ç´¢
    â†“
è¿”å›çµæœçµ¦ç”¨æˆ¶
```

**Decision Engine æ¬Šé™æª¢æŸ¥**ï¼š

**æ–‡ä»¶ä½ç½®**: `agents/task_analyzer/decision_engine.py:594-647`

```python
# æª¢æŸ¥ç”¨æˆ¶é¸æ“‡çš„ Agent æ˜¯å¦æœ‰çŸ¥è­˜åº«æ¬Šé™
if is_knowledge_query and user_selected_agent_id:
    registry = get_agent_registry()
    user_agent_info = registry.get_agent_info(user_selected_agent_id)
  
    if user_agent_info:
        has_mm_knowledge = "mm_agent_knowledge" in user_agent_info.capabilities
      
        if has_mm_knowledge:
            # ç”¨æˆ¶é¸æ“‡çš„ Agent æœ‰æ¬Šé™ï¼Œç›´æ¥ä½¿ç”¨è©² Agent
            chosen_agent = user_selected_agent_id
            reasoning_parts.append(
                f"çŸ¥è­˜åº«æŸ¥è©¢ä»»å‹™ï¼Œç”¨æˆ¶é¸æ“‡çš„ Agent '{user_selected_agent_id}' "
                f"æœ‰ MM-Agent çŸ¥è­˜åº«æ¬Šé™ï¼Œå„ªå…ˆä½¿ç”¨è©² Agent"
            )
```

**KA-Agent æ¬Šé™æª¢æŸ¥**ï¼š

**æ–‡ä»¶ä½ç½®**: `agents/builtin/ka_agent/agent.py:554-598`

```python
# Agent æ¬Šé™æª¢æŸ¥ï¼ˆæª¢æŸ¥æ˜¯å¦æœ‰ MM-Agent çŸ¥è­˜åº«è¨ªå•æ¬Šé™ï¼‰
if caller_agent_id:
    agent_info = registry.get_agent_info(caller_agent_id)
  
    if agent_info:
        capabilities = agent_info.capabilities or []
        has_mm_knowledge = "mm_agent_knowledge" in capabilities
      
        if not has_mm_knowledge:
            feedback = self._error_handler.permission_denied(
                user_id=caller_agent_id,
                action="çŸ¥è­˜åº«æª¢ç´¢",
                resource="MM-Agent çŸ¥è­˜åº«",
                reason=f"Agent '{caller_agent_id}' æ²’æœ‰ 'mm_agent_knowledge' èƒ½åŠ›"
            )
            return KAResponse(success=False, ...)
```

#### ç¾æœ‰å¯¦ç¾

**æ–‡ä»¶ä½ç½®**:

- `agents/services/orchestrator/orchestrator.py` âœ… å·²å¯¦ç¾
- `agents/services/observation_collector/` âœ… å·²å¯¦ç¾

**å¯¦ç¾ç‹€æ…‹**: âœ… å·²å¯¦ç¾

---

## ğŸ”§ ä»£ç¢¼æµç¨‹ç›¤é»

### API å…¥å£é»

**æ–‡ä»¶**: `api/routers/chat.py`

**é—œéµå‡½æ•¸**: `chat_product_stream()`

```python
@router.post("/stream", status_code=status.HTTP_200_OK)
async def chat_product_stream(
    request_body: ChatRequest,
    request: Request,
    tenant_id: str = Depends(get_current_tenant_id),
    current_user: User = Depends(get_current_user),
) -> StreamingResponse:
    # 1. ç²å–ç”¨æˆ¶è¼¸å…¥
    messages = [m.model_dump() for m in request_body.messages]
    last_user_text = messages[-1].get("content", "") if messages else ""
  
    # 2. æª¢æŸ¥å¿«é€Ÿè·¯å¾‘ï¼ˆæ™‚é–“æŸ¥è©¢ç­‰ï¼‰
    if self._check_quick_path(last_user_text, allowed_tools):
        return await self._handle_quick_path(last_user_text, allowed_tools)
  
    # 3. èª¿ç”¨ Task Analyzer
    analysis_result = await self._call_task_analyzer(last_user_text, context)
  
    # 4. æ ¹æ“šåˆ†æçµæœè·¯ç”±
    return await self._route_based_on_analysis(analysis_result, context)
```

### Task Analyzer ä¸»æµç¨‹

**æ–‡ä»¶**: `agents/task_analyzer/analyzer.py`

**é—œéµå‡½æ•¸**: `analyze()`

```python
async def analyze(self, request: TaskAnalysisRequest) -> TaskAnalysisResult:
    # Layer 0: Cheap Gating
    if self._is_simple_query(request.task):
        return await self._handle_simple_query(request, task_id)

    # Layer 1: Fast Answer Layer
    direct_answer_result = await self._try_direct_answer(request, task_id)
    if direct_answer_result:
        return direct_answer_result

    # Layer 2: Semantic Understanding (Router LLM)
    router_input = RouterInput(
        user_query=request.task,
        session_context=request.context or {},
        system_constraints=self.rule_override.get_system_constraints(request.task),
    )
    router_output = await self.router_llm.route(router_input, similar_decisions)

    # Layer 3: Rule Override
    router_output = self.rule_override.apply(router_output, request.task)

    # Layer 4: Capability Matching
    agent_candidates = await self.capability_matcher.match_agents(router_output)
    tool_candidates = await self.capability_matcher.match_tools(router_output)
    model_candidates = await self.capability_matcher.match_models(router_output)

    # Layer 5: Decision Engine
    decision = self.decision_engine.decide(
        router_output,
        agent_candidates,
        tool_candidates,
        model_candidates
    )

    # Layer 6: è¿”å›çµæœ
    return self._build_result(router_output, decision)
```

### Router LLM å¯¦ç¾

**æ–‡ä»¶**: `agents/task_analyzer/router_llm.py`

**é—œéµå‡½æ•¸**: `route()`

**System Prompt**:

```python
ROUTER_SYSTEM_PROMPT = """You are a routing and classification engine inside an enterprise GenAI system.

Your ONLY responsibility is to classify the user's query and system context into a routing decision object.

STRICT RULES:
- You must NOT answer the user's question.
- You must NOT perform reasoning, planning, or step-by-step thinking.
- You must NOT select specific tools, agents, or models.
- You must NOT include explanations, markdown, or extra text.

TOOL REQUIREMENT DETECTION (needs_tools):
Set needs_tools=true if the query requires:
1. Real-time data (current time, stock prices, weather, exchange rates)
2. External API calls (web search, location services, maps)
3. System operations (file I/O, database queries, system info)
4. Deterministic calculations (unit conversions, currency exchange)
5. Document creation or editing (creating files, generating documents, editing files)
```

### Capability Matcher å¯¦ç¾

**æ–‡ä»¶**: `agents/task_analyzer/capability_matcher.py`

**é—œéµå‡½æ•¸**:

- `match_agents()` - åŒ¹é… Agent
- `match_tools()` - åŒ¹é…å·¥å…·
- `match_models()` - åŒ¹é…æ¨¡å‹

**è©•åˆ†é‚è¼¯**:

```python
total_score = (
    0.35 * capability_match +
    0.20 * cost_score +
    0.15 * latency_score +
    0.20 * success_history +
    0.10 * stability
)
```

### Decision Engine å¯¦ç¾

**æ–‡ä»¶**: `agents/task_analyzer/decision_engine.py`

**é—œéµå‡½æ•¸**: `decide()`

**æ±ºç­–é‚è¼¯**:

1. Rule Filter - ç¡¬æ€§è¦å‰‡éæ¿¾
2. Scoring Engine - åŠ æ¬Šè©•åˆ†
3. Best Candidate Selection - é¸æ“‡æœ€ä½³å€™é¸
4. Fallback Handling - è™•ç†é™ç´šæƒ…æ³

### Agent Orchestrator å¯¦ç¾

**æ–‡ä»¶**: `agents/services/orchestrator/orchestrator.py`

**é—œéµå‡½æ•¸**: `process_natural_language_request()`

**åŸ·è¡Œæµç¨‹**:

1. è§£æè‡ªç„¶èªè¨€æ„åœ–
2. æ¬Šé™æª¢æŸ¥
3. å‰µå»ºä»»å‹™è¨˜éŒ„
4. åˆ†ç™¼ä»»å‹™çµ¦ Agent
5. çµæœè™•ç†
6. è¨˜éŒ„åŸ·è¡ŒæŒ‡æ¨™

---

## ğŸ¯ é—œéµçµ„ä»¶ç‹€æ…‹ç›¤é»

### å·²å¯¦ç¾çµ„ä»¶

| çµ„ä»¶                  | æ–‡ä»¶ä½ç½®                                         | å¯¦ç¾ç‹€æ…‹    | åŠŸèƒ½èªªæ˜           |
| --------------------- | ------------------------------------------------ | ----------- | ------------------ |
| Router LLM            | `agents/task_analyzer/router_llm.py`           | âœ… å®Œæ•´å¯¦ç¾ | èªç¾©ç†è§£å’Œè·¯ç”±æ±ºç­– |
| Rule Override         | `agents/task_analyzer/rule_override.py`        | âœ… å®Œæ•´å¯¦ç¾ | ç¡¬æ€§è¦å‰‡è¦†è“‹       |
| Capability Matcher    | `agents/task_analyzer/capability_matcher.py`   | âœ… å®Œæ•´å¯¦ç¾ | èƒ½åŠ›åŒ¹é…å’Œè©•åˆ†     |
| Decision Engine       | `agents/task_analyzer/decision_engine.py`      | âœ… å®Œæ•´å¯¦ç¾ | ç¶œåˆæ±ºç­–           |
| Routing Memory        | `agents/task_analyzer/routing_memory/`         | âœ… åŸºç¤å¯¦ç¾ | æ±ºç­–è¨˜æ†¶           |
| Agent Orchestrator    | `agents/services/orchestrator/orchestrator.py` | âœ… å®Œæ•´å¯¦ç¾ | Agent å”èª¿åŸ·è¡Œ     |
| Observation Collector | `agents/services/observation_collector/`       | âœ… å®Œæ•´å¯¦ç¾ | åŸ·è¡Œè§€å¯Ÿ           |

### è¨ˆåŠƒä¸­çµ„ä»¶

| çµ„ä»¶            | è¨ˆåŠƒæ–‡ä»¶ä½ç½®                                | å¯¦ç¾ç‹€æ…‹  | åŠŸèƒ½èªªæ˜        |
| --------------- | ------------------------------------------- | --------- | --------------- |
| Intent Registry | `agents/task_analyzer/intent_registry.py` | ğŸ“… éšæ®µä¸€ | Intent DSL ç®¡ç† |
| Task Planner    | `agents/task_analyzer/task_planner.py`    | ğŸ“… éšæ®µä¸‰ | DAG ç”Ÿæˆ        |
| Policy Service  | `agents/task_analyzer/policy_service.py`  | ğŸ“… éšæ®µå›› | ç´„æŸæª¢æŸ¥        |
| RAG Namespace   | `agents/task_analyzer/rag_namespace.py`   | ğŸ“… éšæ®µä¸€ | å¤šå‘½åç©ºé–“ RAG  |

### æ¸¬è©¦è¦†è“‹

**æ¸¬è©¦æ–‡ä»¶**: `tests/agents/test_file_editing_agent_routing_v4.py`

**æ¸¬è©¦å ´æ™¯**: 90 å€‹å ´æ™¯ï¼ˆå·²å®Œæˆ 70/90ï¼‰

**æ¸¬è©¦çµæœ**:

- md-editor: 50/50 é€šé âœ…
- xls-editor: 10/10 é€šé âœ…
- md-to-pdf: 20/20 é€šé âœ…
- xls-to-pdf: 10/10 é€šé âœ…
- pdf-to-md: 10/10 é€šé âœ…

---

## ğŸ”„ å¯¦éš›åŸ·è¡Œç¤ºä¾‹

### ç¤ºä¾‹ 1: æ–‡ä»¶ç·¨è¼¯è«‹æ±‚

**ç”¨æˆ¶è¼¸å…¥**: "ç·¨è¼¯æ–‡ä»¶ README.md"

**è™•ç†æµç¨‹**:

1. **API å…¥å£**: æ¥æ”¶è«‹æ±‚ï¼Œæå–ç”¨æˆ¶è¼¸å…¥
2. **Layer 0**: ä¸æ˜¯ç°¡å–®æŸ¥è©¢ï¼Œç¹¼çºŒ
3. **Layer 1**: LLM åˆ¤æ–·éœ€è¦ç³»çµ±è¡Œå‹•ï¼Œé€²å…¥ Layer 2
4. **Layer 2**: Router LLM è¼¸å‡º `RouterDecision(intent_type="execution", needs_tools=true, needs_agent=false)`
5. **Layer 3**: Rule Override ç„¡ç‰¹æ®Šè¦å‰‡
6. **Layer 4**: Capability Matcher åŒ¹é… `md-editor` Agent
7. **Layer 5**: Decision Engine é¸æ“‡ `md-editor`
8. **Layer 6**: ç›´æ¥åŸ·è¡Œ `md-editor` Agent
9. **Layer 7**: è¨˜éŒ„åŸ·è¡Œçµæœåˆ° Routing Memory

### ç¤ºä¾‹ 2: è¤‡é›œä»»å‹™è«‹æ±‚

**ç”¨æˆ¶è¼¸å…¥**: "åˆ†æéŠ·å”®æ•¸æ“šä¸¦ç”Ÿæˆå ±å‘Š"

**è™•ç†æµç¨‹**:

1. **API å…¥å£**: æ¥æ”¶è«‹æ±‚
2. **Layer 0-1**: åˆ¤æ–·éœ€è¦ç³»çµ±è¡Œå‹•
3. **Layer 2**: Router LLM è¼¸å‡º `RouterDecision(intent_type="analysis", complexity="high", needs_agent=true)`
4. **Layer 3**: Intent DSL åŒ¹é…ç›¸é—œ Intent
5. **Layer 4**: RAG-2 æª¢ç´¢ç›¸é—œ Capability
6. **Layer 5**: Task Planner ç”Ÿæˆåˆ†æ + å ±å‘Šç”Ÿæˆçš„ DAG
7. **Layer 6**: Policy Service æª¢æŸ¥æ¬Šé™å’Œè³‡æº
8. **Layer 7**: Agent Orchestrator åŸ·è¡Œ DAG
9. **Layer 8**: è¨˜éŒ„å®Œæ•´åŸ·è¡ŒæŒ‡æ¨™

---

## ğŸ“Š æ€§èƒ½æŒ‡æ¨™

### ç›®æ¨™æŒ‡æ¨™

| æŒ‡æ¨™                  | ç›®æ¨™å€¼       | ç•¶å‰ç‹€æ…‹  |
| --------------------- | ------------ | --------- |
| ç«¯åˆ°ç«¯éŸ¿æ‡‰æ™‚é–“        | â‰¤3ç§’ï¼ˆP95ï¼‰ | âœ… å·²é”æˆ |
| L1 å±¤ç´šéŸ¿æ‡‰æ™‚é–“       | â‰¤1ç§’ï¼ˆP95ï¼‰ | âœ… å·²é”æˆ |
| Intent åŒ¹é…æº–ç¢ºç‡     | â‰¥90%        | âœ… å·²é”æˆ |
| Capability ç™¼ç¾æº–ç¢ºç‡ | â‰¥95%        | ğŸ“… è¨ˆåŠƒä¸­ |
| ä»»å‹™åŸ·è¡ŒæˆåŠŸç‡        | â‰¥95%        | âœ… å·²é”æˆ |

### æ¸¬è©¦æ€§èƒ½æ•¸æ“š

**md-editor å ´æ™¯æ¸¬è©¦**:

- ç¸½å ´æ™¯æ•¸: 50
- å¹³å‡éŸ¿æ‡‰æ™‚é–“: 1004.05ms
- P95 éŸ¿æ‡‰æ™‚é–“: 1127.12ms
- Agent èª¿ç”¨æˆåŠŸç‡: 100%
- Agent åŒ¹é…ç‡: 100%

---

## ğŸš€ æœªä¾†ç™¼å±•æ–¹å‘

### éšæ®µä¸€ï¼šåŸºç¤è¨­æ–½å®Œå–„ï¼ˆå·²å®Œæˆï¼‰

- âœ… Intent DSL Schema å®šç¾©
- âœ… Intent Registry å»ºç«‹
- âœ… Capability Registry æ“´å±•
- âœ… RAG Namespace çµæ§‹å»ºç«‹
- âœ… çŸ¥è­˜åº«æ¬Šé™ç®¡ç†æ©Ÿåˆ¶ï¼ˆ2026-02-03 æ–°å¢ï¼‰

### éšæ®µäºŒï¼šL1-L2 å±¤ç´šé‡æ§‹ï¼ˆå·²å®Œæˆï¼‰

- âœ… Router LLM è¼¸å‡º Schema æ“´å±•
- âœ… Intent DSL åŒ¹é…é‚è¼¯å¯¦ç¾
- âœ… å¤šæ¨¡å‹ ensembleï¼ˆå¯é¸ï¼‰

### éšæ®µä¸‰ï¼šL3 å±¤ç´šæ“´å±•ï¼ˆé€²è¡Œä¸­ï¼‰

- ğŸ“… Task Plannerï¼ˆDAG ç”Ÿæˆï¼‰å¯¦ç¾
- ğŸ“… RAG-2 é›†æˆåˆ° Planner
- ğŸ“… Decision Engine æ”¯æŒ DAG
- ğŸ“… çŸ¥è­˜åº«æ¬Šé™ç´°ç²’åº¦æ§åˆ¶ï¼ˆæ“´å±•æ–¹å‘ï¼‰

### éšæ®µå››ï¼šL4 å±¤ç´šå¯¦ç¾

- ğŸ“… Policy & Constraint Service å¯¦ç¾
- ğŸ“… è¦å‰‡å¼•æ“é›†æˆ
- ğŸ“… RAG-3 ç­–ç•¥æª¢ç´¢
- ğŸ“… æ¬Šé™å¯©è¨ˆèˆ‡ç›£æ§

### éšæ®µäº”ï¼šL5 å±¤ç´šå®Œå–„

- ğŸ“… åŸ·è¡ŒæŒ‡æ¨™è¨˜éŒ„æ“´å±•
- ğŸ“… å‘½ä¸­ç‡çµ±è¨ˆå¯¦ç¾
- ğŸ“… å“è³ªè©•ä¼°é‚è¼¯å¯¦ç¾
- ğŸ“… çŸ¥è­˜åº«ä½¿ç”¨çµ±è¨ˆ

### éšæ®µå…­ï¼šé›†æˆæ¸¬è©¦èˆ‡å„ªåŒ–

- ğŸ“… ç«¯åˆ°ç«¯é›†æˆæ¸¬è©¦
- ğŸ“… æ€§èƒ½æ¸¬è©¦å’Œå„ªåŒ–
- ğŸ“… å›æ­¸æ¸¬è©¦

---

## ğŸ” çŸ¥è­˜åº«æ¬Šé™ç®¡ç†ï¼ˆ2026-02-03 æ–°å¢ï¼‰

### è¨­è¨ˆæ¦‚è¿°

ç‚ºäº†æ»¿è¶³ã€Œçµ±ä¸€çŸ¥è­˜åº«å…¥å£ï¼Œæœªä¾†å‡ç´šç„¡éœ€èª¿æ•´å…¶ä»– Agentã€çš„è¨­è¨ˆç›®æ¨™ï¼Œç³»çµ±å¯¦ç¾äº†åŸºæ–¼ Agent capabilities çš„çŸ¥è­˜åº«æ¬Šé™ç®¡ç†æ©Ÿåˆ¶ã€‚

### æ ¸å¿ƒåŸå‰‡

1. **çµ±ä¸€å…¥å£**: æ‰€æœ‰çŸ¥è­˜åº«æª¢ç´¢å¿…é ˆé€šé KA-Agent
2. **æ¬Šé™æ§åˆ¶**: Agent éœ€è¦é€šé capabilities æ¨™è¨˜ç²å¾—æ¬Šé™
3. **æœªä¾†æ“´å±•**: è‹¥æª¢ç´¢å‡ç´šï¼Œåªéœ€ä¿®æ”¹ KA-Agentï¼Œå…¶ä»– Agent ç„¡éœ€èª¿æ•´

### æ¬Šé™æ¨™è­˜

| Capability åç¨±        | èªªæ˜                    | æˆæ¬Šå°è±¡                       |
| ---------------------- | ----------------------- | ------------------------------ |
| `mm_agent_knowledge` | MM-Agent çŸ¥è­˜åº«è¨ªå•æ¬Šé™ | éœ€è¦è¨ªå•ç‰©æ–™ç®¡ç†çŸ¥è­˜åº«çš„ Agent |

### ä½¿ç”¨å ´æ™¯

#### å ´æ™¯ 1ï¼šæœ‰æ¬Šé™çš„ Agent

**å‰ç½®æ¢ä»¶**ï¼š

- ç”¨æˆ¶é¸æ“‡ã€Œç¶“å¯¶ç‰©æ–™ç®¡ç†ä»£ç†ã€
- ã€Œç¶“å¯¶ç‰©æ–™ç®¡ç†ä»£ç†ã€çš„ capabilities åŒ…å« `"mm_agent_knowledge"`

**ç”¨æˆ¶è¼¸å…¥**ï¼š

```
ç‰©æ–™åº«å­˜æ€æ¨£ï¼Ÿ
```

**åŸ·è¡Œæµç¨‹**ï¼š

1. Knowledge Signal æª¢æ¸¬åˆ°çŸ¥è­˜åº«æŸ¥è©¢
2. Decision Engine æª¢æŸ¥ã€Œç¶“å¯¶ç‰©æ–™ç®¡ç†ä»£ç†ã€æœ‰æ¬Šé™
3. é¸æ“‡ã€Œç¶“å¯¶ç‰©æ–™ç®¡ç†ä»£ç†ã€
4. ã€Œç¶“å¯¶ç‰©æ–™ç®¡ç†ä»£ç†ã€èª¿ç”¨ KA-Agent æª¢ç´¢
5. KA-Agent é©—è­‰æ¬Šé™ä¸¦åŸ·è¡Œæª¢ç´¢
6. ã€Œç¶“å¯¶ç‰©æ–™ç®¡ç†ä»£ç†ã€è¿”å›çµæœ

#### å ´æ™¯ 2ï¼šç„¡æ¬Šé™çš„ Agent

**å‰ç½®æ¢ä»¶**ï¼š

- ç”¨æˆ¶é¸æ“‡ã€ŒæŸå€‹ç„¡æ¬Šé™çš„ Agentã€
- è©² Agent çš„ capabilities ä¸åŒ…å« `"mm_agent_knowledge"`

**ç”¨æˆ¶è¼¸å…¥**ï¼š

```
ç‰©æ–™åº«å­˜æ€æ¨£ï¼Ÿ
```

**åŸ·è¡Œæµç¨‹**ï¼š

1. Knowledge Signal æª¢æ¸¬åˆ°çŸ¥è­˜åº«æŸ¥è©¢
2. Decision Engine æª¢æŸ¥ã€ŒæŸå€‹ç„¡æ¬Šé™çš„ Agentã€ç„¡æ¬Šé™
3. é¸æ“‡ KA-Agent
4. KA-Agent åŸ·è¡Œæª¢ç´¢
5. è¿”å›çµæœ

### ç›¸é—œæ–‡æª”

- [KA-Agent æˆæ¬Šç®¡ç†æ–‡æª”](./KA-Agentæˆæ¬Šç®¡ç†æ–‡æª”.md) - è©³ç´°çš„æ¬Šé™æˆäºˆå’Œç®¡ç†èªªæ˜
- [Agent Registry èªªæ˜](./Agent%20Registry%20èªªæ˜.md) - Agent è¨»å†Šå’Œ capabilities ç®¡ç†

---

## ğŸ“š åƒè€ƒæ–‡æª”

### è¨­è¨ˆæ–‡æª”

- [AI-Boxèªç¾©èˆ‡ä»»å‹™v4é‡æ§‹è¨ˆåŠƒ.md](./AI-Boxèªç¾©èˆ‡ä»»å‹™v4é‡æ§‹è¨ˆåŠƒ.md)
- [AI-Box Enterprise GenAI Semantic &amp; Task Orchestration.md](./AI-Box%20Enterprise%20GenAI%20Semantic%20&%20Task%20Orchestration.md)
- [å¯è¡Œæ€§åˆ†æ-AI-Box-Enterprise-GenAI-Semantic-Task-Orchestration.md](./å¯è¡Œæ€§åˆ†æ-AI-Box-Enterprise-GenAI-Semantic-Task-Orchestration.md)

### å¯¦ç¾æ–‡æª”

- [GenAI å·¥ä½œæµæŒ‡ä»¤-èªç¾©-å·¥å…·-æ¨¡å‹-Agent ç­‰èª¿ç”¨.md](./GenAI%20å·¥ä½œæµæŒ‡ä»¤-èªç¾©-å·¥å…·-æ¨¡å‹-Agent%20ç­‰èª¿ç”¨.md)
- [Task Analyzer ç´°åŒ–é–‹ç™¼è¦æ ¼.md](./Task-Analyzer-ç»†åŒ–å¼€å‘è§„æ ¼.md)

### æ¸¬è©¦æ–‡æª”

- [æ–‡ä»¶ç·¨è¼¯Agentèªç¾©è·¯ç”±æ¸¬è©¦è¨ˆåŠƒ-v4.md](./æ–‡ä»¶ç·¨è¼¯Agentèªç¾©è·¯ç”±æ¸¬è©¦è¨ˆåŠƒ-v4.md)
- [æ–‡ä»¶ç·¨è¼¯Agentèªç¾©è·¯ç”±æ¸¬è©¦è¨ˆåŠƒ-v3.md](./æ–‡ä»¶ç·¨è¼¯Agentèªç¾©è·¯ç”±æ¸¬è©¦è¨ˆåŠƒ-v3.md)

### è¨­è¨ˆåŸå‰‡

- [èªç¾©æ„åœ–åˆ¤æ–·vsé—œéµè©åŒ¹é…èªªæ˜.md](./èªç¾©æ„åœ–åˆ¤æ–·vsé—œéµè©åŒ¹é…èªªæ˜.md)

---

## ğŸ“ æ›´æ–°è¨˜éŒ„

| æ—¥æœŸ       | æ›´æ–°å…§å®¹                                               | æ›´æ–°äºº       |
| ---------- | ------------------------------------------------------ | ------------ |
| 2026-02-03 | æ–°å¢çŸ¥è­˜åº«æ¬Šé™ç®¡ç†æ©Ÿåˆ¶ï¼Œæ›´æ–° L5 å±¤ç´šèªªæ˜ï¼Œæ·»åŠ ä½¿ç”¨å ´æ™¯ | Daniel Chung |
| 2026-01-23 | å‰µå»ºæœ€æ–°ç‰ˆèªªæ˜æ–‡ä»¶ï¼ŒåŸºæ–¼ v4 æ¶æ§‹æ•´ç†å®Œæ•´æµç¨‹å’Œä»£ç¢¼ç›¤é» | Daniel Chung |

---

**æ–‡æª”ç‰ˆæœ¬**: v4.2
**æœ€å¾Œæ›´æ–°**: 2026-02-03
**ç¶­è­·äºº**: Daniel Chung
