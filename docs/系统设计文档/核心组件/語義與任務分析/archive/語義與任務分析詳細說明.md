# AI-Box æœ€æ–°èªç¾©èˆ‡ä»»å‹™åˆ†æè©³ç´°èªªæ˜

**ä»£ç¢¼åŠŸèƒ½èªªæ˜**: AI-Box èªç¾©èˆ‡ä»»å‹™åˆ†æç³»çµ±çš„æœ€æ–°èªªæ˜æ–‡ä»¶ï¼ŒåŸºæ–¼ v4.3 æ¶æ§‹ï¼ŒåŒ…å«å®Œæ•´çš„å…©å±¤æ„åœ–åˆ†é¡æ¶æ§‹ï¼ˆGAI å‰ç«¯ + MM-Agent æ¥­å‹™è™•ç†ï¼‰
**å‰µå»ºæ—¥æœŸ**: 2026-01-23
**å‰µå»ºäºº**: Daniel Chung
**æœ€å¾Œä¿®æ”¹æ—¥æœŸ**: 2026-02-09

ç‰ˆæœ¬ï¼š4.3

---

## ğŸ“‹ æ–‡æª”æ¦‚è¿°

æœ¬æ–‡æª”åŸºæ–¼ã€ŠAI-Boxèªç¾©èˆ‡ä»»å‹™v4é‡æ§‹è¨ˆåŠƒ.mdã€‹ã€ã€Šæ–‡ä»¶ç·¨è¼¯Agentèªç¾©è·¯ç”±æ¸¬è©¦è¨ˆåŠƒ-v4.mdã€‹ç­‰æœ€æ–°è¨­è¨ˆæ–‡æª”ï¼Œæ•´ç†å‡º AI-Box èªç¾©èˆ‡ä»»å‹™åˆ†æç³»çµ±çš„å®Œæ•´èªªæ˜ã€‚

### ç³»çµ±å®šä½

AI-Box èªç¾©èˆ‡ä»»å‹™åˆ†æç³»çµ±æ˜¯ä¸€å€‹ **Agent-first Enterprise AI Orchestration Platform**ï¼Œè² è²¬å°‡ç”¨æˆ¶çš„è‡ªç„¶èªè¨€è¼¸å…¥è½‰æ›ç‚ºçµæ§‹åŒ–çš„ä»»å‹™åŸ·è¡Œã€‚

AI-Box ä½œç‚º**æœ€é«˜å±¤ Orchestrator**ï¼Œä¸åšå…·é«”æ¥­å‹™ä»£ç†ï¼Œåªåšæ±ºç­–å”èª¿ã€‚å°æ–¼ä»»å‹™èŠå¤©å®¤å ´æ™¯ï¼Œå„ªå…ˆè·¯ç”±åˆ° MM-Agent é€²è¡Œæ¥­å‹™æ„åœ–åˆ†é¡ã€‚

### æ ¸å¿ƒæ¶æ§‹

ç³»çµ±æ¡ç”¨ **5å±¤æ¼¸é€²å¼è™•ç†æ¶æ§‹**ï¼ˆL1-L5ï¼‰ï¼Œä¸¦æ–°å¢ **å…©å±¤æ„åœ–åˆ†é¡** æ©Ÿåˆ¶ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç¬¬ä¸€å±¤ï¼šAI-Box (GAI Router) - å‰ç«¯æ„åœ–åˆ†é¡                    â”‚
â”‚ è·è²¬ï¼šæŒ‡ä»£æ¶ˆè§£ã€èªæ„å®Œæ•´æ€§ã€å°è©±ç®¡ç†                          â”‚
â”‚ æ„åœ–ï¼šGREETING, CLARIFICATION, CANCEL, CONTINUE, MODIFY...   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç¬¬äºŒå±¤ï¼šMM-Agent (BPA) - æ¥­å‹™æ„åœ–åˆ†é¡                        â”‚
â”‚ è·è²¬ï¼šæ¥­å‹™æ„åœ–åˆ¤æ–·ã€åˆ†ç™¼åˆ°ä¸‹æ¸¸ Agent                          â”‚
â”‚ æ„åœ–ï¼šKNOWLEDGE_QUERY, SIMPLE_QUERY, COMPLEX_TASK...         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ L1: Semantic Understandingï¼ˆèªç¾©ç†è§£ï¼‰                        â”‚
â”‚ L2: Intent & Task Abstractionï¼ˆæ„åœ–èˆ‡ä»»å‹™æŠ½è±¡ï¼‰               â”‚
â”‚ L3: Capability Mapping & Task Planningï¼ˆèƒ½åŠ›æ˜ å°„èˆ‡ä»»å‹™è¦åŠƒï¼‰  â”‚
â”‚ L4: Constraint Validation & Policy Checkï¼ˆç´„æŸé©—è­‰èˆ‡ç­–ç•¥æª¢æŸ¥ï¼‰â”‚
â”‚ L5: Execution + Observationï¼ˆåŸ·è¡Œèˆ‡è§€å¯Ÿï¼‰                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ å®Œæ•´è™•ç†æµç¨‹

### å…©å±¤æ„åœ–åˆ†é¡æ¶æ§‹

```mermaid
graph TD
    subgraph "ç¬¬ä¸€å±¤ï¼šAI-Box (GAI Router)"
        A["ğŸ’¬ ç”¨æˆ¶è¼¸å…¥"] --> B{GAI æ„åœ–åˆ†é¡}
        B -->|GREETING| C["ğŸ‘‹ å•å€™å›è¦†"]
        B -->|CLARIFICATION| D["â“ è«‹æ±‚æ¾„æ¸…"]
        B -->|CANCEL| E["ğŸš« å–æ¶ˆä»»å‹™"]
        B -->|CONTINUE| F["â–¶ï¸ ç¹¼çºŒåŸ·è¡Œ"]
        B -->|MODIFY| G["ğŸ”„ é‡æ–°è™•ç†"]
        B -->|HISTORY| H["ğŸ“œ é¡¯ç¤ºæ­·å²"]
        B -->|EXPORT| I["ğŸ’¾ å°å‡ºçµæœ"]
        B -->|CONFIRM| J["âœ… ç¢ºèªå›è¦†"]
        B -->|THANKS| K["ğŸ™ æ„Ÿè¬å›è¦†"]
        B -->|COMPLAIN| L["ğŸ˜Ÿ é“æ­‰è™•ç†"]
        B -->|FEEDBACK| M["ğŸ“ è¨˜éŒ„åé¥‹"]
        B -->|"âš ï¸ å…¶ä»–æ¥­å‹™è«‹æ±‚"| N["ğŸ“¤ è½‰ç™¼è‡³ MM-Agent"]
    end

    subgraph "ç¬¬äºŒå±¤ï¼šMM-Agent (BPA)"
        N --> O{"ğŸ¤– LLM æ„åœ–åˆ†é¡
        ï¼ˆgpt-oss:120bï¼‰"}
        O -->|KNOWLEDGE_QUERY| P{"ğŸ“š çŸ¥è­˜ä¾†æºåˆ¤æ–·"}
        O -->|SIMPLE_QUERY| Q{"ğŸ“‹ æŸ¥è©¢èªå¥æª¢æŸ¥"}
        O -->|COMPLEX_TASK| R{"ğŸ“Š ReAct Planner"}
        O -->|CLARIFICATION| S["â“ æ¾„æ¸…å›è¦†"]

        P -->|internal| T["ğŸ¢ KA-Agentï¼ˆ8000ï¼‰"]
        P -->|external| U["ğŸŒ LLM å›é€€"]
        P -->|unknown| V["â“ ä¾†æºä¸æ˜"]

        Q -->|èªå¥å®Œæ•´| W["ğŸ“Š Data-Agent æŸ¥è©¢"]
        Q -->|èªå¥ä¸å®Œæ•´| X["â“ è«‹æ±‚æ¾„æ¸…"]

        R -->|ç”Ÿæˆ TODO| Y["ğŸ“‹ TODO è¨ˆåŠƒ"]
        Y --> Z["ğŸš€ RQ Worker åŸ·è¡Œ"]
    end

    T -->|"ğŸ” æ¬Šé™å¯©è¨ˆ<br/>ğŸ” å‘é‡æª¢ç´¢<br/>ğŸ“ åœ–è­œæŸ¥è©¢"| AA["ğŸ“– çŸ¥è­˜è§£ç­”"]
    U -->|"ğŸ’¡ ä¸€èˆ¬å¯¦è¸<br/>ğŸ“š å°ˆæ¥­çŸ¥è­˜<br/>ğŸ”— æ¨™è¨»ä¾†æº"| BB["ğŸ“– LLM å›é€€è§£ç­”"]
    W -->|"ğŸ—„ï¸ SQL åŸ·è¡Œ<br/>ğŸ“ˆ æ•¸æ“šè¿”å›"| CC["ğŸ“Š æŸ¥è©¢çµæœ"]
    Z -->|"ğŸ¤– Data-Agent<br/>ğŸ“š KA-Agent <br/>ğŸ’¬ LLM ç”Ÿæˆ"| DD["ğŸ“Š åŸ·è¡Œçµæœ"]

    AA --> EE["ğŸ“¤ å›è¦† + çŒœæ¸¬å•é¡Œ"]
    BB --> EE
    CC --> EE
    DD --> EE

    classDef frontend fill:#e1f5fe,stroke:#01579b,stroke-width:2px;
    classDef backend fill:#f3e5f5,stroke:#4a148c,stroke-width:2px;
    classDef decision fill:#fff3e0,stroke:#e65100,stroke-width:2px;
    classDef action fill:#e8f5e9,stroke:#1b5e20,stroke-width:2px;

    class A,C,D,E,F,G,H,I,J,K,L,M,N frontend;
    class O,P,Q,R,S decision;
    class T,U,V,W,X,Y,Z action;
    class AA,BB,CC,DD,EE backend;
```

### å‰ç«¯åˆ°å¾Œç«¯å®Œæ•´æµç¨‹

```mermaid
graph TD
    A[ç”¨æˆ¶è¼¸å…¥ Prompt/æŒ‡ä»¤] --> B[API Gateway: /api/v1/chat/stream]
    B --> C[Layer 0: GAI æ„åœ–åˆ†é¡]
    C -->|GREETING/THANKS/COMPLAIN| D[ç›´æ¥è¿”å›ç­”æ¡ˆ]
    C -->|CLARIFICATION| E[è«‹æ±‚æ¾„æ¸…]
    C -->|CANCEL/CONTINUE/MODIFY| F[å·¥ä½œæµæ§åˆ¶]
    C -->|"æ¥­å‹™è«‹æ±‚"| G[è½‰ç™¼è‡³ MM-Agent]
    G --> H[MM-Agent LLM æ„åœ–åˆ†é¡]
    H -->|KNOWLEDGE_QUERY| I[è·¯ç”±è‡³ KA-Agent]
    H -->|SIMPLE_QUERY| J[è·¯ç”±è‡³ Data-Agent]
    H -->|COMPLEX_TASK| K[ReAct Planner + RQ Worker]
    H -->|CLARIFICATION| L[è¿”å›æ¾„æ¸…è«‹æ±‚]
```

---

## ğŸ“Š å…©å±¤æ„åœ–åˆ†é¡è©³ç´°èªªæ˜

### ç¬¬ä¸€å±¤ï¼šAI-Box (GAI Router) å‰ç«¯æ„åœ–

#### è·è²¬å®šç¾©

| æ„åœ–é¡å‹ | èªªæ˜ | è™•ç†æ–¹å¼ |
|----------|------|----------|
| GREETING | å•å€™/æ‰“æ‹›å‘¼ | ç›´æ¥å›è¦†å•å€™èªï¼Œä¸åŸ·è¡Œä»»ä½•æ“ä½œ |
| CLARIFICATION | éœ€è¦æ¾„æ¸… | è¿”å›æ¾„æ¸…å•é¡Œï¼Œä¸è½‰ç™¼ MM-Agent |
| CANCEL | å–æ¶ˆä»»å‹™ | çµ‚æ­¢ç•¶å‰ä»»å‹™ï¼Œè¿”å›å–æ¶ˆç¢ºèª |
| CONTINUE | ç¹¼çºŒåŸ·è¡Œ | æ¢å¾©ä¸¦ç¹¼çºŒä¹‹å‰çš„å·¥ä½œæµ |
| MODIFY | é‡æ–°è™•ç† | é‡æ–°åŸ·è¡Œä¹‹å‰çš„ä»»å‹™ |
| HISTORY | é¡¯ç¤ºæ­·å² | è¿”å›å°è©±æ­·å²è¨˜éŒ„ |
| EXPORT | å°å‡ºçµæœ | å°‡çµæœå°å‡ºç‚ºæ–‡ä»¶ |
| CONFIRM | ç¢ºèªå›è¦† | è¦æ±‚ç”¨æˆ¶ç¢ºèªå¾Œç¹¼çºŒ |
| THANKS | æ„Ÿè¬å›è¦† | ç›´æ¥å›è¦†æ„Ÿè¬èª |
| COMPLAIN | é“æ­‰è™•ç† | é“æ­‰ä¸¦å˜—è©¦è£œæ•‘ |
| FEEDBACK | è¨˜éŒ„åé¥‹ | è¨˜éŒ„ç”¨æˆ¶åé¥‹åˆ°ç³»çµ± |

#### å¯¦ç¾ç‹€æ…‹

| æ„åœ–é¡å‹ | å¯¦ç¾ç‹€æ…‹ | èªªæ˜ |
|----------|----------|------|
| GREETING | âš ï¸ éƒ¨åˆ†å¯¦ç¾ | LLM åˆ†é¡å™¨å·²æœ‰ï¼Œä½† AI-Box å±¤æœªèª¿ç”¨ |
| CLARIFICATION | âš ï¸ éƒ¨åˆ†å¯¦ç¾ | LLM åˆ†é¡å™¨å·²æœ‰ï¼Œä½† AI-Box å±¤æœªèª¿ç”¨ |
| CANCEL | âŒ æœªå¯¦ç¾ | éœ€è¦å·¥ä½œæµç‹€æ…‹ç®¡ç† |
| CONTINUE | âš ï¸ éƒ¨åˆ†å¯¦ç¾ | MM-Agent æœ‰å¯¦ç¾ï¼ŒAI-Box æœªæ•´åˆ |
| å…¶ä»– | âŒ æœªå¯¦ç¾ | éœ€è¦é–‹ç™¼ |

#### ç•¶å‰å•é¡Œ

1. **æ¸¬è©¦ç”¨ä¾‹æ¨™è¨˜ç‚º "frontend_only"**ï¼š
   ```python
   # test_intent_classification_50.py
   {"id": "38", "input": "å–æ¶ˆ", "expected": "GREETING", "category": "GAI-MANAGE", "frontend_only": True}
   ```
   - é€™äº›æ„åœ–æ‡‰è©²ç”± AI-Box ç¬¬ä¸€å±¤è™•ç†
   - ç›®å‰æ¨™è¨˜ç‚º `frontend_only` ä½† AI-Box æ²’æœ‰å¯¦ç¾

2. **éœ€è¦å¯¦ç¾çš„åŠŸèƒ½**ï¼š
   - åœ¨ `api/routers/chat.py` çš„ `_process_chat_request()` ä¸­æ·»åŠ  GAI æ„åœ–åˆ†é¡
   - åˆ¤æ–·ç‚º GAI æ„åœ–æ™‚ç›´æ¥è¿”å›ï¼Œä¸è½‰ç™¼ MM-Agent
   - åˆ¤æ–·ç‚ºæ¥­å‹™æ„åœ–æ™‚è½‰ç™¼çµ¦ MM-Agent

### ç¬¬äºŒå±¤ï¼šMM-Agent (BPA) æ¥­å‹™æ„åœ–

#### è·è²¬å®šç¾©

| æ„åœ–é¡å‹ | èªªæ˜ | ä¸‹æ¸¸è™•ç† |
|----------|------|----------|
| KNOWLEDGE_QUERY | æ¥­å‹™çŸ¥è­˜å•é¡Œ | è·¯ç”±è‡³ KA-Agent |
| SIMPLE_QUERY | ç°¡å–®æ•¸æ“šæŸ¥è©¢ | è·¯ç”±è‡³ Data-Agent |
| COMPLEX_TASK | è¤‡é›œä»»å‹™/æ“ä½œæŒ‡å¼• | ReAct Planner + RQ Worker |
| CLARIFICATION | éœ€è¦æ¾„æ¸… | è¿”å›æ¾„æ¸…å•é¡Œ |

#### çŸ¥è­˜ä¾†æºåˆ¤æ–·

| ä¾†æºé¡å‹ | èªªæ˜ | è™•ç†æ–¹å¼ |
|----------|------|----------|
| internal | å…¬å¸å…§éƒ¨çŸ¥è­˜ | KA-Agent æª¢ç´¢å…§éƒ¨çŸ¥è­˜åº« |
| external | å¤–éƒ¨å°ˆæ¥­çŸ¥è­˜ | LLM å›é€€ + ä¸Šç¶²æœå°‹ |
| unknown | ä¾†æºä¸æ˜ | è«‹æ±‚æ¾„æ¸… |

#### å¯¦ç¾ç‹€æ…‹

**MM-Agent æ„åœ–åˆ†é¡ç«¯é»**ï¼š`/home/daniel/ai-box/datalake-system/mm_agent/intent_endpoint.py`

| ç«¯é» | æ–¹æ³• | ç‹€æ…‹ |
|------|------|------|
| `/api/v1/chat/intent` | POST | âœ… å·²å¯¦ç¾ |
| `/api/v1/chat/intent` | GET | âœ… å·²å¯¦ç¾ |
| `/api/v1/chat/intent/stream` | POST | âœ… å·²å¯¦ç¾ |

#### å·¥ä½œæµç¹¼çºŒæ©Ÿåˆ¶

MM-Agent å·²å¯¦ç¾ `CONTINUE_WORKFLOW` æ„åœ–ï¼š

```python
# æª¢æŸ¥æ˜¯å¦æœ‰é€²è¡Œä¸­çš„å·¥ä½œæµ
if session_id in PENDING_WORKFLOWS:
    pending = PENDING_WORKFLOWS.pop(session_id)
    # å•Ÿå‹•å·¥ä½œæµ
    wf_result = await _react_engine.start_workflow(...)
    return {"intent": "CONTINUE_WORKFLOW", ...}
```

---

## ğŸ“Š å„å±¤ç´šè©³ç´°èªªæ˜

### L1: Semantic Understandingï¼ˆèªç¾©ç†è§£ï¼‰

#### è·è²¬å®šç¾©

å›ç­”ã€Œä½¿ç”¨è€…èªªäº†ä»€éº¼ã€ï¼Œä¸å›ç­”ã€Œè¦åšä»€éº¼ã€

#### è¼¸å…¥

- åŸå§‹è‡ªç„¶èªè¨€
- æœ€è¿‘å°è©±æ‘˜è¦
- ç³»çµ±æ¨¡å¼ï¼ˆdesign/execution/sandboxï¼‰

#### è¼¸å‡º Schema

```json
{
  "topics": ["document", "system_design"],
  "entities": ["Document Editing Agent", "API Spec", "Patch Format"],
  "action_signals": ["design", "refine", "structure"],
  "modality": "instruction",
  "certainty": 0.92
}
```

#### ç¾æœ‰å¯¦ç¾

**æ–‡ä»¶ä½ç½®**: `agents/task_analyzer/router_llm.py`

**é—œéµä»£ç¢¼**:

```python
class RouterDecision(BaseModel):
    intent_type: Literal["conversation", "retrieval", "analysis", "execution"]
    complexity: Literal["low", "mid", "high"]
    needs_agent: bool
    needs_tools: bool
    determinism_required: bool
    risk_level: Literal["low", "mid", "high"]
    confidence: float
```

**å¯¦ç¾ç‹€æ…‹**: âœ… å·²å¯¦ç¾ï¼ˆæ“´å±•ç‰ˆï¼‰

### L2: Intent & Task Abstractionï¼ˆæ„åœ–èˆ‡ä»»å‹™æŠ½è±¡ï¼‰

#### è·è²¬å®šç¾©

å°‡èªç¾©ç†è§£è½‰æ›ç‚ºçµæ§‹åŒ–æ„åœ–

#### Intent DSL è¨­è¨ˆ

```plain
INTENT modify_document {
  domain: "system_architecture"
  target: "Document Editing Agent"
  output_format: ["Engineering Spec"]
  depth: "Advanced"
}
```

#### ç¾æœ‰å¯¦ç¾

**æ–‡ä»¶ä½ç½®**: `agents/task_analyzer/intent_registry.py`ï¼ˆéƒ¨åˆ†å¯¦ç¾ï¼‰

**å¯¦ç¾ç‹€æ…‹**: âš ï¸ éƒ¨åˆ†å¯¦ç¾ï¼ˆå‹•æ…‹åˆ†é¡ç‚ºä¸»ï¼ŒDSLåŒ–è¨ˆåŠƒä¸­ï¼‰

### L3: Capability Mapping & Task Planningï¼ˆèƒ½åŠ›æ˜ å°„èˆ‡ä»»å‹™è¦åŠƒï¼‰

#### è·è²¬å®šç¾©

ç™¼ç¾å¯ç”¨èƒ½åŠ›ä¸¦ç”Ÿæˆä»»å‹™åŸ·è¡Œè¨ˆåŠƒ

#### Capability Registry è¨­è¨ˆ

```json
{
  "agent": "DocumentEditingAgent",
  "capabilities": [
    {
      "name": "generate_patch_design",
      "input": "SemanticSpec",
      "output": "PatchPlan"
    }
  ],
  "constraints": {
    "environment": "design_only",
    "writes_system": false
  }
}
```

#### Task DAG è¼¸å‡º

```json
{
  "task_graph": [
    { "id": "T1", "capability": "generate_patch_design" },
    { "id": "T2", "capability": "produce_openapi_spec", "depends_on": ["T1"] }
  ]
}
```

#### ç¾æœ‰å¯¦ç¾

**æ–‡ä»¶ä½ç½®**:

- `agents/task_analyzer/capability_matcher.py` âœ… å·²å¯¦ç¾
- `agents/task_analyzer/task_planner.py` âš ï¸ è¨ˆåŠƒä¸­

**å¯¦ç¾ç‹€æ…‹**: ğŸŸ¡ ä¸­ç­‰å¯¦ç¾ï¼ˆCapability Matching å·²å¯¦ç¾ï¼ŒTask DAG è¨ˆåŠƒä¸­ï¼‰

### L4: Constraint Validation & Policy Checkï¼ˆç´„æŸé©—è­‰èˆ‡ç­–ç•¥æª¢æŸ¥ï¼‰

#### è·è²¬å®šç¾©

é©—è­‰ä»»å‹™åŸ·è¡Œæ˜¯å¦ç¬¦åˆç³»çµ±ç´„æŸå’Œç­–ç•¥

#### é©—è­‰é …ç›®

- æ¬Šé™æª¢æŸ¥
- é¢¨éšªè©•ä¼°
- ç­–ç•¥ç¬¦åˆæ€§
- è³‡æºé™åˆ¶

#### è¼¸å‡ºæ ¼å¼

```json
{
  "allowed": true,
  "requires_confirmation": false,
  "risk_level": "low"
}
```

#### ç¾æœ‰å¯¦ç¾

**æ–‡ä»¶ä½ç½®**: `agents/task_analyzer/policy_service.py`ï¼ˆè¨ˆåŠƒä¸­ï¼‰

**å¯¦ç¾ç‹€æ…‹**: âŒ æœªå¯¦ç¾ï¼ˆè¨ˆåŠƒä¸­ï¼‰

### L5: Execution + Observationï¼ˆåŸ·è¡Œèˆ‡è§€å¯Ÿï¼‰

#### è·è²¬å®šç¾©

åŸ·è¡Œä»»å‹™ä¸¦è¨˜éŒ„åŸ·è¡ŒæŒ‡æ¨™

#### è¨˜éŒ„çµæ§‹

```json
{
  "intent": "modify_document",
  "task_count": 2,
  "execution_success": true,
  "user_correction": false,
  "latency_ms": 4200
}
```

#### çŸ¥è­˜åº«æ¬Šé™ç®¡ç†ï¼ˆ2026-02-03 æ–°å¢ï¼‰

**è¨­è¨ˆç›®æ¨™**ï¼š

1. **çµ±ä¸€å…¥å£**: æ‰€æœ‰çŸ¥è­˜åº«æª¢ç´¢å¿…é ˆé€šé KA-Agent
2. **æ¬Šé™æ§åˆ¶**: Agent éœ€è¦é€šé capabilities æ¨™è¨˜ç²å¾—æ¬Šé™
3. **æœªä¾†æ“´å±•**: è‹¥æª¢ç´¢å‡ç´šï¼Œåªéœ€ä¿®æ”¹ KA-Agentï¼Œå…¶ä»– Agent ç„¡éœ€èª¿æ•´

**æ¬Šé™æ¨™è­˜**ï¼š

| Capability åç¨± | èªªæ˜ | æˆæ¬Šå°è±¡ |
|-----------------|------|----------|
| `mm_agent_knowledge` | MM-Agent çŸ¥è­˜åº«è¨ªå•æ¬Šé™ | éœ€è¦è¨ªå•ç‰©æ–™ç®¡ç†çŸ¥è­˜åº«çš„ Agent |

**æ¬Šé™æª¢æŸ¥æµç¨‹**ï¼š

```
ç”¨æˆ¶é¸æ“‡ Agent + å•é¡Œ
    â†“
Task Analyzer æª¢æ¸¬çŸ¥è­˜æŸ¥è©¢ (Knowledge Signal)
    â†“
Decision Engine æª¢æŸ¥æ¬Šé™
    â”œâ”€ æœ‰æ¬Šé™ â†’ é¸æ“‡ç”¨æˆ¶é¸æ“‡çš„ Agent
    â””â”€ ç„¡æ¬Šé™ â†’ é¸æ“‡ KA-Agent
    â†“
Agent åŸ·è¡Œä»»å‹™
    â”œâ”€ æœ‰æ¬Šé™çš„ Agent â†’ èª¿ç”¨ KA-Agent æª¢ç´¢
    â””â”€ KA-Agent â†’ ç›´æ¥æª¢ç´¢
    â†“
è¿”å›çµæœçµ¦ç”¨æˆ¶
```

**Decision Engine æ¬Šé™æª¢æŸ¥**ï¼š

**æ–‡ä»¶ä½ç½®**: `agents/task_analyzer/decision_engine.py:594-647`

```python
# æª¢æŸ¥ç”¨æˆ¶é¸æ“‡çš„ Agent æ˜¯å¦æœ‰çŸ¥è­˜åº«æ¬Šé™
if is_knowledge_query and user_selected_agent_id:
    registry = get_agent_registry()
    user_agent_info = registry.get_agent_info(user_selected_agent_id)
  
    if user_agent_info:
        has_mm_knowledge = "mm_agent_knowledge" in user_agent_info.capabilities
  
        if has_mm_knowledge:
            # ç”¨æˆ¶é¸æ“‡çš„ Agent æœ‰æ¬Šé™ï¼Œç›´æ¥ä½¿ç”¨è©² Agent
            chosen_agent = user_selected_agent_id
            reasoning_parts.append(
                f"çŸ¥è­˜åº«æŸ¥è©¢ä»»å‹™ï¼Œç”¨æˆ¶é¸æ“‡çš„ Agent '{user_selected_agent_id}' "
                f"æœ‰ MM-Agent çŸ¥è­˜åº«æ¬Šé™ï¼Œå„ªå…ˆä½¿ç”¨è©² Agent"
            )
```

**KA-Agent æ¬Šé™æª¢æŸ¥**ï¼š

**æ–‡ä»¶ä½ç½®**: `agents/builtin/ka_agent/agent.py:554-598`

```python
# Agent æ¬Šé™æª¢æŸ¥ï¼ˆæª¢æŸ¥æ˜¯å¦æœ‰ MM-Agent çŸ¥è­˜åº«è¨ªå•æ¬Šé™ï¼‰
if caller_agent_id:
    agent_info = registry.get_agent_info(caller_agent_id)
  
    if agent_info:
        capabilities = agent_info.capabilities or []
        has_mm_knowledge = "mm_agent_knowledge" in capabilities
  
        if not has_mm_knowledge:
            feedback = self._error_handler.permission_denied(
                user_id=caller_agent_id,
                action="çŸ¥è­˜åº«æª¢ç´¢",
                resource="MM-Agent çŸ¥è­˜åº«",
                reason=f"Agent '{caller_agent_id}' æ²’æœ‰ 'mm_agent_knowledge' èƒ½åŠ›"
            )
            return KAResponse(success=False, ...)
```

#### ç¾æœ‰å¯¦ç¾

**æ–‡ä»¶ä½ç½®**:

- `agents/services/orchestrator/orchestrator.py` âœ… å·²å¯¦ç¾
- `agents/services/observation_collector/` âœ… å·²å¯¦ç¾

**å¯¦ç¾ç‹€æ…‹**: âœ… å·²å¯¦ç¾

---

## ğŸ”§ ä»£ç¢¼æµç¨‹ç›¤é»

### API å…¥å£é»

**æ–‡ä»¶**: `api/routers/chat.py`

**é—œéµå‡½æ•¸**: `chat_product_stream()`

```python
@router.post("/stream", status_code=status.HTTP_200_OK)
async def chat_product_stream(
    request_body: ChatRequest,
    request: Request,
    tenant_id: str = Depends(get_current_tenant_id),
    current_user: User = Depends(get_current_user),
) -> StreamingResponse:
    # 1. ç²å–ç”¨æˆ¶è¼¸å…¥
    messages = [m.model_dump() for m in request_body.messages]
    last_user_text = messages[-1].get("content", "") if messages else ""
  
    # 2. ç¬¬ä¸€å±¤ GAI æ„åœ–åˆ†é¡ï¼ˆå¾…å¯¦ç¾ï¼‰
    gai_intent = classify_gai_intent(last_user_text)
    if gai_intent in GAI_DIRECT_INTENTS:
        return direct_gai_response(gai_intent, last_user_text)
  
    # 3. æª¢æŸ¥å¿«é€Ÿè·¯å¾‘ï¼ˆæ™‚é–“æŸ¥è©¢ç­‰ï¼‰
    if self._check_quick_path(last_user_text, allowed_tools):
        return await self._handle_quick_path(last_user_text, allowed_tools)
  
    # 4. åˆ¤æ–·æ˜¯å¦è½‰ç™¼çµ¦ MM-Agent
    if should_forward_to_mm_agent(last_user_text):
        return await self._forward_to_mm_agent(last_user_text, context)
  
    # 5. èª¿ç”¨ Task Analyzer
    analysis_result = await self._call_task_analyzer(last_user_text, context)
  
    # 6. æ ¹æ“šåˆ†æçµæœè·¯ç”±
    return await self._route_based_on_analysis(analysis_result, context)
```

### MM-Agent æ„åœ–åˆ†é¡ç«¯é»

**æ–‡ä»¶**: `datalake-system/mm_agent/main.py`

**é—œéµå‡½æ•¸**: `classify_intent()`

```python
@app.post("/api/v1/chat/intent")
async def classify_intent(request: ChatRequest) -> dict:
    """æ„åœ–åˆ†é¡ç«¯é»

    æµç¨‹ï¼š
    1. æª¢æŸ¥æ˜¯å¦æœ‰é€²è¡Œä¸­çš„å·¥ä½œæµï¼ˆsession_id å­˜åœ¨ä¸” waiting_for_user=Trueï¼‰
    2. å¦‚æœæ˜¯å»¶çºŒå°è©±ï¼Œç›´æ¥åŸ·è¡Œä¸‹ä¸€æ­¥
    3. å¦‚æœæ˜¯æ–°å°è©±ï¼Œé€²è¡Œæ„åœ–åˆ†é¡
    """
    from mm_agent.intent_endpoint import classify_intent as llm_classify_intent

    instruction = request.instruction
    session_id = request.session_id or f"intent-{id(request)}"

    # æª¢æŸ¥å·¥ä½œæµç‹€æ…‹
    if session_id in PENDING_WORKFLOWS:
        # ç¹¼çºŒåŸ·è¡Œå·¥ä½œæµ
        ...
        return {"intent": "CONTINUE_WORKFLOW", ...}

    # æ–°å°è©±ï¼Œé€²è¡Œ LLM æ„åœ–åˆ†é¡
    result = await llm_classify_intent(instruction, session_id)

    return {
        "success": True,
        "intent": result.intent.value,
        "confidence": result.confidence,
        "is_simple_query": result.is_simple_query,
        "needs_clarification": result.needs_clarification,
        ...
    }
```

### Task Analyzer ä¸»æµç¨‹

**æ–‡ä»¶**: `agents/task_analyzer/analyzer.py`

**é—œéµå‡½æ•¸**: `analyze()`

```python
async def analyze(self, request: TaskAnalysisRequest) -> TaskAnalysisResult:
    # Layer 0: Cheap Gating
    if self._is_simple_query(request.task):
        return await self._handle_simple_query(request, task_id)

    # Layer 1: Fast Answer Layer
    direct_answer_result = await self._try_direct_answer(request, task_id)
    if direct_answer_result:
        return direct_answer_result

    # Layer 2: Semantic Understanding (Router LLM)
    router_input = RouterInput(
        user_query=request.task,
        session_context=request.context or {},
        system_constraints=self.rule_override.get_system_constraints(request.task),
    )
    router_output = await self.router_llm.route(router_input, similar_decisions)

    # Layer 3: Rule Override
    router_output = self.rule_override.apply(router_output, request.task)

    # Layer 4: Capability Matching
    agent_candidates = await self.capability_matcher.match_agents(router_output)
    tool_candidates = await self.capability_matcher.match_tools(router_output)
    model_candidates = await self.capability_matcher.match_models(router_output)

    # Layer 5: Decision Engine
    decision = self.decision_engine.decide(
        router_output,
        agent_candidates,
        tool_candidates,
        model_candidates
    )

    # Layer 6: è¿”å›çµæœ
    return self._build_result(router_output, decision)
```

### MM-Agent è½‰ç™¼æ©Ÿåˆ¶ï¼ˆå·²æœ‰ï¼‰

**æ–‡ä»¶**: `api/routers/chat.py` ç¬¬ 1574 è¡Œ

```python
# 2026-02-04 æ–°å¢ï¼šå¦‚æœæ˜¯ mm-agentï¼Œç›´æ¥èª¿ç”¨ MM-Agentï¼Œè·³é Task Analyzer å’Œ RAG
if user_selected_agent_id == "mm-agent":
    # æ§‹é€  MM-Agent è«‹æ±‚
    from agents.services.registry.registry import get_agent_registry

    registry = get_agent_registry()
    agent_info = registry.get_agent_info("mm-agent")

    if agent_info and agent_info.endpoints and agent_info.endpoints.http:
        mm_endpoint = agent_info.endpoints.http
        mm_request = {
            "task_id": task_id or str(uuid.uuid4()),
            "task_type": "query_stock",
            "task_data": {
                "instruction": last_user_text,
                "user_id": current_user.user_id,
                "session_id": session_id,
            },
        }

        # èª¿ç”¨ MM-Agent
        import httpx
        response = httpx.post(mm_endpoint, json=mm_request, timeout=120.0)

        if response.status_code == 200:
            mm_result = response.json()
            return ChatResponse(content=f"ã€MM-Agent æŸ¥è©¢çµæœã€‘\n{mm_result}")
```

---

## ğŸ¯ é—œéµçµ„ä»¶ç‹€æ…‹ç›¤é»

### å·²å¯¦ç¾çµ„ä»¶

| çµ„ä»¶ | æ–‡ä»¶ä½ç½® | å¯¦ç¾ç‹€æ…‹ | åŠŸèƒ½èªªæ˜ |
|------|----------|----------|----------|
| Router LLM | `agents/task_analyzer/router_llm.py` | âœ… å®Œæ•´å¯¦ç¾ | èªç¾©ç†è§£å’Œè·¯ç”±æ±ºç­– |
| Rule Override | `agents/task_analyzer/rule_override.py` | âœ… å®Œæ•´å¯¦ç¾ | ç¡¬æ€§è¦å‰‡è¦†è“‹ |
| Capability Matcher | `agents/task_analyzer/capability_matcher.py` | âœ… å®Œæ•´å¯¦ç¾ | èƒ½åŠ›åŒ¹é…å’Œè©•åˆ† |
| Decision Engine | `agents/task_analyzer/decision_engine.py` | âœ… å®Œæ•´å¯¦ç¾ | ç¶œåˆæ±ºç­– |
| Routing Memory | `agents/task_analyzer/routing_memory/` | âœ… åŸºç¤å¯¦ç¾ | æ±ºç­–è¨˜æ†¶ |
| Agent Orchestrator | `agents/services/orchestrator/orchestrator.py` | âœ… å®Œæ•´å¯¦ç¾ | Agent å”èª¿åŸ·è¡Œ |
| Observation Collector | `agents/services/observation_collector/` | âœ… å®Œæ•´å¯¦ç¾ | åŸ·è¡Œè§€å¯Ÿ |
| MM-Agent Intent Endpoint | `datalake-system/mm_agent/intent_endpoint.py` | âœ… å®Œæ•´å¯¦ç¾ | BPA æ„åœ–åˆ†é¡ |

### å¾…å¯¦ç¾çµ„ä»¶

| çµ„ä»¶ | æ–‡ä»¶ä½ç½® | å¯¦ç¾ç‹€æ…‹ | åŠŸèƒ½èªªæ˜ |
|------|----------|----------|----------|
| **GAI Intent Classifier** | `api/routers/chat.py` | âŒ æœªå¯¦ç¾ | **ç¬¬ä¸€å±¤å‰ç«¯æ„åœ–åˆ†é¡** |
| Intent Registry | `agents/task_analyzer/intent_registry.py` | ğŸ“… éšæ®µä¸€ | Intent DSL ç®¡ç† |
| Task Planner | `agents/task_analyzer/task_planner.py` | ğŸ“… éšæ®µä¸‰ | DAG ç”Ÿæˆ |
| Policy Service | `agents/task_analyzer/policy_service.py` | ğŸ“… éšæ®µå›› | ç´„æŸæª¢æŸ¥ |

### ç•¶å‰å•é¡Œèˆ‡å¾…è¾¦

| å•é¡Œ | åš´é‡ç¨‹åº¦ | ç‹€æ…‹ | è§£æ±ºæ–¹æ¡ˆ |
|------|----------|------|----------|
| ç¬¬ä¸€å±¤ GAI æ„åœ–æœªå¯¦ç¾ | ğŸ”´ é«˜ | å¾…è™•ç† | åœ¨ chat.py æ·»åŠ  GAI æ„åœ–åˆ†é¡å‡½æ•¸ |
| "frontend_only" æ¸¬è©¦æœªé€šé | ğŸŸ¡ ä¸­ | å¾…è™•ç† | å¯¦ç¾ GAI æ„åœ–åˆ†é¡å¾Œé€™äº›æ¸¬è©¦æ‡‰é€šé |
| å·¥ä½œæµç‹€æ…‹ç®¡ç†ä¸å®Œæ•´ | ğŸŸ¡ ä¸­ | å¾…è™•ç† | å®Œå–„ CANCEL/CONTINUE/MODIFY è™•ç† |
| AI-Box è½‰ç™¼é‚è¼¯éœ€å„ªåŒ– | ğŸŸ¢ ä½ | å·²æœ‰åŸºç¤ | éœ€æ›´æ˜ç¢ºæ¥­å‹™æ„åœ–è½‰ç™¼è·¯å¾‘ |

---

## ğŸ”„ å¯¦éš›åŸ·è¡Œç¤ºä¾‹

### ç¤ºä¾‹ 1ï¼šç”¨æˆ¶å•å€™

**ç”¨æˆ¶è¼¸å…¥**: "ä½ å¥½"

**è™•ç†æµç¨‹**ï¼š

1. **ç¬¬ä¸€å±¤ AI-Box**: GAI æ„åœ–åˆ†é¡åˆ¤æ–·ç‚º `GREETING`
2. **ç›´æ¥è¿”å›**: "æ‚¨å¥½ï¼æˆ‘æ˜¯ AI-Box åŠ©æ‰‹ï¼Œè«‹å•æœ‰ä»€éº¼å¯ä»¥å¹«æ‚¨ï¼Ÿ"
3. **ä¸èµ° MM-Agent**

### ç¤ºä¾‹ 2ï¼šç”¨æˆ¶è«‹æ±‚æ¾„æ¸…

**ç”¨æˆ¶è¼¸å…¥**: "é‚£å€‹æ–™è™Ÿçš„å“åæ˜¯ä»€éº¼ï¼Ÿ"

**è™•ç†æµç¨‹**ï¼š

1. **ç¬¬ä¸€å±¤ AI-Box**: æª¢æ¸¬åˆ°æŒ‡ä»£è©"é‚£å€‹"ï¼Œåˆ¤æ–·ç‚º `CLARIFICATION`
2. **ç›´æ¥è¿”å›**: "è«‹å•æ‚¨èªªçš„æ˜¯å“ªå€‹æ–™è™Ÿï¼Ÿè«‹æä¾›å®Œæ•´çš„æ–™è™Ÿ"
3. **ä¸èµ° MM-Agent**

### ç¤ºä¾‹ 3ï¼šç”¨æˆ¶ç¹¼çºŒå·¥ä½œæµ

**ç”¨æˆ¶è¼¸å…¥**: "æ˜¯ï¼Œç¹¼çºŒåŸ·è¡Œ"

**è™•ç†æµç¨‹**ï¼š

1. **ç¬¬ä¸€å±¤ AI-Box**: GAI æ„åœ–åˆ†é¡åˆ¤æ–·ç‚º `CONTINUE`
2. **æª¢æŸ¥å·¥ä½œæµç‹€æ…‹**: æ‰¾åˆ°é€²è¡Œçš„ä¸­çš„å·¥ä½œæµ
3. **ç¹¼çºŒåŸ·è¡Œ**: åŸ·è¡Œå·¥ä½œæµä¸‹ä¸€æ­¥
4. **ä¸èµ° MM-Agent**

### ç¤ºä¾‹ 4ï¼šæ¥­å‹™æŸ¥è©¢ï¼ˆè½‰ç™¼ MM-Agentï¼‰

**ç”¨æˆ¶è¼¸å…¥**: "æŸ¥è©¢æ–™è™Ÿ 10-0001 çš„åº«å­˜"

**è™•ç†æµç¨‹**ï¼š

1. **ç¬¬ä¸€å±¤ AI-Box**: GAI æ„åœ–åˆ†é¡ç„¡æ³•åŒ¹é…ï¼ˆä¸æ˜¯å•å€™/å–æ¶ˆç­‰ï¼‰
2. **è½‰ç™¼ MM-Agent**: èª¿ç”¨ `/api/v1/chat/intent`
3. **ç¬¬äºŒå±¤ MM-Agent**: LLM æ„åœ–åˆ†é¡åˆ¤æ–·ç‚º `SIMPLE_QUERY`
4. **è·¯ç”± Data-Agent**: åŸ·è¡Œ SQL æŸ¥è©¢
5. **è¿”å›çµæœ**: "æ–™è™Ÿ 10-0001 çš„åº«å­˜ç‚º 100 ä»¶"

### ç¤ºä¾‹ 5ï¼šè¤‡é›œä»»å‹™ï¼ˆè½‰ç™¼ MM-Agentï¼‰

**ç”¨æˆ¶è¼¸å…¥**: "ABC åº«å­˜åˆ†é¡åˆ†æ"

**è™•ç†æµç¨‹**ï¼š

1. **ç¬¬ä¸€å±¤ AI-Box**: GAI æ„åœ–åˆ†é¡ç„¡æ³•åŒ¹é…
2. **è½‰ç™¼ MM-Agent**: èª¿ç”¨ `/api/v1/chat/intent`
3. **ç¬¬äºŒå±¤ MM-Agent**: LLM æ„åœ–åˆ†é¡åˆ¤æ–·ç‚º `COMPLEX_TASK`
4. **ReAct Planner**: ç”Ÿæˆ TODO è¨ˆåŠƒ
5. **RQ Worker åŸ·è¡Œ**: åŸ·è¡Œè¤‡é›œåˆ†æ
6. **è¿”å›çµæœ**: ABC åˆ†é¡çµæœå ±å‘Š

---

## ğŸ“Š æ€§èƒ½æŒ‡æ¨™

### ç›®æ¨™æŒ‡æ¨™

| æŒ‡æ¨™ | ç›®æ¨™å€¼ | ç•¶å‰ç‹€æ…‹ |
|------|--------|----------|
| ç«¯åˆ°ç«¯éŸ¿æ‡‰æ™‚é–“ | â‰¤3ç§’ï¼ˆP95ï¼‰ | âœ… å·²é”æˆ |
| L1 å±¤ç´šéŸ¿æ‡‰æ™‚é–“ | â‰¤1ç§’ï¼ˆP95ï¼‰ | âœ… å·²é”æˆ |
| Intent åŒ¹é…æº–ç¢ºç‡ | â‰¥90% | âœ… å·²é”æˆ |
| Capability ç™¼ç¾æº–ç¢ºç‡ | â‰¥95% | ğŸ“… è¨ˆåŠƒä¸­ |
| ä»»å‹™åŸ·è¡ŒæˆåŠŸç‡ | â‰¥95% | âœ… å·²é”æˆ |

### æ¸¬è©¦æ€§èƒ½æ•¸æ“š

**md-editor å ´æ™¯æ¸¬è©¦**:

- ç¸½å ´æ™¯æ•¸: 50
- å¹³å‡éŸ¿æ‡‰æ™‚é–“: 1004.05ms
- P95 éŸ¿æ‡‰æ™‚é–“: 1127.12ms
- Agent èª¿ç”¨æˆåŠŸç‡: 100%
- Agent åŒ¹é…ç‡: 100%

---

## ğŸš€ æœªä¾†ç™¼å±•æ–¹å‘

### éšæ®µä¸€ï¼šå…©å±¤æ„åœ–åˆ†é¡å¯¦ç¾ï¼ˆé€²è¡Œä¸­ï¼‰

- âœ… MM-Agent BPA æ„åœ–åˆ†é¡ç«¯é»
- ğŸ“… GAI å‰ç«¯æ„åœ–åˆ†é¡å¯¦ç¾
- ğŸ“… çµ±ä¸€æ„åœ–å®šç¾©ï¼ˆGAI + BPAï¼‰
- ğŸ“… è½‰ç™¼é‚è¼¯å„ªåŒ–

### éšæ®µäºŒï¼šL1-L2 å±¤ç´šé‡æ§‹

- âœ… Router LLM è¼¸å‡º Schema æ“´å±•
- âœ… Intent DSL åŒ¹é…é‚è¼¯å¯¦ç¾
- ğŸ“… å¤šæ¨¡å‹ ensembleï¼ˆå¯é¸ï¼‰

### éšæ®µä¸‰ï¼šL3 å±¤ç´šæ“´å±•

- ğŸ“… Task Plannerï¼ˆDAG ç”Ÿæˆï¼‰å¯¦ç¾
- ğŸ“… RAG-2 é›†æˆåˆ° Planner
- ğŸ“… Decision Engine æ”¯æŒ DAG
- ğŸ“… çŸ¥è­˜åº«æ¬Šé™ç´°ç²’åº¦æ§åˆ¶ï¼ˆæ“´å±•æ–¹å‘ï¼‰

### éšæ®µå››ï¼šL4 å±¤ç´šå¯¦ç¾

- ğŸ“… Policy & Constraint Service å¯¦ç¾
- ğŸ“… è¦å‰‡å¼•æ“é›†æˆ
- ğŸ“… RAG-3 ç­–ç•¥æª¢ç´¢
- ğŸ“… æ¬Šé™å¯©è¨ˆèˆ‡ç›£æ§

### éšæ®µäº”ï¼šL5 å±¤ç´šå®Œå–„

- ğŸ“… åŸ·è¡ŒæŒ‡æ¨™è¨˜éŒ„æ“´å±•
- ğŸ“… å‘½ä¸­ç‡çµ±è¨ˆå¯¦ç¾
- ğŸ“… å“è³ªè©•ä¼°é‚è¼¯å¯¦ç¾
- ğŸ“… çŸ¥è­˜åº«ä½¿ç”¨çµ±è¨ˆ

### éšæ®µå…­ï¼šé›†æˆæ¸¬è©¦èˆ‡å„ªåŒ–

- ğŸ“… ç«¯åˆ°ç«¯é›†æˆæ¸¬è©¦
- ğŸ“… æ€§èƒ½æ¸¬è©¦å’Œå„ªåŒ–
- ğŸ“… å›æ­¸æ¸¬è©¦

---

## ğŸ” çŸ¥è­˜åº«æ¬Šé™ç®¡ç†ï¼ˆ2026-02-03 æ–°å¢ï¼‰

### è¨­è¨ˆæ¦‚è¿°

ç‚ºäº†æ»¿è¶³ã€Œçµ±ä¸€çŸ¥è­˜åº«å…¥å£ï¼Œæœªä¾†å‡ç´šç„¡éœ€èª¿æ•´å…¶ä»– Agentã€çš„è¨­è¨ˆç›®æ¨™ï¼Œç³»çµ±å¯¦ç¾äº†åŸºæ–¼ Agent capabilities çš„çŸ¥è­˜åº«æ¬Šé™ç®¡ç†æ©Ÿåˆ¶ã€‚

### æ ¸å¿ƒåŸå‰‡

1. **çµ±ä¸€å…¥å£**: æ‰€æœ‰çŸ¥è­˜åº«æª¢ç´¢å¿…é ˆé€šé KA-Agent
2. **æ¬Šé™æ§åˆ¶**: Agent éœ€è¦é€šé capabilities æ¨™è¨˜ç²å¾—æ¬Šé™
3. **æœªä¾†æ“´å±•**: è‹¥æª¢ç´¢å‡ç´šï¼Œåªéœ€ä¿®æ”¹ KA-Agentï¼Œå…¶ä»– Agent ç„¡éœ€èª¿æ•´

### æ¬Šé™æ¨™è­˜

| Capability åç¨± | èªªæ˜ | æˆæ¬Šå°è±¡ |
|-----------------|------|----------|
| `mm_agent_knowledge` | MM-Agent çŸ¥è­˜åº«è¨ªå•æ¬Šé™ | éœ€è¦è¨ªå•ç‰©æ–™ç®¡ç†çŸ¥è­˜åº«çš„ Agent |

### ä½¿ç”¨å ´æ™¯

#### å ´æ™¯ 1ï¼šæœ‰æ¬Šé™çš„ Agent

**å‰ç½®æ¢ä»¶**ï¼š

- ç”¨æˆ¶é¸æ“‡ã€Œç¶“å¯¶ç‰©æ–™ç®¡ç†ä»£ç†ã€
- ã€Œç¶“å¯¶ç‰©æ–™ç®¡ç†ä»£ç†ã€çš„ capabilities åŒ…å« `"mm_agent_knowledge"`

**ç”¨æˆ¶è¼¸å…¥**ï¼š

```
ç‰©æ–™åº«å­˜æ€æ¨£ï¼Ÿ
```

**åŸ·è¡Œæµç¨‹**ï¼š

1. Knowledge Signal æª¢æ¸¬åˆ°çŸ¥è­˜åº«æŸ¥è©¢
2. Decision Engine æª¢æŸ¥ã€Œç¶“å¯¶ç‰©æ–™ç®¡ç†ä»£ç†ã€æœ‰æ¬Šé™
3. é¸æ“‡ã€Œç¶“å¯¶ç‰©æ–™ç®¡ç†ä»£ç†ã€
4. ã€Œç¶“å¯¶ç‰©æ–™ç®¡ç†ä»£ç†ã€èª¿ç”¨ KA-Agent æª¢ç´¢
5. KA-Agent é©—è­‰æ¬Šé™ä¸¦åŸ·è¡Œæª¢ç´¢
6. ã€Œç¶“å¯¶ç‰©æ–™ç®¡ç†ä»£ç†ã€è¿”å›çµæœ

#### å ´æ™¯ 2ï¼šç„¡æ¬Šé™çš„ Agent

**å‰ç½®æ¢ä»¶**ï¼š

- ç”¨æˆ¶é¸æ“‡ã€ŒæŸå€‹ç„¡æ¬Šé™çš„ Agentã€
- è©² Agent çš„ capabilities ä¸åŒ…å« `"mm_agent_knowledge"`

**ç”¨æˆ¶è¼¸å…¥**ï¼š

```
ç‰©æ–™åº«å­˜æ€æ¨£ï¼Ÿ
```

**åŸ·è¡Œæµç¨‹**ï¼š

1. Knowledge Signal æª¢æ¸¬åˆ°çŸ¥è­˜åº«æŸ¥è©¢
2. Decision Engine æª¢æŸ¥ã€ŒæŸå€‹ç„¡æ¬Šé™çš„ Agentã€ç„¡æ¬Šé™
3. é¸æ“‡ KA-Agent
4. KA-Agent åŸ·è¡Œæª¢ç´¢
5. è¿”å›çµæœ

### ç›¸é—œæ–‡æª”

- [KA-Agent æˆæ¬Šç®¡ç†æ–‡æª”](./KA-Agentæˆæ¬Šç®¡ç†æ–‡æª”.md) - è©³ç´°çš„æ¬Šé™æˆäºˆå’Œç®¡ç†èªªæ˜
- [Agent Registry èªªæ˜](./Agent%20Registry%20èªªæ˜.md) - Agent è¨»å†Šå’Œ capabilities ç®¡ç†

---

## ğŸ“š åƒè€ƒæ–‡æª”

### è¨­è¨ˆæ–‡æª”

- [AI-Boxèªç¾©èˆ‡ä»»å‹™v4é‡æ§‹è¨ˆåŠƒ.md](./AI-Boxèªç¾©èˆ‡ä»»å‹™v4é‡æ§‹è¨ˆåŠƒ.md)
- [AI-Box Enterprise GenAI Semantic & Task Orchestration.md](./AI-Box%20Enterprise%20GenAI%20Semantic%20&%20Task%20Orchestration.md)
- [å¯è¡Œæ€§åˆ†æ-AI-Box-Enterprise-GenAI-Semantic-Task-Orchestration.md](./å¯è¡Œæ€§åˆ†æ-AI-Box-Enterprise-GenAI-Semantic-Task-Orchestration.md)

### å¯¦ç¾æ–‡æª”

- [GenAI å·¥ä½œæµæŒ‡ä»¤-èªç¾©-å·¥å…·-æ¨¡å‹-Agent ç­‰èª¿ç”¨.md](./GenAI%20å·¥ä½œæµæŒ‡ä»¤-èªç¾©-å·¥å…·-æ¨¡å‹-Agent%20ç­‰èª¿ç”¨.md)
- [Task Analyzer ç´°åŒ–é–‹ç™¼è¦æ ¼.md](./Task-Analyzer-ç»†åŒ–å¼€å‘è§„æ ¼.md)

### æ¸¬è©¦æ–‡æª”

- [æ–‡ä»¶ç·¨è¼¯Agentèªç¾©è·¯ç”±æ¸¬è©¦è¨ˆåŠƒ-v4.md](./æ–‡ä»¶ç·¨è¼¯Agentèªç¾©è·¯ç”±æ¸¬è©¦è¨ˆåŠƒ-v4.md)
- [æ–‡ä»¶ç·¨è¼¯Agentèªç¾©è·¯ç”±æ¸¬è©¦è¨ˆåŠƒ-v3.md](./æ–‡ä»¶ç·¨è¼¯Agentèªç¾©è·¯ç”±æ¸¬è©¦è¨ˆåŠƒ-v3.md)

### è¨­è¨ˆåŸå‰‡

- [èªç¾©æ„åœ–åˆ¤æ–·vsé—œéµè©åŒ¹é…èªªæ˜.md](./èªç¾©æ„åœ–åˆ¤æ–·vsé—œéµè©åŒ¹é…èªªæ˜.md)

### æ ¸å¿ƒçµ„ä»¶æ–‡æª”

- [Agent-æ„åœ–åˆ†é¡èˆ‡æ¥­å‹™è™•ç†æ¶æ§‹.md](../Agent-æ„åœ–åˆ†é¡èˆ‡æ¥­å‹™è™•ç†æ¶æ§‹.md) - BPA æ„åœ–åˆ†é¡æ¶æ§‹
- [å‰ç«¯åŠæ™‚åŒæ­¥å›æ‡‰.md](../å‰ç«¯åŠæ™‚åŒæ­¥å›æ‡‰.md) - å‰ç«¯ WebSocket åŒæ­¥æ©Ÿåˆ¶

---

## ğŸ“ æ›´æ–°è¨˜éŒ„

| æ—¥æœŸ | æ›´æ–°å…§å®¹ | æ›´æ–°äºº |
|------|----------|--------|
| 2026-02-09 | v4.3ï¼šæ–°å¢å…©å±¤æ„åœ–åˆ†é¡æ¶æ§‹ï¼ˆGAI å‰ç«¯ + MM-Agent æ¥­å‹™ï¼‰ï¼Œæ›´æ–°æµç¨‹åœ–ï¼Œæ¨™è¨»å¾…å¯¦ç¾åŠŸèƒ½ | Daniel Chung |
| 2026-02-03 | æ–°å¢çŸ¥è­˜åº«æ¬Šé™ç®¡ç†æ©Ÿåˆ¶ï¼Œæ›´æ–° L5 å±¤ç´šèªªæ˜ï¼Œæ·»åŠ ä½¿ç”¨å ´æ™¯ | Daniel Chung |
| 2026-01-23 | å‰µå»ºæœ€æ–°ç‰ˆèªªæ˜æ–‡ä»¶ï¼ŒåŸºæ–¼ v4 æ¶æ§‹æ•´ç†å®Œæ•´æµç¨‹å’Œä»£ç¢¼ç›¤é» | Daniel Chung |

---

## ğŸ“‹ é™„éŒ„ï¼šæ„åœ–åˆ†é¡å°ç…§è¡¨

### GAI å‰ç«¯æ„åœ–ï¼ˆç¬¬ä¸€å±¤ AI-Boxï¼‰

| æ„åœ– | è‹±æ–‡ | è™•ç†æ–¹å¼ | ç‹€æ…‹ |
|------|------|----------|------|
| å•å€™ | GREETING | ç›´æ¥å›è¦†å•å€™ | âš ï¸ éƒ¨åˆ† |
| æ¾„æ¸… | CLARIFICATION | è¿”å›æ¾„æ¸…å•é¡Œ | âš ï¸ éƒ¨åˆ† |
| å–æ¶ˆ | CANCEL | çµ‚æ­¢å·¥ä½œæµ | âŒ æœª |
| ç¹¼çºŒ | CONTINUE | æ¢å¾©å·¥ä½œæµ | âš ï¸ éƒ¨åˆ† |
| ä¿®æ”¹ | MODIFY | é‡æ–°åŸ·è¡Œ | âŒ æœª |
| æ­·å² | HISTORY | è¿”å›æ­·å² | âŒ æœª |
| å°å‡º | EXPORT | å°å‡ºçµæœ | âŒ æœª |
| ç¢ºèª | CONFIRM | è«‹æ±‚ç¢ºèª | âŒ æœª |
| æ„Ÿè¬ | THANKS | å›è¦†æ„Ÿè¬ | âŒ æœª |
| æŠ•è¨´ | COMPLAIN | é“æ­‰è™•ç† | âŒ æœª |
| åé¥‹ | FEEDBACK | è¨˜éŒ„åé¥‹ | âŒ æœª |

### BPA æ¥­å‹™æ„åœ–ï¼ˆç¬¬äºŒå±¤ MM-Agentï¼‰

| æ„åœ– | è‹±æ–‡ | ä¸‹æ¸¸è™•ç† | ç‹€æ…‹ |
|------|------|----------|------|
| çŸ¥è­˜æŸ¥è©¢ | KNOWLEDGE_QUERY | KA-Agent | âœ… å·²å¯¦ç¾ |
| ç°¡å–®æŸ¥è©¢ | SIMPLE_QUERY | Data-Agent | âœ… å·²å¯¦ç¾ |
| è¤‡é›œä»»å‹™ | COMPLEX_TASK | ReAct Planner | âœ… å·²å¯¦ç¾ |
| æ¾„æ¸… | CLARIFICATION | è¿”å›å•é¡Œ | âœ… å·²å¯¦ç¾ |
| ç¹¼çºŒå·¥ä½œæµ | CONTINUE_WORKFLOW | åŸ·è¡Œä¸‹ä¸€æ­¥ | âœ… å·²å¯¦ç¾ |

---

**æ–‡æª”ç‰ˆæœ¬**: v4.3
**æœ€å¾Œæ›´æ–°**: 2026-02-09
**ç¶­è­·äºº**: Daniel Chung
