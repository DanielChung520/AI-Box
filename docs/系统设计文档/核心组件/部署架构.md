# éƒ¨ç½²æ¶æ„æ–‡æ¡£

**åˆ›å»ºæ—¥æœŸ**: 2025-12-25
**åˆ›å»ºäºº**: Daniel Chung
**æœ€åä¿®æ”¹æ—¥æœŸ**: 2025-12-29

**æ›´æ–°è®°å½•**ï¼š

- 2025-12-29ï¼šæ·»åŠ  SeaweedFS åŒæœåŠ¡ Kubernetes éƒ¨ç½²è¯´æ˜ï¼Œæ›´æ–°æ¶æ„å›¾

---

## ğŸ“‹ æ¦‚è¿°

AI-Box é‡‡ç”¨æ··åˆéƒ¨ç½²æ¶æ„ï¼Œæ”¯æŒæœ¬åœ°ç‰©ç†éš”ç¦»ä¸äº‘ç«¯LLMçš„æ··åˆæ¨¡å¼ï¼Œæ»¡è¶³ä¼ä¸šå®‰å…¨ä¸åˆè§„éœ€æ±‚ã€‚ç³»ç»Ÿä½¿ç”¨ Kubernetes å®¹å™¨ç¼–æ’ä¸ Redis Worker å¼‚æ­¥ä»»åŠ¡å¤„ç†ï¼Œå®ç°çµæ´»çš„é›†ç¾¤æ‰©å±•ä¸ç»´æŠ¤ã€‚

---

## ğŸ—ï¸ æ¶æ„è®¾è®¡

### æ··åˆéƒ¨ç½²ç­–ç•¥

**æœ¬åœ°ç‰©ç†éš”ç¦»**ï¼š

- ä¼ä¸šæ•æ„Ÿæ•°æ®ä¼˜å…ˆä½¿ç”¨æœ¬åœ°ç§æœ‰å°æ¨¡å‹å¤„ç†
- æ•°æ®ä¸å‡ºä¼ä¸šï¼Œæ»¡è¶³åˆè§„è¦æ±‚

**äº‘ç«¯LLMä¼˜åŠ¿**ï¼š

- éæ•æ„Ÿåœºæ™¯åˆ©ç”¨äº‘ç«¯å¼ºå¤§LLMèƒ½åŠ›
- é™ä½æˆæœ¬ï¼Œæå‡æ€§èƒ½

### Kubernetes å®¹å™¨ç®¡ç†

**é›†ç¾¤å¼éƒ¨ç½²**ï¼š

- çµæ´»çš„é›†ç¾¤æ‰©å±•
- å®¹å™¨åŒ–éƒ¨ç½²ï¼Œæ˜“äºç»´æŠ¤
- æ”¯æŒé«˜å¯ç”¨é…ç½®

### Redis Worker å¼‚æ­¥ä»»åŠ¡

**å¼‚æ­¥ä»»åŠ¡å¤„ç†**ï¼š

- æ”¯æŒåŒæ­¥ä¸å¹¶å‘
- æ–‡ä»¶å¤„ç†ã€çŸ¥è¯†æå–ç­‰å¼‚æ­¥ä»»åŠ¡
- ä»»åŠ¡é˜Ÿåˆ—ä¸çŠ¶æ€è¿½è¸ª

### SeaweedFS åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿ

**åŒæœåŠ¡éƒ¨ç½²æ¶æ„**ï¼š

AI-Box ç³»ç»Ÿéƒ¨ç½²ä¸¤ä¸ªç‹¬ç«‹çš„ SeaweedFS æœåŠ¡å®ä¾‹ï¼š

1. **AI-Box SeaweedFS æœåŠ¡**ï¼š
   - æœåŠ¡åç§°ï¼š`seaweedfs-ai-box`
   - å­˜å‚¨å†…å®¹ï¼šæ²»ç†ç›¸å…³æ—¥å¿—ã€ç‰ˆæœ¬å†å²ã€å˜æ›´ææ¡ˆã€DataLake å…ƒæ•°æ®ã€AI-Box é¡¹ç›®å…¶ä»–éç»“æ„åŒ–æ•°æ®
   - Kubernetes éƒ¨ç½²é…ç½®ï¼š`k8s/seaweedfs-ai-box/`
   - S3 API ç«¯ç‚¹ï¼š`http://seaweedfs-ai-box-filer:8333`
   - Filer API ç«¯ç‚¹ï¼š`http://seaweedfs-ai-box-filer:8888`

2. **DataLake SeaweedFS æœåŠ¡**ï¼š
   - æœåŠ¡åç§°ï¼š`seaweedfs-datalake`
   - å­˜å‚¨å†…å®¹ï¼šæ–‡ä»¶å¤‡ä»½æ•°æ®ã€DataLake é¡¹ç›®ç›¸å…³å­˜å‚¨éœ€æ±‚
   - Kubernetes éƒ¨ç½²é…ç½®ï¼š`k8s/seaweedfs-datalake/`
   - S3 API ç«¯ç‚¹ï¼š`http://seaweedfs-datalake-filer:8333`
   - Filer API ç«¯ç‚¹ï¼š`http://seaweedfs-datalake-filer:8888`

**éƒ¨ç½²ç»„ä»¶**ï¼š

- **Master èŠ‚ç‚¹**ï¼šç®¡ç†å…ƒæ•°æ®å’Œ Volume èŠ‚ç‚¹ï¼ˆé«˜å¯ç”¨ï¼Œ3 å‰¯æœ¬ï¼‰
- **Volume èŠ‚ç‚¹**ï¼šå­˜å‚¨å®é™…æ•°æ®ï¼ˆå­˜å‚¨èŠ‚ç‚¹ï¼Œ3 å‰¯æœ¬ï¼‰
- **Filer èŠ‚ç‚¹**ï¼šæä¾›æ–‡ä»¶ç³»ç»Ÿæ¥å£å’Œ S3 APIï¼ˆæ–‡ä»¶ç³»ç»Ÿæ¥å£ï¼Œ2 å‰¯æœ¬ï¼‰

**Buckets é…ç½®**ï¼š

AI-Box æœåŠ¡ Bucketsï¼š

- `bucket-governance-logs`ï¼šæ²»ç†ç›¸å…³æ—¥å¿—
- `bucket-version-history`ï¼šç‰ˆæœ¬å†å²è®°å½•
- `bucket-change-proposals`ï¼šå˜æ›´ææ¡ˆè®°å½•
- `bucket-datalake-dictionary`ï¼šDataLake dictionary å®šä¹‰
- `bucket-datalake-schema`ï¼šDataLake schema å®šä¹‰
- `bucket-ai-box-assets`ï¼šAI-Box é¡¹ç›®å…¶ä»–éç»“æ„åŒ–æ•°æ®

DataLake æœåŠ¡ Bucketsï¼š

- `bucket-file-backups`ï¼šæ–‡ä»¶å¤‡ä»½æ•°æ®
- `bucket-datalake-assets`ï¼šDataLake é¡¹ç›®ç›¸å…³å­˜å‚¨éœ€æ±‚

**ç¯å¢ƒå˜é‡é…ç½®**ï¼š

```bash
# AI-Box ä¸“æ¡ˆçš„ SeaweedFS é…ç½®
AI_BOX_SEAWEEDFS_S3_ENDPOINT=http://seaweedfs-ai-box-filer:8333
AI_BOX_SEAWEEDFS_S3_ACCESS_KEY=...
AI_BOX_SEAWEEDFS_S3_SECRET_KEY=...
AI_BOX_SEAWEEDFS_USE_SSL=false
AI_BOX_SEAWEEDFS_FILER_ENDPOINT=http://seaweedfs-ai-box-filer:8888

# DataLake ä¸“æ¡ˆçš„ SeaweedFS é…ç½®
DATALAKE_SEAWEEDFS_S3_ENDPOINT=http://seaweedfs-datalake-filer:8333
DATALAKE_SEAWEEDFS_S3_ACCESS_KEY=...
DATALAKE_SEAWEEDFS_S3_SECRET_KEY=...
DATALAKE_SEAWEEDFS_USE_SSL=false
DATALAKE_SEAWEEDFS_FILER_ENDPOINT=http://seaweedfs-datalake-filer:8888
```

**éƒ¨ç½²æ­¥éª¤**ï¼š

1. éƒ¨ç½² SeaweedFS æœåŠ¡ï¼š

   ```bash
   # éƒ¨ç½² AI-Box SeaweedFS æœåŠ¡
   kubectl apply -f k8s/seaweedfs-ai-box/

   # éƒ¨ç½² DataLake SeaweedFS æœåŠ¡
   kubectl apply -f k8s/seaweedfs-datalake/
   ```

2. åˆ›å»º Bucketsï¼š

   ```bash
   # åˆ›å»ºæ‰€æœ‰ Buckets
   python scripts/migration/create_seaweedfs_buckets.py --service all
   ```

3. éªŒè¯éƒ¨ç½²ï¼š

   ```bash
   # æ£€æŸ¥æœåŠ¡çŠ¶æ€
   kubectl get pods -n ai-box | grep seaweedfs
   kubectl get svc -n ai-box | grep seaweedfs
   ```

---

## ğŸ“Š å®ç°çŠ¶æ€

### å·²å®ŒæˆåŠŸèƒ½

| åŠŸèƒ½æ¨¡å— | çŠ¶æ€ | è¯´æ˜ |
|---------|------|------|
| Dockeréƒ¨ç½² | âœ… å·²å®ç° | Docker Composeé…ç½® |
| Kubernetesé…ç½® | âœ… å·²å®ç° | K8séƒ¨ç½²é…ç½® |
| Redis Worker | âœ… å·²å®ç° | å¼‚æ­¥ä»»åŠ¡å¤„ç† |
| SeaweedFS åŒæœåŠ¡éƒ¨ç½² | âœ… å·²å®ç° | AI-Box å’Œ DataLake ç‹¬ç«‹æœåŠ¡å®ä¾‹ |
| SeaweedFS Buckets é…ç½® | âœ… å·²å®ç° | æ²»ç†æ—¥å¿—ã€ç‰ˆæœ¬å†å²ã€å˜æ›´ææ¡ˆç­‰ Buckets |

---

## ğŸ“š å‚è€ƒèµ„æ–™

### ç›¸å…³æ–‡æ¡£

- [éƒ¨ç½²æ–‡æ¡£](../../å‚™ä»½èˆ‡æ­¸æª”/deployment/)

---

**æœ€åæ›´æ–°æ—¥æœŸ**: 2025-12-29

**æ›´æ–°æ‘˜è¦**ï¼ˆ2025-12-29ï¼‰ï¼š

- æ·»åŠ  SeaweedFS åŒæœåŠ¡éƒ¨ç½²æ¶æ„è¯´æ˜
- æ·»åŠ  Buckets é…ç½®å’Œç¯å¢ƒå˜é‡é…ç½®è¯´æ˜
- æ·»åŠ éƒ¨ç½²æ­¥éª¤å’ŒéªŒè¯æ–¹æ³•
- æ›´æ–°å®ç°çŠ¶æ€è¡¨ï¼Œæ·»åŠ  SeaweedFS ç›¸å…³åŠŸèƒ½
