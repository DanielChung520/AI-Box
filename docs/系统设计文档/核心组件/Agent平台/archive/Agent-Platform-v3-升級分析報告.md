# Agent-Platform.md å‡ç´šåˆ†æå ±å‘Šï¼ˆå·²æ­¸æª”ï¼‰

**ä»£ç¢¼åŠŸèƒ½èªªæ˜**: Agent-Platform.mdï¼ˆåŸ Agent-Platform-v3.mdï¼‰æ–‡æª”å‡ç´šåˆ†æå ±å‘Š - è©•ä¼°æ–‡æª”æ˜¯å¦éœ€è¦æ ¹æ“š v4 æ¶æ§‹é€²è¡Œèª¿æ•´å‡ç´š
**å‰µå»ºæ—¥æœŸ**: 2026-01-13
**å‰µå»ºäºº**: Daniel Chung
**æœ€å¾Œä¿®æ”¹æ—¥æœŸ**: 2026-01-13
**ç‹€æ…‹**: âœ… å·²å®Œæˆä¸¦æ­¸æª”

---

## âš ï¸ æ–‡æª”ç‹€æ…‹

**æœ¬æ–‡æª”å·²å®Œæˆæ­·å²ä½¿å‘½ï¼Œå·²æ­¸æª”ã€‚**

**å‡ç´šçµæœ**ï¼š
- âœ… `Agent-Platform.md`ï¼ˆåŸ `Agent-Platform-v3.md`ï¼‰å·²æˆåŠŸå‡ç´šç‚º v4.0 æ¶æ§‹ï¼ˆå…§éƒ¨ç‰ˆæœ¬ v4.0ï¼‰
- âœ… æ‰€æœ‰å¼•ç”¨æ–‡ä»¶å·²æ›´æ–°
- âœ… å‡ç´šè¨ˆåŠƒæ›¸å·²å‰µå»ºï¼š[Agent-Platform-v4-å‡ç´šè¨ˆåŠƒæ›¸.md](./Agent-Platform-v4-å‡ç´šè¨ˆåŠƒæ›¸.md)

**ç•¶å‰ç‹€æ…‹**ï¼š
- æ–‡æª”æ–‡ä»¶åï¼šå·²é‡å‘½åç‚º `Agent-Platform.md`ï¼ˆ2026-01-13ï¼‰
- æ–‡æª”å…§éƒ¨ç‰ˆæœ¬ï¼šv4.0ï¼ˆå·²å‡ç´šå®Œæˆï¼‰
- æ¶æ§‹èªªæ˜ï¼š5å±¤è™•ç†æµç¨‹ï¼ˆL1-L5ï¼‰

---

## ğŸ“‹ åˆ†ææ¦‚è¿°ï¼ˆæ­·å²è¨˜éŒ„ï¼‰

æœ¬æ–‡æª”åˆ†æ `Agent-Platform.md`ï¼ˆåŸ `Agent-Platform-v3.md`ï¼‰èˆ‡ v4 æ¶æ§‹çš„å·®è·ï¼Œè©•ä¼°æ˜¯å¦éœ€è¦é€²ä¸€æ­¥èª¿æ•´å‡ç´šã€‚

**åˆ†æåŸºæº–**ï¼š[AI-Box èªç¾©èˆ‡ä»»å‹™å·¥ç¨‹-è¨­è¨ˆèªªæ˜æ›¸-v4.md](../èªç¾©èˆ‡ä»»å‹™åˆ†æ/AI-Box èªç¾©èˆ‡ä»»å‹™å·¥ç¨‹-è¨­è¨ˆèªªæ˜æ›¸-v4.md)

---

## âœ… å·²å®Œæˆçš„èª¿æ•´

### 1. æ¶æ§‹ç‰ˆæœ¬èªªæ˜
- âœ… å·²æ·»åŠ  v3 å’Œ v4 æ¶æ§‹çš„å°æ¯”èªªæ˜
- âœ… å·²æ·»åŠ  v4 æ¶æ§‹å±¤ç´šå°æ‡‰è¡¨
- âœ… å·²æ·»åŠ  v4 æ¶æ§‹æ ¸å¿ƒæ”¹é€²èªªæ˜

### 2. æ–‡æª”å¼•ç”¨
- âœ… å·²æ·»åŠ  v4 æ¶æ§‹è¨­è¨ˆèªªæ˜æ›¸çš„å¼•ç”¨éˆæ¥
- âœ… å·²ä¿®å¾©å°ä¸å­˜åœ¨æ–‡æª”çš„å¼•ç”¨

### 3. ç‰ˆæœ¬æ¨™è¨˜
- âœ… å·²æ›´æ–°ç‰ˆæœ¬è™Ÿç‚º "v3 â†’ v4ï¼ˆæ¶æ§‹å‡ç´šä¸­ï¼‰"
- âœ… å·²æ·»åŠ æ¶æ§‹å‡ç´šç‹€æ…‹èªªæ˜

---

## âš ï¸ éœ€è¦é€²ä¸€æ­¥èª¿æ•´çš„å…§å®¹

### 1. Router LLM æè¿°éæ™‚ï¼ˆé«˜å„ªå…ˆç´šï¼‰

**ç•¶å‰ç‹€æ…‹**ï¼š
- æ–‡æª”ä¸­ Router LLM çš„æè¿°ä»ç„¶æ˜¯ v3 æ–¹å¼
- Router LLM ç”¢ç”Ÿ `RouterDecision`ï¼ˆåŒ…å« `intent_type`, `needs_agent` ç­‰ï¼‰
- é€™èˆ‡ v4 æ¶æ§‹è¦æ±‚ä¸ç¬¦

**v4 æ¶æ§‹è¦æ±‚**ï¼š
- **L1 å±¤ç´š**ï¼šRouter LLM åƒ…è² è²¬èªç¾©ç†è§£ï¼Œä¸ç”¢ç”Ÿ intentï¼Œä¸æŒ‡å®š agent
- **è¼¸å‡º**ï¼šæ‡‰è©²æ˜¯ `SemanticUnderstandingOutput`ï¼ˆtopics, entities, action_signals, modality, certaintyï¼‰
- **ä¸æ‡‰è©²**ï¼šç”¢ç”Ÿ `intent_type`, `needs_agent`, `needs_tools` ç­‰æ±ºç­–å­—æ®µ

**éœ€è¦èª¿æ•´**ï¼š
- [ ] æ›´æ–° Router LLM ç« ç¯€ï¼Œæ˜ç¢ºèªªæ˜ v3 å’Œ v4 çš„å€åˆ¥
- [ ] æ·»åŠ  v4 çš„ `SemanticUnderstandingOutput` Schema èªªæ˜
- [ ] èªªæ˜ v3 çš„ `RouterDecision` å°‡åœ¨éæ¸¡æœŸä¿ç•™ï¼Œä½†æœ€çµ‚æœƒè¢«æ›¿æ›

**ä½ç½®**ï¼šç¬¬ 218-256 è¡Œï¼ˆLayer 2: Semantic Intent Analysisï¼‰

---

### 2. ç¼ºå°‘ Intent DSL è©³ç´°èªªæ˜ï¼ˆé«˜å„ªå…ˆç´šï¼‰

**ç•¶å‰ç‹€æ…‹**ï¼š
- æ–‡æª”ä¸­åªæœ‰ v4 æ¶æ§‹çš„ç°¡è¦èªªæ˜ï¼ˆç¬¬ 158 è¡Œï¼‰
- ç¼ºå°‘ Intent DSL çš„è©³ç´°æ ¼å¼ã€ç¤ºä¾‹ã€åŒ¹é…é‚è¼¯

**v4 æ¶æ§‹è¦æ±‚**ï¼š
- **L2 å±¤ç´š**ï¼šåŸºæ–¼ Intent DSL çš„å›ºå®šæ„åœ–é›†åˆï¼ˆ20-50å€‹ï¼‰
- **Intent DSL æ ¼å¼**ï¼šåŒ…å« name, domain, target, output_format, depth, version
- **Intent Registry**ï¼šå­˜å„²å’Œç®¡ç† Intent DSL å®šç¾©
- **åŒ¹é…é‚è¼¯**ï¼šåŸºæ–¼ L1 è¼¸å‡ºï¼ˆtopics, entities, action_signalsï¼‰åŒ¹é… Intent

**éœ€è¦æ·»åŠ **ï¼š
- [ ] æ·»åŠ  Intent DSL è©³ç´°æ ¼å¼èªªæ˜
- [ ] æ·»åŠ  Intent DSL ç¤ºä¾‹
- [ ] æ·»åŠ  Intent Registry èªªæ˜
- [ ] æ·»åŠ  Intent åŒ¹é…é‚è¼¯èªªæ˜
- [ ] èªªæ˜å¾å‹•æ…‹åˆ†é¡åˆ° Intent DSL çš„é·ç§»è·¯å¾‘

**å»ºè­°ä½ç½®**ï¼šåœ¨ v4 æ¶æ§‹èªªæ˜å¾Œï¼Œæ·»åŠ æ–°çš„ç« ç¯€ "L2: Intent & Task Abstraction è©³ç´°èªªæ˜"

---

### 3. ç¼ºå°‘ Capability Registry å’Œ Task DAG èªªæ˜ï¼ˆä¸­å„ªå…ˆç´šï¼‰

**ç•¶å‰ç‹€æ…‹**ï¼š
- æ–‡æª”ä¸­æœ‰ Capability Matcher çš„èªªæ˜ï¼ˆç¬¬ 367-399 è¡Œï¼‰
- ä½†ç¼ºå°‘ v4 æ¶æ§‹è¦æ±‚çš„ Capability Registry å’Œ Task DAG è¦åŠƒ

**v4 æ¶æ§‹è¦æ±‚**ï¼š
- **L3 å±¤ç´š**ï¼šåŸºæ–¼ Capability Registry çš„èƒ½åŠ›ç™¼ç¾
- **Capability Registry**ï¼šå­˜å„² Agent çš„ Capability å®šç¾©
- **Task DAG è¦åŠƒ**ï¼šç”Ÿæˆä»»å‹™åŸ·è¡Œè¨ˆåŠƒï¼ˆTask DAGï¼‰
- **RAG-2 é›†æˆ**ï¼šä½¿ç”¨ RAG-2ï¼ˆCapability Discoveryï¼‰æª¢ç´¢å¯ç”¨èƒ½åŠ›

**éœ€è¦æ·»åŠ **ï¼š
- [ ] æ·»åŠ  Capability Registry è©³ç´°èªªæ˜
- [ ] æ·»åŠ  Capability å®šç¾© Schema
- [ ] æ·»åŠ  Task DAG è¦åŠƒèªªæ˜
- [ ] æ·»åŠ  Task DAG ç¤ºä¾‹
- [ ] èªªæ˜ RAG-2 çš„é›†æˆæ–¹å¼

**å»ºè­°ä½ç½®**ï¼šæ“´å±•ç¾æœ‰çš„ "Layer 3: Decision Engine" ç« ç¯€ï¼Œæˆ–æ·»åŠ æ–°çš„ "L3: Capability Mapping & Task Planning è©³ç´°èªªæ˜"

---

### 4. ç¼ºå°‘ L4 Policy & Constraint å±¤è©³ç´°èªªæ˜ï¼ˆé«˜å„ªå…ˆç´šï¼‰

**ç•¶å‰ç‹€æ…‹**ï¼š
- æ–‡æª”ä¸­åªæœ‰ v4 æ¶æ§‹çš„ç°¡è¦èªªæ˜ï¼ˆç¬¬ 160 è¡Œï¼‰
- ç¼ºå°‘ L4 å±¤çš„è©³ç´°è¨­è¨ˆå’Œå¯¦ç¾è¦æ±‚

**v4 æ¶æ§‹è¦æ±‚**ï¼š
- **L4 å±¤ç´š**ï¼šåŸ·è¡Œå‰çš„æ¬Šé™ã€é¢¨éšªã€ç­–ç•¥å’Œè³‡æºé™åˆ¶æª¢æŸ¥
- **PolicyValidationResult**ï¼šåŒ…å« allowed, requires_confirmation, risk_level, reasons
- **è¦å‰‡å¼•æ“**ï¼šå¼·çƒˆå»ºè­°ä¸ä½¿ç”¨ LLMï¼Œä½¿ç”¨è¦å‰‡å¼•æ“
- **RAG-3 é›†æˆ**ï¼šä½¿ç”¨ RAG-3ï¼ˆPolicy & Constraint Knowledgeï¼‰

**éœ€è¦æ·»åŠ **ï¼š
- [ ] æ·»åŠ  L4 å±¤ç´šè©³ç´°èªªæ˜
- [ ] æ·»åŠ  PolicyValidationResult Schema
- [ ] æ·»åŠ é©—è­‰é …ç›®è©³ç´°èªªæ˜ï¼ˆæ¬Šé™æª¢æŸ¥ã€é¢¨éšªè©•ä¼°ã€ç­–ç•¥ç¬¦åˆæ€§ã€è³‡æºé™åˆ¶ï¼‰
- [ ] æ·»åŠ è¦å‰‡å¼•æ“è¨­è¨ˆèªªæ˜
- [ ] èªªæ˜èˆ‡ Security Agent çš„é›†æˆæ–¹å¼

**å»ºè­°ä½ç½®**ï¼šæ·»åŠ æ–°çš„ç« ç¯€ "L4: Policy & Constraint å±¤è©³ç´°èªªæ˜"

---

### 5. æµç¨‹åœ–éœ€è¦æ›´æ–°ï¼ˆä¸­å„ªå…ˆç´šï¼‰

**ç•¶å‰ç‹€æ…‹**ï¼š
- sequenceDiagram ä»ç„¶ä½¿ç”¨ v3 çš„ Layer 0-3 æµç¨‹ï¼ˆç¬¬ 442-472 è¡Œï¼‰
- ç¼ºå°‘ v4 çš„ L1-L5 æµç¨‹åœ–

**éœ€è¦èª¿æ•´**ï¼š
- [ ] æ›´æ–° sequenceDiagramï¼Œä½¿ç”¨ v4 çš„ L1-L5 æµç¨‹
- [ ] æ·»åŠ  L4 Policy & Constraint æª¢æŸ¥æ­¥é©Ÿ
- [ ] æ·»åŠ  Intent DSL åŒ¹é…æ­¥é©Ÿ
- [ ] æ·»åŠ  Task DAG è¦åŠƒæ­¥é©Ÿ

**å»ºè­°ä½ç½®**ï¼šæ›´æ–° "å®Œæ•´ä»»å‹™è™•ç†æµç¨‹" ç« ç¯€ï¼ˆç¬¬ 437-472 è¡Œï¼‰

---

### 6. æ•¸æ“šæ¨¡å‹éœ€è¦æ›´æ–°ï¼ˆä¸­å„ªå…ˆç´šï¼‰

**ç•¶å‰ç‹€æ…‹**ï¼š
- æ–‡æª”ä¸­çš„æ•¸æ“šæ¨¡å‹ä»ç„¶æ˜¯ v3 çš„ï¼ˆRouterDecision, DecisionResult ç­‰ï¼‰
- ç¼ºå°‘ v4 çš„æ–°æ•¸æ“šæ¨¡å‹

**v4 æ¶æ§‹æ–°æ•¸æ“šæ¨¡å‹**ï¼š
- `SemanticUnderstandingOutput`ï¼ˆL1 è¼¸å‡ºï¼‰
- `IntentDSL`ï¼ˆL2 è¼¸å‡ºï¼‰
- `TaskDAG`ï¼ˆL3 è¼¸å‡ºï¼‰
- `PolicyValidationResult`ï¼ˆL4 è¼¸å‡ºï¼‰
- `ExecutionRecord`ï¼ˆL5 è¼¸å‡ºï¼‰

**éœ€è¦èª¿æ•´**ï¼š
- [ ] æ·»åŠ  v4 æ–°æ•¸æ“šæ¨¡å‹çš„ Schema èªªæ˜
- [ ] èªªæ˜ v3 å’Œ v4 æ•¸æ“šæ¨¡å‹çš„å°æ‡‰é—œä¿‚
- [ ] èªªæ˜éæ¸¡æœŸçš„å…¼å®¹æ€§è™•ç†

**å»ºè­°ä½ç½®**ï¼šåœ¨ "åƒæ•¸å‚³éèˆ‡èª¿ç”¨" ç« ç¯€ä¸­æ·»åŠ  v4 æ•¸æ“šæ¨¡å‹èªªæ˜

---

### 7. Layer 0 å’Œ Layer 1 çš„å®šä½ï¼ˆä½å„ªå…ˆç´šï¼‰

**ç•¶å‰ç‹€æ…‹**ï¼š
- æ–‡æª”ä¸­è©³ç´°æè¿°äº† Layer 0ï¼ˆCheap Gatingï¼‰å’Œ Layer 1ï¼ˆFast Answerï¼‰
- ä½† v4 æ¶æ§‹ä¸­æ²’æœ‰æ˜ç¢ºå°æ‡‰çš„å±¤ç´š

**éœ€è¦èªªæ˜**ï¼š
- [ ] èªªæ˜ Layer 0 å’Œ Layer 1 åœ¨ v4 æ¶æ§‹ä¸­çš„å®šä½
- [ ] èªªæ˜é€™äº›å±¤ç´šæ˜¯å¦ä¿ç•™ï¼Œé‚„æ˜¯æ•´åˆåˆ° L1 ä¸­
- [ ] èªªæ˜éæ¸¡æœŸçš„è™•ç†æ–¹å¼

**å»ºè­°ä½ç½®**ï¼šåœ¨ v3/v4 æ¶æ§‹å°æ¯”èªªæ˜ä¸­æ·»åŠ 

---

### 8. ç¼ºå°‘å¯¦æ–½è¨ˆåŠƒå’Œé·ç§»è·¯å¾‘ï¼ˆä¸­å„ªå…ˆç´šï¼‰

**ç•¶å‰ç‹€æ…‹**ï¼š
- æ–‡æª”èªªæ˜äº† v4 æ¶æ§‹çš„ç›®æ¨™ï¼Œä½†ç¼ºå°‘å…·é«”çš„å¯¦æ–½è¨ˆåŠƒ

**éœ€è¦æ·»åŠ **ï¼š
- [ ] æ·»åŠ å¾ v3 åˆ° v4 çš„é·ç§»è·¯å¾‘
- [ ] æ·»åŠ å„å±¤ç´šçš„å¯¦æ–½å„ªå…ˆç´š
- [ ] æ·»åŠ éæ¸¡æœŸå…¼å®¹æ€§è™•ç†èªªæ˜
- [ ] æ·»åŠ æ¸¬è©¦å’Œé©—è­‰è¨ˆåŠƒ

**å»ºè­°ä½ç½®**ï¼šæ·»åŠ æ–°çš„ç« ç¯€ "v3 â†’ v4 é·ç§»è¨ˆåŠƒ"

---

## ğŸ“Š èª¿æ•´å„ªå…ˆç´šè©•ä¼°

| å„ªå…ˆç´š | èª¿æ•´é …ç›® | å½±éŸ¿ç¯„åœ | ç·Šæ€¥ç¨‹åº¦ |
|--------|---------|---------|---------|
| **ğŸ”´ é«˜** | Router LLM æè¿°æ›´æ–° | æ ¸å¿ƒçµ„ä»¶ | é«˜ |
| **ğŸ”´ é«˜** | Intent DSL è©³ç´°èªªæ˜ | æ ¸å¿ƒçµ„ä»¶ | é«˜ |
| **ğŸ”´ é«˜** | L4 Policy & Constraint å±¤èªªæ˜ | æ–°å¢å±¤ç´š | é«˜ |
| **ğŸŸ¡ ä¸­** | Capability Registry å’Œ Task DAG | æ ¸å¿ƒçµ„ä»¶ | ä¸­ |
| **ğŸŸ¡ ä¸­** | æµç¨‹åœ–æ›´æ–° | æ–‡æª”å®Œæ•´æ€§ | ä¸­ |
| **ğŸŸ¡ ä¸­** | æ•¸æ“šæ¨¡å‹æ›´æ–° | æ–‡æª”å®Œæ•´æ€§ | ä¸­ |
| **ğŸŸ¡ ä¸­** | å¯¦æ–½è¨ˆåŠƒå’Œé·ç§»è·¯å¾‘ | å¯¦ç”¨æ€§ | ä¸­ |
| **ğŸŸ¢ ä½** | Layer 0/1 å®šä½èªªæ˜ | æ–‡æª”å®Œæ•´æ€§ | ä½ |

---

## ğŸ¯ å»ºè­°çš„èª¿æ•´æ–¹æ¡ˆ

### æ–¹æ¡ˆä¸€ï¼šæ¼¸é€²å¼æ›´æ–°ï¼ˆæ¨è–¦ï¼‰

**å„ªé»**ï¼š
- ä¿ç•™ v3 æ¶æ§‹çš„è©³ç´°èªªæ˜ï¼ˆç•¶å‰å¯¦ç¾ï¼‰
- é€æ­¥æ·»åŠ  v4 æ¶æ§‹çš„è©³ç´°èªªæ˜
- æ–‡æª”çµæ§‹æ¸…æ™°ï¼Œæ˜“æ–¼ç†è§£

**èª¿æ•´å…§å®¹**ï¼š
1. ä¿ç•™ç¾æœ‰çš„ v3 æ¶æ§‹è©³ç´°èªªæ˜ï¼ˆLayer 0-3ï¼‰
2. åœ¨æ¯å€‹ v3 ç« ç¯€å¾Œï¼Œæ·»åŠ å°æ‡‰çš„ v4 æ¶æ§‹èªªæ˜
3. æ·»åŠ æ–°çš„ v4 å°ˆå±¬ç« ç¯€ï¼ˆL4, Intent DSL, Task DAG ç­‰ï¼‰
4. æ›´æ–°æµç¨‹åœ–ï¼ŒåŒæ™‚å±•ç¤º v3 å’Œ v4 æµç¨‹

**é©ç”¨å ´æ™¯**ï¼šéæ¸¡æœŸï¼Œv3 å’Œ v4 ä¸¦å­˜

---

### æ–¹æ¡ˆäºŒï¼šé‡æ§‹ç‚º v4 ä¸»å°

**å„ªé»**ï¼š
- æ–‡æª”çµæ§‹æ›´ç¬¦åˆ v4 æ¶æ§‹
- æ¸›å°‘æ··æ·†ï¼Œå°ˆæ³¨ v4 è¨­è¨ˆ

**èª¿æ•´å…§å®¹**ï¼š
1. ä»¥ v4 çš„ L1-L5 ç‚ºä¸»ç·šé‡æ§‹æ–‡æª”
2. å°‡ v3 çš„ Layer 0-3 ä½œç‚ºé™„éŒ„æˆ–æ­·å²èªªæ˜
3. è©³ç´°èªªæ˜ v4 å„å±¤ç´šçš„è¨­è¨ˆå’Œå¯¦ç¾

**é©ç”¨å ´æ™¯**ï¼šv4 æ¶æ§‹å®Œå…¨å¯¦æ–½å¾Œ

---

### æ–¹æ¡ˆä¸‰ï¼šé›™ç‰ˆæœ¬ä¸¦å­˜

**å„ªé»**ï¼š
- æ¸…æ™°åˆ†é›¢ v3 å’Œ v4 å…§å®¹
- ä¾¿æ–¼å°æ¯”å’Œç†è§£

**èª¿æ•´å…§å®¹**ï¼š
1. å°‡æ–‡æª”æ‹†åˆ†ç‚ºå…©éƒ¨åˆ†ï¼šv3 æ¶æ§‹èªªæ˜å’Œ v4 æ¶æ§‹èªªæ˜
2. åœ¨æ¯å€‹éƒ¨åˆ†ä¸­è©³ç´°èªªæ˜å„è‡ªçš„è¨­è¨ˆ
3. æ·»åŠ å°æ¯”ç« ç¯€ï¼Œèªªæ˜å·®ç•°å’Œé·ç§»è·¯å¾‘

**é©ç”¨å ´æ™¯**ï¼šéœ€è¦åŒæ™‚ç¶­è­· v3 å’Œ v4 æ–‡æª”

---

## ğŸ“ å…·é«”èª¿æ•´å»ºè­°

### 1. ç«‹å³èª¿æ•´ï¼ˆé«˜å„ªå…ˆç´šï¼‰

#### 1.1 æ›´æ–° Router LLM ç« ç¯€

**ä½ç½®**ï¼šç¬¬ 218-256 è¡Œ

**èª¿æ•´å…§å®¹**ï¼š
```markdown
#### Layer 2: Semantic Intent Analysisï¼ˆèªç¾©æ„åœ–åˆ†æï¼‰- v3 æ¶æ§‹

**v3 æ¶æ§‹èªªæ˜**ï¼šä½¿ç”¨ Router LLM é€²è¡Œæ·±åº¦èªç¾©åˆ†æï¼Œç†è§£ç”¨æˆ¶çœŸå¯¦æ„åœ–ã€‚

**RouterDecision Schema**ï¼ˆv3ï¼‰ï¼š
```python
class RouterDecision(BaseModel):
    """Router æ±ºç­–çµæœï¼ˆv3ï¼‰"""
    intent_type: Literal["conversation", "retrieval", "analysis", "execution"]
    # ...
```

---

#### L1: Semantic Understandingï¼ˆèªç¾©ç†è§£å±¤ï¼‰- v4 æ¶æ§‹

**v4 æ¶æ§‹èªªæ˜**ï¼šç´”èªç¾©ç†è§£ï¼Œä¸ç”¢ç”Ÿ intentï¼Œä¸æŒ‡å®š agentã€‚

**SemanticUnderstandingOutput Schema**ï¼ˆv4ï¼‰ï¼š
```python
class SemanticUnderstandingOutput(BaseModel):
    """L1 å±¤ç´šè¼¸å‡ºï¼šèªç¾©ç†è§£çµæœ"""
    topics: List[str]
    entities: List[str]
    action_signals: List[str]
    modality: Literal["instruction", "question", "conversation", "command"]
    certainty: float
```

**å¯¦ç¾è¦æ±‚**ï¼š
- âŒ **ä¸ç”¢ç”Ÿ intent**ï¼ˆintent åœ¨ L2 å±¤ç´šç”¢ç”Ÿï¼‰
- âŒ **ä¸æŒ‡å®š agent**ï¼ˆagent é¸æ“‡åœ¨ L3 å±¤ç´šï¼‰
- âœ” **å¯å¤šæ¨¡å‹ ensemble**ï¼ˆæå‡ç©©å®šåº¦ï¼Œå¯é¸ï¼‰

**éæ¸¡æœŸè™•ç†**ï¼š
- v3 çš„ `RouterDecision` å°‡åœ¨éæ¸¡æœŸä¿ç•™
- é€æ­¥é·ç§»åˆ° v4 çš„ `SemanticUnderstandingOutput`
```

#### 1.2 æ·»åŠ  Intent DSL è©³ç´°èªªæ˜

**ä½ç½®**ï¼šåœ¨ v4 æ¶æ§‹èªªæ˜å¾Œï¼ˆç´„ç¬¬ 163 è¡Œå¾Œï¼‰

**èª¿æ•´å…§å®¹**ï¼š
```markdown
---

## L2: Intent & Task Abstractionï¼ˆæ„åœ–èˆ‡ä»»å‹™æŠ½è±¡å±¤ï¼‰- v4 æ¶æ§‹è©³ç´°èªªæ˜

### Intent DSL è¨­è¨ˆ

**Intent DSLï¼ˆv0.1ï¼‰æ ¼å¼**ï¼š

```python
class IntentDSL(BaseModel):
    """Intent DSL å®šç¾©"""
    name: str = Field(..., description="Intent åç¨±ï¼Œå¦‚ 'modify_document'")
    domain: str = Field(..., description="é ˜åŸŸï¼Œå¦‚ 'system_architecture'")
    target: Optional[str] = Field(None, description="ç›®æ¨™ Agentï¼Œå¦‚ 'Document Editing Agent'")
    output_format: List[str] = Field(default_factory=list, description="è¼¸å‡ºæ ¼å¼ï¼Œå¦‚ ['Engineering Spec']")
    depth: Literal["Basic", "Intermediate", "Advanced"] = Field(..., description="æ·±åº¦ç´šåˆ¥")
    version: str = Field(..., description="ç‰ˆæœ¬è™Ÿï¼Œå¦‚ '1.0.0'")
```

**ç¤ºä¾‹ Intent**ï¼š
```plain text
INTENT modify_document {
  domain: "system_architecture"
  target: "Document Editing Agent"
  output_format: ["Engineering Spec"]
  depth: "Advanced"
  version: "1.0.0"
}
```

### Intent Registry

**æ–‡ä»¶ä½ç½®**ï¼š`agents/task_analyzer/intent_registry.py`ï¼ˆéœ€æ–°å»ºï¼‰

**åŠŸèƒ½**ï¼š
- å­˜å„²å’Œç®¡ç† Intent DSL å®šç¾©
- æä¾› Intent åŒ¹é…å’ŒæŸ¥è©¢æ¥å£
- æ”¯æŒç‰ˆæœ¬ç®¡ç†å’Œæ›´æ–°

**æ•¸æ“šå­˜å„²**ï¼šArangoDB Collection `intent_registry`

### Intent åŒ¹é…é‚è¼¯

**åŒ¹é…ä¾æ“š**ï¼šåŸºæ–¼ L1 è¼¸å‡ºï¼ˆtopics, entities, action_signalsï¼‰

**åŒ¹é…æµç¨‹**ï¼š
1. å¾ L1 è¼¸å‡ºæå–é—œéµä¿¡æ¯
2. æŸ¥è©¢ Intent Registryï¼ŒåŒ¹é…ç›¸ä¼¼çš„ Intent
3. å¦‚æœç„¡æ³•åŒ¹é…ï¼Œä½¿ç”¨ Fallback Intent
4. ä¿ç•™å‹•æ…‹åˆ†é¡ä½œç‚ºéæ¸¡æœŸ Fallback
```

#### 1.3 æ·»åŠ  L4 Policy & Constraint å±¤è©³ç´°èªªæ˜

**ä½ç½®**ï¼šåœ¨ L3 èªªæ˜å¾Œï¼ˆç´„ç¬¬ 400 è¡Œå¾Œï¼‰

**èª¿æ•´å…§å®¹**ï¼š
```markdown
---

## L4: Policy & Constraintï¼ˆç­–ç•¥æª¢æŸ¥èˆ‡ç´„æŸé©—è­‰å±¤ï¼‰- v4 æ¶æ§‹è©³ç´°èªªæ˜

### è·è²¬å®šç¾©

åœ¨åŸ·è¡Œå‰é€²è¡Œæ¬Šé™ã€é¢¨éšªã€ç­–ç•¥å’Œè³‡æºé™åˆ¶æª¢æŸ¥ã€‚

### é©—è­‰é …ç›®

1. **æ¬Šé™æª¢æŸ¥**ï¼šç”¨æˆ¶æ˜¯å¦æœ‰æ¬Šé™åŸ·è¡Œè©²ä»»å‹™
2. **é¢¨éšªè©•ä¼°**ï¼šä»»å‹™çš„é¢¨éšªç­‰ç´š
3. **ç­–ç•¥ç¬¦åˆæ€§**ï¼šæ˜¯å¦ç¬¦åˆç³»çµ±ç­–ç•¥
4. **è³‡æºé™åˆ¶**ï¼šæ˜¯å¦è¶…éè³‡æºé™åˆ¶

### è¼¸å‡º Schema

```python
class PolicyValidationResult(BaseModel):
    """L4 å±¤ç´šè¼¸å‡ºï¼šç­–ç•¥é©—è­‰çµæœ"""
    allowed: bool = Field(..., description="æ˜¯å¦å…è¨±åŸ·è¡Œ")
    requires_confirmation: bool = Field(default=False, description="æ˜¯å¦éœ€è¦ç”¨æˆ¶ç¢ºèª")
    risk_level: Literal["low", "mid", "high"] = Field(..., description="é¢¨éšªç­‰ç´š")
    reasons: List[str] = Field(default_factory=list, description="æ‹’çµ•æˆ–éœ€è¦ç¢ºèªçš„åŸå› ")
```

### è¨­è¨ˆé‡é»

ğŸ‘‰ **å¼·çƒˆå»ºè­°ä¸ç”¨ LLM**ï¼šä½¿ç”¨è¦å‰‡å¼•æ“é€²è¡Œé©—è­‰

### å·¥ç¨‹å¯¦ç¾

**æ–‡ä»¶ä½ç½®**ï¼š`agents/task_analyzer/policy_service.py`ï¼ˆéœ€æ–°å»ºï¼‰

**ç•¶å‰å¯¦ç¾**ï¼š
- âœ… Security Agent å·²å¯¦ç¾æ¬Šé™æª¢æŸ¥
- âŒ Policy & Constraint Service æœªå¯¦ç¾ï¼ˆéœ€æ–°å»ºï¼‰

**å¯¦ç¾è¦æ±‚**ï¼š
1. å»ºç«‹ Policy & Constraint Service
2. å¯¦ç¾è¦å‰‡å¼•æ“ï¼ˆä¸ä½¿ç”¨ LLMï¼‰
3. é›†æˆ Security Agent æ¬Šé™æª¢æŸ¥
4. å®šç¾©é¢¨éšªè©•ä¼°è¦å‰‡
5. å¯¦ç¾è³‡æºé™åˆ¶æª¢æŸ¥
6. é›†æˆ RAG-3ï¼ˆPolicy & Constraint Knowledgeï¼‰

**RAG ä½¿ç”¨**ï¼šâœ… å¿…é ˆä½¿ç”¨ RAG-3ï¼ˆPolicy & Constraint Knowledgeï¼‰
```

---

### 2. ä¸­æœŸèª¿æ•´ï¼ˆä¸­å„ªå…ˆç´šï¼‰

#### 2.1 æ›´æ–°æµç¨‹åœ–

**ä½ç½®**ï¼šç¬¬ 437-472 è¡Œ

**èª¿æ•´å…§å®¹**ï¼š
- æ›´æ–° sequenceDiagramï¼Œä½¿ç”¨ v4 çš„ L1-L5 æµç¨‹
- æ·»åŠ  L4 Policy & Constraint æª¢æŸ¥æ­¥é©Ÿ
- æ·»åŠ  Intent DSL åŒ¹é…æ­¥é©Ÿ
- æ·»åŠ  Task DAG è¦åŠƒæ­¥é©Ÿ

#### 2.2 æ·»åŠ  Capability Registry å’Œ Task DAG èªªæ˜

**ä½ç½®**ï¼šæ“´å±• "Layer 3: Decision Engine" ç« ç¯€

**èª¿æ•´å…§å®¹**ï¼š
- æ·»åŠ  Capability Registry è©³ç´°èªªæ˜
- æ·»åŠ  Task DAG è¦åŠƒèªªæ˜
- æ·»åŠ  RAG-2 é›†æˆèªªæ˜

#### 2.3 æ›´æ–°æ•¸æ“šæ¨¡å‹ç« ç¯€

**ä½ç½®**ï¼šç¬¬ 474-625 è¡Œ

**èª¿æ•´å…§å®¹**ï¼š
- æ·»åŠ  v4 æ–°æ•¸æ“šæ¨¡å‹çš„ Schema èªªæ˜
- èªªæ˜ v3 å’Œ v4 æ•¸æ“šæ¨¡å‹çš„å°æ‡‰é—œä¿‚

---

### 3. é•·æœŸèª¿æ•´ï¼ˆä½å„ªå…ˆç´šï¼‰

#### 3.1 æ·»åŠ å¯¦æ–½è¨ˆåŠƒå’Œé·ç§»è·¯å¾‘

**ä½ç½®**ï¼šæ–‡æª”æœ«å°¾

**èª¿æ•´å…§å®¹**ï¼š
- æ·»åŠ å¾ v3 åˆ° v4 çš„é·ç§»è·¯å¾‘
- æ·»åŠ å„å±¤ç´šçš„å¯¦æ–½å„ªå…ˆç´š
- æ·»åŠ éæ¸¡æœŸå…¼å®¹æ€§è™•ç†èªªæ˜

---

## ğŸ“‹ èª¿æ•´æª¢æŸ¥æ¸…å–®

### é«˜å„ªå…ˆç´šï¼ˆå¿…é ˆèª¿æ•´ï¼‰

- [ ] æ›´æ–° Router LLM ç« ç¯€ï¼Œæ˜ç¢º v3 å’Œ v4 çš„å€åˆ¥
- [ ] æ·»åŠ  v4 çš„ `SemanticUnderstandingOutput` Schema èªªæ˜
- [ ] æ·»åŠ  Intent DSL è©³ç´°èªªæ˜ç« ç¯€
- [ ] æ·»åŠ  Intent Registry èªªæ˜
- [ ] æ·»åŠ  L4 Policy & Constraint å±¤è©³ç´°èªªæ˜ç« ç¯€
- [ ] æ·»åŠ  `PolicyValidationResult` Schema èªªæ˜

### ä¸­å„ªå…ˆç´šï¼ˆå»ºè­°èª¿æ•´ï¼‰

- [ ] æ·»åŠ  Capability Registry è©³ç´°èªªæ˜
- [ ] æ·»åŠ  Task DAG è¦åŠƒèªªæ˜
- [ ] æ›´æ–° sequenceDiagram ç‚º v4 æµç¨‹
- [ ] æ·»åŠ  v4 æ–°æ•¸æ“šæ¨¡å‹èªªæ˜
- [ ] æ·»åŠ å¯¦æ–½è¨ˆåŠƒå’Œé·ç§»è·¯å¾‘ç« ç¯€

### ä½å„ªå…ˆç´šï¼ˆå¯é¸èª¿æ•´ï¼‰

- [ ] èªªæ˜ Layer 0/1 åœ¨ v4 æ¶æ§‹ä¸­çš„å®šä½
- [ ] æ·»åŠ  v3/v4 å°æ¯”è¡¨æ ¼
- [ ] æ·»åŠ éæ¸¡æœŸå…¼å®¹æ€§è™•ç†èªªæ˜

---

## ğŸ¯ çµè«–

### æ˜¯å¦éœ€è¦èª¿æ•´ï¼Ÿ

**ç­”æ¡ˆï¼šâœ… æ˜¯çš„ï¼Œéœ€è¦é€²ä¸€æ­¥èª¿æ•´**

### èª¿æ•´åŸå› 

1. **æ¶æ§‹æè¿°ä¸å®Œæ•´**ï¼šæ–‡æª”ä¸­ v4 æ¶æ§‹åªæœ‰æ¦‚è¿°ï¼Œç¼ºå°‘å„å±¤ç´šçš„è©³ç´°èªªæ˜
2. **é—œéµçµ„ä»¶ç¼ºå¤±**ï¼šç¼ºå°‘ Intent DSLã€Capability Registryã€Task DAGã€L4 å±¤ç´šçš„è©³ç´°èªªæ˜
3. **æµç¨‹æè¿°éæ™‚**ï¼šæµç¨‹åœ–å’Œæ•¸æ“šæ¨¡å‹ä»ç„¶æ˜¯ v3 çš„ï¼Œéœ€è¦æ›´æ–°ç‚º v4
4. **å¯¦æ–½æŒ‡å°ä¸è¶³**ï¼šç¼ºå°‘å¾ v3 åˆ° v4 çš„é·ç§»è·¯å¾‘å’Œå¯¦æ–½è¨ˆåŠƒ

### å»ºè­°çš„èª¿æ•´æ–¹å¼

**æ¨è–¦æ–¹æ¡ˆä¸€ï¼šæ¼¸é€²å¼æ›´æ–°**

- ä¿ç•™ v3 æ¶æ§‹çš„è©³ç´°èªªæ˜ï¼ˆç•¶å‰å¯¦ç¾ï¼‰
- é€æ­¥æ·»åŠ  v4 æ¶æ§‹çš„è©³ç´°èªªæ˜
- åœ¨éæ¸¡æœŸåŒæ™‚ç¶­è­· v3 å’Œ v4 å…§å®¹
- æ–‡æª”çµæ§‹æ¸…æ™°ï¼Œæ˜“æ–¼ç†è§£

### èª¿æ•´å„ªå…ˆç´š

1. **ç«‹å³èª¿æ•´**ï¼ˆé«˜å„ªå…ˆç´šï¼‰ï¼š
   - Router LLM æè¿°æ›´æ–°
   - Intent DSL è©³ç´°èªªæ˜
   - L4 Policy & Constraint å±¤èªªæ˜

2. **ä¸­æœŸèª¿æ•´**ï¼ˆä¸­å„ªå…ˆç´šï¼‰ï¼š
   - Capability Registry å’Œ Task DAG
   - æµç¨‹åœ–æ›´æ–°
   - æ•¸æ“šæ¨¡å‹æ›´æ–°

3. **é•·æœŸèª¿æ•´**ï¼ˆä½å„ªå…ˆç´šï¼‰ï¼š
   - å¯¦æ–½è¨ˆåŠƒå’Œé·ç§»è·¯å¾‘
   - Layer 0/1 å®šä½èªªæ˜

---

## ğŸ“š åƒè€ƒæ–‡æª”

- [AI-Box èªç¾©èˆ‡ä»»å‹™å·¥ç¨‹-è¨­è¨ˆèªªæ˜æ›¸-v4.md](../èªç¾©èˆ‡ä»»å‹™åˆ†æ/AI-Box èªç¾©èˆ‡ä»»å‹™å·¥ç¨‹-è¨­è¨ˆèªªæ˜æ›¸-v4.md) - v4 æ¶æ§‹å®Œæ•´è¨­è¨ˆèªªæ˜
- [Agent-Platform.md](../Agent-Platform.md) - ç•¶å‰æ–‡æª”ï¼ˆå…§éƒ¨ç‰ˆæœ¬ v4.0ï¼‰
- [Agent-Platform-v4-å‡ç´šè¨ˆåŠƒæ›¸.md](./Agent-Platform-v4-å‡ç´šè¨ˆåŠƒæ›¸.md) - å‡ç´šè¨ˆåŠƒæ›¸

---

**æœ€å¾Œæ›´æ–°æ—¥æœŸ**: 2026-01-13  
**ç¶­è­·äºº**: Daniel Chung
