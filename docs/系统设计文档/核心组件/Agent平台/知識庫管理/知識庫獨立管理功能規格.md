# çŸ¥è­˜åº«ç¨ç«‹ç®¡ç†åŠŸèƒ½è¦æ ¼

**è¦åŠƒæ—¥æœŸ**: 2026-02-12
**ç¶­è­·äºº**: Daniel Chung
**ç‰ˆæœ¬**: v1.0

---

## 1. èƒŒæ™¯èˆ‡å•é¡Œé™³è¿°

### 1.1 ç¾æœ‰æ¶æ§‹é™åˆ¶

ç¾æœ‰æ¶æ§‹ä¸­ï¼ŒçŸ¥è­˜åº«ä¸Šæ¶**ç¶å®šä»»å‹™ï¼ˆtask_idï¼‰**ï¼š

| é¢å‘     | ç¾æœ‰åšæ³•              | å•é¡Œ                                 |
| -------- | --------------------- | ------------------------------------ |
| ä¸Šæ¶å…¥å£ | ç¶å®š `*-Agent` ä»»å‹™ | çŸ¥è­˜åº«æ‡‰è©²æ˜¯ç¨ç«‹çš„ï¼Œä¸æ‡‰ç¶å®šä»»å‹™     |
| æ–‡ä»¶æ¨™è¨˜ | åªæœ‰ `task_id`      | ç„¡æ³•å€åˆ†ã€Œä»»å‹™æ–‡ä»¶ã€èˆ‡ã€ŒçŸ¥è­˜åº«æ–‡ä»¶ã€ |
| æ¬Šé™æ§åˆ¶ | åŸºæ–¼ `task_id` éš”é›¢ | çŸ¥è­˜åº«éœ€è¦ç¨ç«‹çš„æ¬Šé™é«”ç³»             |
| UI é«”é©—  | åœ¨ä»»å‹™ä¸‹ç®¡ç†æ–‡ä»¶      | çŸ¥è­˜åº«æ‡‰æœ‰ç¨ç«‹çš„ç®¡ç†ä»‹é¢             |

### 1.2 æ ¸å¿ƒå•é¡Œ

```
ç•¶å‰ä»»å‹™èŠå¤©å®¤é¸æ“‡ã€Œç¶“å¯¶ç‰©æ–™ç®¡ç†ä»£ç†ã€
    â†’ Agent æœ‰ `mm_agent_knowledge` capability
    â†’ KA-Agent æª¢ç´¢æ™‚æ‡‰è©²åªè¿”å› domain="mm_agent" çš„çŸ¥è­˜
    â†’ **ä½†æ²’æœ‰æ©Ÿåˆ¶ç¢ºä¿é€™å€‹å°æ‡‰é—œä¿‚**
```

**æ ¹æœ¬åŸå› **ï¼šä¸Šæ¶æ™‚æ²’æœ‰å»ºç«‹ã€Œcapability â†” domainã€çš„æ˜ç¢ºæ˜ å°„ã€‚

### 1.3 è§£æ±ºæ–¹æ¡ˆ

å¼•å…¥**çŸ¥è­˜åº«é¡å‹ï¼ˆfile_tree_typeï¼‰**æ¬„ä½ï¼š

| file_tree_type | èªªæ˜                     | ç¯„ä¾‹                            |
| -------------- | ------------------------ | ------------------------------- |
| `task`       | ä»»å‹™æ–‡ä»¶ï¼ˆç¶å®š task_idï¼‰ | ç”¨æˆ¶ä¸Šå‚³åˆ°ä»»å‹™çš„æ–‡ä»¶            |
| `knowledge`  | çŸ¥è­˜åº«æ–‡ä»¶ï¼ˆç¨ç«‹ç®¡ç†ï¼‰   | å°ˆæ¥­çŸ¥è­˜æ–‡ä»¶ï¼Œç¶å®š domain/major |

---

## 2. åŠŸèƒ½æ¦‚è¿°

### 2.1 æ–°å¢ UI å…¥å£

```
Header
â”œâ”€â”€ ç³»çµ±è¨­ç½®ï¼ˆå³ä¸‹é½’è¼ªï¼‰
â””â”€â”€ çŸ¥è­˜åº«ç®¡ç†ï¼ˆæ–°ï¼‰â† æ–°å¢
```

**åŠŸèƒ½**ï¼š

- é»æ“Šå¾Œé–‹å•Ÿç¨ç«‹çš„çŸ¥è­˜åº«ç®¡ç†è¦–çª—
- å·¦å´ Sidebarï¼šçŸ¥è­˜åº«ç›®éŒ„æ¨¹
- å³å´ï¼šæ–‡ä»¶åˆ—è¡¨ / é è¦½å€

### 2.2 çŸ¥è­˜åº«ç®¡ç†è¦–çª—çµæ§‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ çŸ¥è­˜åº«ç®¡ç†                                    [X] é—œé–‰    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                  â”‚                                         â”‚
â”‚  ğŸ“ æˆ‘çš„çŸ¥è­˜åº«    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”œâ”€â”€ ğŸ“ MM-Agent â”‚  â”‚ ğŸ” æœç´¢...                    ğŸ†• ä¸Šå‚³ â”‚ â”‚
â”‚  â”‚   â”œâ”€â”€ ğŸ“ spec â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚   â””â”€â”€ ğŸ“ docs â”‚  â”‚ æ–‡ä»¶åˆ—è¡¨                        â”‚  â”‚
â”‚  â””â”€â”€ ğŸ“ KA-Agent â”‚  â”‚ - ğŸ“„ åº«å­˜ç®¡ç†è¦ç¯„.md            â”‚  â”‚
â”‚                  â”‚  â”‚ - ğŸ“„ æ¡è³¼æµç¨‹èªªæ˜.pdf            â”‚  â”‚
â”‚  ğŸ”§ Ontology     â”‚  â”‚ - ğŸ“„ ç‰©æ–™åˆ†é¡æ¨™æº–.xlsx          â”‚  â”‚
â”‚                  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.3 æ ¸å¿ƒå·®ç•°

| é¢å‘     | ä»»å‹™æ–‡ä»¶ç®¡ç†ï¼ˆç¾æœ‰ï¼‰     | çŸ¥è­˜åº«ç®¡ç†ï¼ˆæ–°å¢ï¼‰                 |
| -------- | ------------------------ | ---------------------------------- |
| çµ„ç¹”æ–¹å¼ | æŒ‰ task_id çµ„ç¹”          | æŒ‰ domain/major çµ„ç¹”               |
| æ–‡ä»¶æ¨™è¨˜ | `file_tree_type: task` | `file_tree_type: knowledge`      |
| ä¸Šå‚³æµç¨‹ | é¸æ“‡ä»»å‹™ï¼Œä¸Šå‚³æ–‡ä»¶       | é¸æ“‡/å‰µå»ºç›®éŒ„ï¼Œé¸æ“‡ Ontologyï¼Œä¸Šå‚³ |
| æ¬Šé™æ§åˆ¶ | åŸºæ–¼ä»»å‹™                 | åŸºæ–¼çŸ¥è­˜åº«ç›®éŒ„                     |
| æª¢ç´¢éæ¿¾ | ä¸é©ç”¨                   | æ ¹æ“š agent capability è‡ªå‹•éæ¿¾     |

---

## 3. æ•¸æ“šæ¨¡å‹æ“´å±•

### 3.1 file_metadata æ–°å¢æ¬„ä½

```python
class FileMetadata:
    # ... ç¾æœ‰æ¬„ä½ ...

    # ========== æ–°å¢æ¬„ä½ ==========
    file_tree_type: str = "task"  # "task" | "knowledge"

    # çŸ¥è­˜åº«å°ˆå±¬æ¬„ä½ï¼ˆç•¶ file_tree_type == "knowledge" æ™‚ç”Ÿæ•ˆï¼‰
    knowledge_root_id: Optional[str] = None  # çŸ¥è­˜åº«æ ¹ç›®éŒ„ ID
    knowledge_parent_id: Optional[str] = None  # ä¸Šå±¤ç›®éŒ„ IDï¼ˆnull = æ ¹ç›®éŒ„ï¼‰
    ontology_domain: Optional[str] = None  # Ontology Domainï¼ˆå¦‚ "mm_agent"ï¼‰
    ontology_major: Optional[str] = None    # Ontology Majorï¼ˆå¦‚ "spec"ï¼‰
```

### 3.2 æ–°å¢ Collectionï¼šknowledge_roots

**ç›®çš„**ï¼šç®¡ç†çŸ¥è­˜åº«çš„æ ¹ç›®éŒ„çµæ§‹

```python
class KnowledgeRoot:
    _key: str  # root_idï¼ˆå¦‚ "mm_agent", "ka_agent", "default"ï¼‰
    name: str  # é¡¯ç¤ºåç¨±ï¼ˆå¦‚ "MM-Agent çŸ¥è­˜åº«"ï¼‰
    description: Optional[str] = None  # èªªæ˜
    owner_user_id: str  # å‰µå»ºç”¨æˆ¶
    ontology_domain: str  # ç¶å®šçš„ Ontology Domain
    ontology_majors: List[str]  # å…è¨±çš„ Major æ¸…å–®
    created_at: str
    updated_at: str
```

### 3.3 æ–°å¢ Collectionï¼šknowledge_folders

**ç›®çš„**ï¼šçŸ¥è­˜åº«ç›®éŒ„æ¨¹çµæ§‹

```python
class KnowledgeFolder:
    _key: str  # folder_idï¼ˆå¦‚ "mm_agent_spec_001"ï¼‰
    root_id: str  # æ‰€å±¬ KnowledgeRoot._key
    parent_id: Optional[str] = None  # ä¸Šå±¤ç›®éŒ„ï¼ˆnull = æ ¹ç›®éŒ„ï¼‰
    name: str  # ç›®éŒ„åç¨±
    path: str  # å®Œæ•´è·¯å¾‘ï¼ˆå¦‚ "/mm_agent/spec"ï¼‰
    ontology_domain: str  # ç¶å®šçš„ Domain
    ontology_major: str  # ç¶å®šçš„ Major
    created_by: str
    created_at: str
    updated_at: str
```

### 3.4 æ•¸æ“šé—œä¿‚åœ–

```
knowledge_roots (æ ¹ç›®éŒ„)
    â”‚
    â”œâ”€â”€ knowledge_folders (ç›®éŒ„æ¨¹)
    â”‚       â”‚
    â”‚       â”œâ”€â”€ folder_1 â”€â”€â†’ file_metadata (file_tree_type=knowledge)
    â”‚       â”‚
    â”‚       â””â”€â”€ folder_2 â”€â”€â†’ file_metadata (file_tree_type=knowledge)
    â”‚
    â””â”€â”€ knowledge_folders
            â”‚
            â””â”€â”€ folder_3 â”€â”€â†’ file_metadata (file_tree_type=knowledge)

file_metadata (file_tree_type=knowledge)
    â”œâ”€â”€ knowledge_root_id â†’ knowledge_roots._key
    â”œâ”€â”€ knowledge_parent_id â†’ knowledge_folders._key
    â”œâ”€â”€ ontology_domain
    â””â”€â”€ ontology_major
```

---

## 4. API è¨­è¨ˆ

### 4.1 æ–°å¢ API Endpoints

| Method | Endpoint                                  | èªªæ˜                             |
| ------ | ----------------------------------------- | -------------------------------- |
| GET    | `/api/v1/knowledge/roots`               | ç²å–çŸ¥è­˜åº«æ ¹ç›®éŒ„åˆ—è¡¨             |
| POST   | `/api/v1/knowledge/roots`               | å‰µå»ºçŸ¥è­˜åº«æ ¹ç›®éŒ„                 |
| PUT    | `/api/v1/knowledge/roots/{root_id}`     | æ›´æ–°æ ¹ç›®éŒ„                       |
| DELETE | `/api/v1/knowledge/roots/{root_id}`     | åˆªé™¤æ ¹ç›®éŒ„                       |
| GET    | `/api/v1/knowledge/folders`             | ç²å–ç›®éŒ„æ¨¹ï¼ˆå¯é¸ root_idï¼‰       |
| POST   | `/api/v1/knowledge/folders`             | å‰µå»ºç›®éŒ„                         |
| PUT    | `/api/v1/knowledge/folders/{folder_id}` | æ›´æ–°ç›®éŒ„                         |
| DELETE | `/api/v1/knowledge/folders/{folder_id}` | åˆªé™¤ç›®éŒ„                         |
| POST   | `/api/v1/knowledge/upload`              | **çŸ¥è­˜åº«æ–‡ä»¶ä¸Šå‚³**ï¼ˆæ ¸å¿ƒï¼‰ |
| GET    | `/api/v1/knowledge/files`               | ç²å–çŸ¥è­˜åº«æ–‡ä»¶åˆ—è¡¨               |
| GET    | `/api/v1/knowledge/files/{file_id}`     | ç²å–æ–‡ä»¶è©³æƒ…                     |
| DELETE | `/api/v1/knowledge/files/{file_id}`     | åˆªé™¤çŸ¥è­˜åº«æ–‡ä»¶                   |

### 4.2 æ ¸å¿ƒ APIï¼šçŸ¥è­˜åº«æ–‡ä»¶ä¸Šå‚³

```
POST /api/v1/knowledge/upload
Content-Type: multipart/form-data
```

**è«‹æ±‚åƒæ•¸**ï¼š

| åƒæ•¸                 | é¡å‹   | å¿…å¡« | èªªæ˜                       |
| -------------------- | ------ | ---- | -------------------------- |
| `files`            | File[] | âœ…   | è¦ä¸Šå‚³çš„æ–‡ä»¶               |
| `root_id`          | string | âœ…   | çŸ¥è­˜åº«æ ¹ç›®éŒ„ ID            |
| `parent_folder_id` | string | âŒ   | ä¸Šå±¤ç›®éŒ„ IDï¼ˆç©º = æ ¹ç›®éŒ„ï¼‰ |
| `ontology_domain`  | string | âœ…   | Ontology Domain            |
| `ontology_major`   | string | âœ…   | Ontology Major             |
| `user_id`          | string | âœ…   | ä¸Šå‚³ç”¨æˆ¶                   |

**éŸ¿æ‡‰**ï¼š

```json
{
  "success": true,
  "message": "æ–‡ä»¶ä¸Šå‚³æˆåŠŸ",
  "data": {
    "uploaded": [
      {
        "file_id": "kb_mm_agent_spec_001",
        "filename": "åº«å­˜ç®¡ç†è¦ç¯„.pdf",
        "ontology_domain": "mm_agent",
        "ontology_major": "spec",
        "file_tree_type": "knowledge",
        "knowledge_root_id": "mm_agent",
        "knowledge_parent_id": "mm_agent_spec"
      }
    ],
    "failed": []
  }
}
```

### 4.3 èˆ‡ç¾æœ‰ `/api/v1/files/v2/upload` çš„é—œä¿‚

| é¢å‘                | files/v2/upload  | knowledge/upload (æ–°)            |
| ------------------- | ---------------- | -------------------------------- |
| file_tree_type      | `task`         | `knowledge`                    |
| task_id             | å¿…å¡«             | ä¸ä½¿ç”¨                           |
| knowledge_root_id   | ä¸ä½¿ç”¨           | å¿…å¡«                             |
| knowledge_parent_id | ä¸ä½¿ç”¨           | å¿…å¡«                             |
| ontology_domain     | å¯é¸             | **å¿…å¡«**                   |
| ontology_major      | å¯é¸             | **å¿…å¡«**                   |
| pipeline            | åˆ†å¡Šâ†’å‘é‡â†’åœ–è­œ | åˆ†å¡Šâ†’å‘é‡â†’åœ–è­œâ†’**ç·¨ç¢¼** |
| ç”Ÿæˆ knw_code       | å¦               | **æ˜¯**                     |

---

## 5. å‰ç«¯è¦åŠƒ

### 5.1 æ–°å¢çµ„ä»¶

```
ai-bot/src/
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ KnowledgeBaseModal.tsx    # çŸ¥è­˜åº«ç®¡ç†ä¸»è¦–çª—
â”‚   â”œâ”€â”€ KnowledgeBaseSidebar.tsx  # å·¦å´ç›®éŒ„æ¨¹
â”‚   â”œâ”€â”€ KnowledgeBaseFileList.tsx  # å³å´æ–‡ä»¶åˆ—è¡¨
â”‚   â””â”€â”€ KnowledgeBaseUploadModal.tsx  # ä¸Šå‚³å½ˆçª—
â”œâ”€â”€ pages/
â”‚   â””â”€â”€ KnowledgeBase.tsx          # ç¨ç«‹é é¢ï¼ˆå¯é¸ï¼‰
â””â”€â”€ lib/
    â””â”€â”€ api.ts                     # æ–°å¢ knowledge API å‡½æ•¸
```

### 5.2 çŸ¥è­˜åº«ç®¡ç†ä¸»è¦–çª—ï¼ˆKnowledgeBaseModal.tsxï¼‰

```tsx
interface KnowledgeBaseModalProps {
  isOpen: boolean;
  onClose: () => void;
}

export default function KnowledgeBaseModal({ isOpen, onClose }: KnowledgeBaseModalProps) {
  const [selectedRoot, setSelectedRoot] = useState<KnowledgeRoot | null>(null);
  const [selectedFolder, setSelectedFolder] = useState<KnowledgeFolder | null>(null);

  return (
    <Modal size="large">
      <div className="flex h-[80vh]">
        {/* å·¦å´ï¼šçŸ¥è­˜åº«ç›®éŒ„æ¨¹ */}
        <KnowledgeBaseSidebar
          onSelectRoot={setSelectedRoot}
          onSelectFolder={setSelectedFolder}
        />

        {/* å³å´ï¼šæ–‡ä»¶åˆ—è¡¨ */}
        <KnowledgeBaseFileList
          root={selectedRoot}
          folder={selectedFolder}
          onUpload={() => openUploadModal()}
        />
      </div>
    </Modal>
  );
}
```

### 5.3 ä¸Šå‚³å½ˆçª—ï¼ˆKnowledgeBaseUploadModal.tsxï¼‰

```tsx
interface KnowledgeBaseUploadModalProps {
  isOpen: boolean;
  rootId: string;
  folderId?: string;
  onClose: () => void;
  onUploadComplete: () => void;
}

export default function KnowledgeBaseUploadModal({ ... }: KnowledgeBaseUploadModalProps) {
  const [selectedDomain, setSelectedDomain] = useState<string>('');
  const [selectedMajor, setSelectedMajor] = useState<string>('');

  // å¾ selectedRoot.ontology_majors ç²å–å¯é¸çš„ Major æ¸…å–®

  return (
    <Modal>
      {/* æ­¥é©Ÿ 1ï¼šé¸æ“‡ Ontology */}
      <Step1SelectOntology
        domains={availableDomains}
        majors={availableMajors[selectedDomain]}
        onSelect={(domain, major) => {}}
      />

      {/* æ­¥é©Ÿ 2ï¼šä¸Šå‚³æ–‡ä»¶ */}
      <Step2UploadFiles
        accept={ALLOWED_TYPES}
        maxSize={MAX_FILE_SIZE}
      />

      {/* æ­¥é©Ÿ 3ï¼šç¢ºèª */}
      <Step3Confirm />
    </Modal>
  );
}
```

### 5.4 Header å…¥å£

```tsx
// åœ¨ Header çµ„ä»¶ä¸­æ·»åŠ 
<button
  onClick={() => openKnowledgeBaseModal()}
  className="flex items-center gap-2 px-3 py-2 hover:bg-gray-100 rounded"
>
  <BookOpen className="w-5 h-5" />
  <span>çŸ¥è­˜åº«ç®¡ç†</span>
</button>
```

---

## 6. æ ¸å¿ƒé‚è¼¯ï¼šAgent èƒ½åŠ›èˆ‡çŸ¥è­˜åº«å°æ‡‰

### 6.1 ç¾æœ‰å•é¡Œ

```
Agent capability: mm_agent_knowledge
    â†“
Agent å¯ä»¥è¨ªå•å“ªäº›çŸ¥è­˜ï¼Ÿ
    â†“
**æ²’æœ‰æ˜ç¢ºå°æ‡‰**
```

### 6.2 è§£æ±ºæ–¹æ¡ˆï¼šcapability â†” domain æ˜ å°„

**æ–¹æ¡ˆï¼šAgent Registry å­˜å„² capability â†” domain æ˜ å°„**

```python
# agent_display_configs.capabilities æ“´å±•
{
  "id": "jingbao-mm-1",
  "capabilities": [
    "mm_agent_knowledge:mm_agent",      # å¯ä»¥è¨ªå• domain=mm_agent çš„çŸ¥è­˜
    "ka_agent_knowledge:ka_agent"       # å¯ä»¥è¨ªå• domain=ka_agent çš„çŸ¥è­˜ï¼ˆå¦‚æœéœ€è¦ï¼‰
  ]
}
```

### 6.3 æª¢ç´¢æ™‚çš„æ¬Šé™éæ¿¾ï¼ˆKA-Agentï¼‰

```python
# ka_agent/agent.py æª¢ç´¢æ™‚

def _get_allowed_domains(caller_agent_id: str) -> List[str]:
    """æ ¹æ“š Agent capability ç²å–å…è¨±è¨ªå•çš„ domains"""
    registry = get_agent_registry()
    agent_info = registry.get_agent_info(caller_agent_id)

    allowed_domains = []
    for cap in agent_info.capabilities:
        if cap.startswith("mm_agent_knowledge:"):
            domain = cap.split(":")[1]
            allowed_domains.append(domain)

    return allowed_domains

# æª¢ç´¢æ™‚éæ¿¾
def _query_knowledge_files(self, query: str, caller_agent_id: str):
    allowed_domains = self._get_allowed_domains(caller_agent_id)

    # åªè¿”å›é€™äº› domain çš„çŸ¥è­˜
    files = file_metadata_service.list(
        file_tree_type="knowledge",
        domain_in=allowed_domains,
        lifecycle_state="Active"
    )
```

### 6.4 å‰ç«¯é…ç½® UI

åœ¨ã€ŒAgent å¡ç‰‡é…ç½®ã€ä¸­ï¼Œèƒ½åŠ›é…ç½®æ”¹ç‚ºï¼š

```
âœ… mm_agent_knowledge:mm_agent  â† é¸æ“‡å¾Œè‡ªå‹•å°æ‡‰ domain
```

---

## 7. é·ç§»ç­–ç•¥

### 7.1 æ—¢æœ‰æ•¸æ“šè™•ç†

| æ•¸æ“š                             | è™•ç†æ–¹å¼                     |
| -------------------------------- | ---------------------------- |
| ç¾æœ‰ `task_id=KA-Agent` çš„æ–‡ä»¶ | ä¿æŒ `file_tree_type=task` |
| ç¾æœ‰ `task_id=MM-Agent` çš„æ–‡ä»¶ | ä¿æŒ `file_tree_type=task` |
| æ–°ä¸Šæ¶çš„çŸ¥è­˜åº«æ–‡ä»¶               | `file_tree_type=knowledge` |

### 7.2 é·ç§»è…³æœ¬ï¼ˆå¯é¸ï¼‰

```python
# å°‡æ—¢æœ‰ agent task æ–‡ä»¶é·ç§»ç‚ºçŸ¥è­˜åº«æ–‡ä»¶
# é©ç”¨å ´æ™¯ï¼šKA-Agentã€MM-Agent ç­‰ç³»çµ±ç´šçŸ¥è­˜

python scripts/migrate_task_to_knowledge.py \
  --task-id KA-Agent \
  --root-id "ka_agent" \
  --ontology-domain "ka_agent"
```

---

## 8. å¯¦æ–½è¨ˆåŠƒ

### Phase 1ï¼šæ•¸æ“šæ¨¡å‹èˆ‡ APIï¼ˆ1-2 å¤©ï¼‰

| é …ç›®                                  | è² è²¬äºº | é ä¼°å·¥æ™‚ |
| ------------------------------------- | ------ | -------- |
| æ“´å±• `file_metadata` æ¨¡å‹           | Daniel | 2 å°æ™‚   |
| å‰µå»º `knowledge_roots` collection   | Daniel | 2 å°æ™‚   |
| å‰µå»º `knowledge_folders` collection | Daniel | 2 å°æ™‚   |
| å¯¦ç¾ knowledge API endpoints          | Daniel | 4 å°æ™‚   |

### Phase 2ï¼šå¾Œç«¯æ ¸å¿ƒé‚è¼¯ï¼ˆ1-2 å¤©ï¼‰

| é …ç›®                                     | è² è²¬äºº | é ä¼°å·¥æ™‚ |
| ---------------------------------------- | ------ | -------- |
| ä¿®æ”¹ KA-Agent æª¢ç´¢é‚è¼¯ï¼ˆdomain éæ¿¾ï¼‰    | Daniel | 4 å°æ™‚   |
| å¯¦ç¾ knowledge upload pipeline           | Daniel | 4 å°æ™‚   |
| Agent Registry capability â†” domain æ˜ å°„ | Daniel | 2 å°æ™‚   |

### Phase 3ï¼šå‰ç«¯ UIï¼ˆ2-3 å¤©ï¼‰

| é …ç›®                          | è² è²¬äºº | é ä¼°å·¥æ™‚ |
| ----------------------------- | ------ | -------- |
| KnowledgeBaseModal çµ„ä»¶       | Daniel | 4 å°æ™‚   |
| KnowledgeBaseSidebar çµ„ä»¶     | Daniel | 2 å°æ™‚   |
| KnowledgeBaseUploadModal çµ„ä»¶ | Daniel | 4 å°æ™‚   |
| Header å…¥å£èˆ‡æ•´åˆ             | Daniel | 1 å°æ™‚   |

### Phase 4ï¼šæ¸¬è©¦èˆ‡å„ªåŒ–ï¼ˆ1 å¤©ï¼‰

| é …ç›®       | è² è²¬äºº | é ä¼°å·¥æ™‚ |
| ---------- | ------ | -------- |
| ç«¯åˆ°ç«¯æ¸¬è©¦ | Daniel | 4 å°æ™‚   |
| æ€§èƒ½å„ªåŒ–   | Daniel | 2 å°æ™‚   |
| æ–‡æª”æ›´æ–°   | Daniel | 2 å°æ™‚   |

**ç¸½é ä¼°**ï¼š7-9 å¤©

---

## 9. é¢¨éšªèˆ‡æ³¨æ„äº‹é …

| é¢¨éšª                  | å½±éŸ¿           | ç·©è§£æªæ–½                         |
| --------------------- | -------------- | -------------------------------- |
| æ—¢æœ‰ä»»å‹™æ–‡ä»¶è¢«èª¤æ“ä½œ  | æ–‡ä»¶ä¸Ÿå¤±       | çŸ¥è­˜åº«ç®¡ç†èˆ‡ä»»å‹™æ–‡ä»¶ç®¡ç†å®Œå…¨éš”é›¢ |
| domain/major é…ç½®éŒ¯èª¤ | çŸ¥è­˜ç„¡æ³•è¢«æª¢ç´¢ | ä¸Šå‚³æ™‚å¿…é¸ï¼Œæ ¼å¼é©—è­‰             |
| é·ç§»è…³æœ¬å‡ºéŒ¯          | æ•¸æ“šä¸ä¸€è‡´     | é·ç§»å‰å‚™ä»½ï¼Œæä¾›å›æ»¾è…³æœ¬         |

---

## 10. åƒè€ƒæ–‡æª”

- [Agent å°ˆæ¥­çŸ¥è­˜ä¸Šæ¶ç®¡ç†](./../../Agentå°ˆæ¥­çŸ¥è­˜çŸ¥è­˜ä¸Šæ¶ç®¡ç†.md)
- [KA-Agent è¦æ ¼æ›¸](./../KA-Agent/KA-Agent-è¦æ ¼æ›¸.md)
- [æ–‡ä»¶ä¸Šå‚³åŠŸèƒ½æ¶æ§‹èªªæ˜ v4.0](../../æ–‡ä»¶ä¸Šå‚³å‘é‡åœ–è­œ/ä¸Šå‚³çš„åŠŸèƒ½æ¶æ§‹èªªæ˜-v4.0.md)

---

**æœ€å¾Œæ›´æ–°æ—¥æœŸ**: 2026-02-12
**ç¶­è­·äºº**: Daniel Chung
