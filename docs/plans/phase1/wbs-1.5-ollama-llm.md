<!--
代碼功能說明: WBS 1.5 Ollama 與基礎 LLM 部署子計劃
創建日期: 2025-11-25 19:13 (UTC+8)
創建人: Daniel Chung
最後修改日期: 2025-11-25 19:13 (UTC+8)
-->

# WBS 1.5 Ollama 與基礎 LLM 部署子計劃

## 1. 背景與目標
- 建立本地 LLM 執行環境（Ollama）與 API 封裝，提供階段二 Agent 可用的推理與嵌入能力，工期 5 個工作日。

## 2. 範圍
- 安裝與硬體驗證（GPU/CPU）。
- 模型下載、資源管理、版本控管。
- LLM API、embedding API、負載均衡策略。

## 3. 工作拆解
| 任務編號 | 描述 | 負責人 | 工期 | 依賴 |
|---------|------|--------|------|------|
| 1.5.1 | Ollama 安裝配置、硬體驗證 | DevOps-1 | 0.5 天 | GPU 節點 |
| 1.5.2 | 模型下載與配置（主模型 + fallback） | DevOps-1 | 1 天 | 1.5.1 |
| 1.5.3 | Ollama API 封裝（REST/gRPC） | Backend-1 | 1.5 天 | 1.5.2 |
| 1.5.4 | Embedding 模型配置與 SDK 接口 | Backend-1 | 1 天 | 1.3, 1.5.3 |
| 1.5.5 | LLM 負載均衡策略（輪詢/加權/健康檢查） | Backend-1 | 1 天 | 1.5.3 |

## 4. 時間表（2025/12/02 - 2025/12/06）
- 12/02：完成 1.5.1，並撰寫硬體檢查報告。
- 12/03：完成 1.5.2，下載 baseline 模型與 embedding 模型。
- 12/04：完成 1.5.3 API 封裝（含測試）。
- 12/05：完成 1.5.4，與 ChromaDB SDK 驗證寫入/檢索。
- 12/06：完成 1.5.5，並以壓測工具驗證策略有效性。

## 5. 資源與交付物
- 資源：DevOps-1（安裝/資源）、Backend-1（API/策略）、AI-1（模型選型）。
- 交付物：
  - `infra/ollama/` 安裝手冊、校驗腳本。
  - LLM API 封裝程式與 README。
  - 負載均衡策略文件、壓測報告（RPS、延遲、失敗率）。

## 6. 風險與對策
- **GPU 資源不足**：建立排程與配額，必要時使用混合 CPU 模式。
- **模型大小造成部署延遲**：提前下載、啟用斷點續傳，並在 off-peak 時段進行。

## 7. 驗收標準
- Ollama 服務可啟動並通過健康檢查，模型加載時間在 120 秒內。
- API 封裝支援同步/非同步推理、溫度控制、回應超時機制。
- 負載均衡測試顯示平均延遲降低或保持穩定（差異 <10%）。

## 8. 更新紀錄
| 日期 | 說明 | 更新人 |
|------|------|--------|
| 2025-11-25 | 初版子計劃建立 | Daniel Chung |
