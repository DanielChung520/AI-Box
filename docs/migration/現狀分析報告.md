# 檔案系統轉結構遷移 - 現狀分析報告

## 文檔資訊

- **創建日期**: 2025-12-18
- **創建人**: Daniel Chung
- **最後修改日期**: 2025-12-18
- **版本**: 1.0

## 一、現有文件系統結構分析

### 1.1 Ontology 檔案盤點

**位置**: `kag/ontology/`

**檔案列表**:
1. `base.json` - 基礎本體論（5W1H_Base_Ontology_OWL, v3.0）
2. `domain-enterprise.json` - 企業領域本體論（Enterprise_Domain_Ontology, v1.0）
3. `domain-administration.json` - 行政管理領域本體論（Administration_Domain_Ontology, v1.0）
4. `major-manufacture.json` - 製造業專業本體論（Manufacture_Major_Ontology, v1.0）
5. `major-notioneditor.json` - Notion 編輯器專業本體論（Notion_Editor_Major_Ontology, v1.0）
6. `ontology_list.json` - Ontology 註冊表（用於快速索引和選擇）
7. `Prompt-Template.json` - 提示詞模板

**總計**: 7 個 JSON 檔案

### 1.2 Ontology 檔案結構分析

詳細結構分析已完成，見主計劃文檔。

### 1.3 Config 檔案盤點

**位置**: `config/`

**檔案列表**:
1. `config.json` - 主配置文件（實際使用）
2. `config.example.json` - 配置範本文件

### 1.4 Config 檔案層級關係

**配置層級**: 三層結構（system → tenant → user）

- **System 層**: `config/config.json`（文件系統）
- **Tenant 層**: ArangoDB `genai_tenant_policies` collection
- **User 層**: ArangoDB `genai_user_llm_secrets` collection

## 二、現有服務依賴分析

### 2.1 主要服務依賴

| 服務/模組 | 依賴類型 | 依賴文件 | 遷移優先級 |
|----------|---------|---------|----------|
| OntologyManager | 直接讀取 | `kag/ontology/*.json` (7個文件) | 高 |
| OntologySelector | 直接讀取 | `kag/ontology/ontology_list.json` | 高 |
| GenAIConfigResolverService | 間接讀取 | `config/config.json` (genai.policy) | 中 |
| GenAIModelRegistryService | 間接讀取 | `config/config.json` (genai.model_registry) | 中 |

## 三、多租戶現狀分析

### 3.1 多租戶實現狀態

- ✅ GenAITenantPolicyService - 已實現（ArangoDB）
- ✅ GenAIUserLLMSecretService - 已實現（ArangoDB）
- ❌ Ontology 多租戶 - 未實現（全局共享）
- ⚠️ Config System 層 - 部分實現（仍使用文件系統）
