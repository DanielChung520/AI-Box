# 代碼管制表「檔案數」說明

**最後更新**: 2026-02-04

---

## 為何管制表約 777 筆，而不是 2000+ 或全倉庫？

### 1. 管制表來源與範圍

- **代碼管制表**是由 `scripts/tools/generate_code_registry.py` 依**固定掃描範圍**產生的。
- 腳本只會掃描**指定目錄**內的 `.py` / `.ts` / `.tsx`，例如：
  - `api/`、`agents/`、`services/`、`llm/`、`genai/`、`database/`、`storage/`、`system/`、`workers/`、`mcp/`
  - 部分 `ai-bot/`、`datalake-system/`（多數會排除 `node_modules`）
  - 部分 `tests/`、`scripts/`、根目錄少數腳本
- **會排除**：`node_modules/`、`venv/`、`tests_backup/`、`backup/` 等（依腳本實作而定）。

因此，**777 是「納管範圍內」的檔案數**，不是全倉庫的檔案數。

### 2. 全倉庫實際源碼檔案數

- 若統計**整個專案**的 `.py` + `.ts` + `.tsx`（排除 `node_modules`、`venv`、`backup`、`tests_backup`）：
  - 約 **18,000+** 個檔案。
- 若只算**主要業務目錄**（api、agents、services、llm、genai、database、ai-bot、datalake-system、tests、tools 等，仍排除 node_modules/backup）：
  - 約 **1,300+** 個檔案。

所以：
- **777** = 管制表**目前掃描範圍**內的檔案數（與腳本設計一致）。
- **>2000** 若曾出現，可能是：  
  - 另一份報告或另一種統計口徑（例如「全倉庫」或「含 node_modules」），或  
  - 舊版腳本掃描範圍較大，或  
  - 把「代碼行數加總」誤看成「檔案數」。

### 3. 若希望管制表檔案數變多

- **做法一**：修改 `scripts/tools/generate_code_registry.py`，**擴大掃描目錄**（例如納入更多 `tests/`、`scripts/`、或前端完整路徑），再重新產生管制表。
- **做法二**：維持目前範圍，只把**新增的 API 路由或模組**手動／半自動補進管制表（例如先前補上的 23 筆 API 路由）。

---

## 總結

| 項目           | 數值 / 說明 |
|----------------|-------------|
| 管制表目前筆數 | **777**（納管範圍內） |
| 全倉庫 .py/.ts/.tsx | **約 18,000+**（排除 node_modules 等） |
| 主要目錄合計   | **約 1,300+** |
| 為何不是 2000+ | 管制表依腳本只掃描部分目錄；2000+ 可能來自不同統計或舊版範圍。 |

若你手上有「>2000 代碼文件」的截圖或檔案出處，可以貼出來，我可以對照是哪一種統計口徑並建議要不要調整掃描範圍。
