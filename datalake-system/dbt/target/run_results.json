{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.11.4", "generated_at": "2026-02-13T04:00:12.035712Z", "invocation_id": "f63c4aba-0512-46a6-9299-88ecd338bd3f", "invocation_started_at": "2026-02-13T04:00:07.500730Z", "env": {}}, "results": [{"status": "error", "timing": [{"name": "compile", "started_at": "2026-02-13T04:00:08.297398Z", "completed_at": "2026-02-13T04:00:08.302113Z"}, {"name": "execute", "started_at": "2026-02-13T04:00:08.302294Z", "completed_at": "2026-02-13T04:00:12.010701Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 3.7318475246429443, "adapter_response": {}, "message": "Runtime Error in model mart_shipping_wide (models/marts/mart_shipping_wide.sql)\n  HTTP Error: HTTP GET error reading 's3://tiptop-raw/raw/v1/tiptop_jp/XMDG_T/year=/?encoding-type=url&list-type=2&prefix=raw%2Fv1%2Ftiptop_jp%2FXMDG_T%2Fyear%3D' in region '' (HTTP 404 Not Found)\n  \n  LINE 54:     FROM read_parquet('s3://tiptop-raw/raw/v1/tiptop_jp/XMDG_T/year...\n                    ^", "failures": null, "unique_id": "model.tiptop_jp.mart_shipping_wide", "compiled": true, "compiled_code": "-- mart_shipping_wide.sql\n-- \u4ee3\u78bc\u529f\u80fd\u8aaa\u660e: \u51fa\u8ca8\u5bec\u8868 - \u5408\u4f75\u51fa\u8ca8\u982d\u6a94\u3001\u51fa\u8ca8\u660e\u7d30\u3001\u5ba2\u6236\u4e3b\u6a94\n-- \u5275\u5efa\u65e5\u671f: 2026-02-13\n-- \u5275\u5efa\u4eba: Daniel Chung\n\n\n\n-- \u5f9e S3 Parquet \u8b80\u53d6\u51fa\u8ca8\u8cc7\u6599\nWITH source_shipping AS (\n    SELECT\n        -- XMDG_T \u51fa\u8ca8\u982d\u6a94\u6b04\u4f4d\n        XMDGENT AS ent,\n        XMDGSITE AS site,\n        XMDGDOCNO AS doc_no,\n        XMDGDOCDT AS doc_date,\n        XMDGSTUS AS status,\n        XMDG002 AS sales_person,\n        XMDG003 AS sales_dept,\n        XMDG005 AS customer_no,\n        XMDG028 AS expected_date,\n        XMDG027 AS sales_category,\n\n        -- XMDH_T \u51fa\u8ca8\u660e\u7d30\u6b04\u4f4d\n        XMDHSEQ AS seq,\n        XMDH001 AS order_no,\n        XMDH002 AS so_line,\n        XMDH003 AS order_line_sn,\n        XMDH004 AS order_batch_seq,\n        XMDHUD001 AS customer_po_no,\n        XMDH006 AS item_no,\n        XMDH016 AS request_qty,\n        XMDH017 AS actual_qty,\n        XMDH023 AS unit_price,\n\n        -- OOEFT_T \u5ba2\u6236\u4e3b\u6a94\u6b04\u4f4d (LEFT JOIN)\n        ooef001 AS oo_customer_no,\n        ooef011 AS customer_name,\n        ooef017 AS customer_short_name,\n\n        -- MA_T \u7269\u6599\u4e3b\u6a94\u6b04\u4f4d (LEFT JOIN)\n        ma001 AS ma_item_no,\n        ma002 AS item_name,\n        ma003 AS item_spec\n    FROM read_parquet('s3://tiptop-raw/raw/v1/tiptop_jp/XMDG_T/year=*/month=*/data.parquet', hive_partitioning=true)\n    INNER JOIN read_parquet('s3://tiptop-raw/raw/v1/tiptop_jp/XMDH_T/year=*/month=*/data.parquet', hive_partitioning=true)\n        ON XMDGDOCNO = XMDHDOCNO\n    LEFT JOIN (\n        SELECT\n            ooef001,\n            ooef011,\n            ooef017\n        FROM read_parquet('s3://tiptop-raw/raw/v1/tiptop_jp/OEEF_T/year=*/month=*/data.parquet', hive_partitioning=true)\n    ) ON XMDG005 = ooef001\n    LEFT JOIN (\n        SELECT\n            ma001,\n            ma002,\n            ma003\n        FROM read_parquet('s3://tiptop-raw/raw/v1/tiptop_jp/MA_T/year=*/month=*/data.parquet', hive_partitioning=true)\n    ) ON XMDH006 = ma001\n),\n\nshipping_with_ranking AS (\n    SELECT\n        *,\n        ROW_NUMBER() OVER (PARTITION BY doc_no, seq ORDER BY actual_qty DESC) AS rn\n    FROM source_shipping\n)\n\nSELECT\n    md5(cast(coalesce(cast(doc_no as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(seq as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS shipping_key,\n    doc_no,\n    doc_date,\n    status,\n    sales_person,\n    sales_dept,\n    customer_no,\n    customer_name,\n    customer_short_name,\n    expected_date,\n    sales_category,\n    seq,\n    order_no,\n    so_line,\n    customer_po_no,\n    item_no,\n    ma_item_no,\n    item_name,\n    item_spec,\n    request_qty,\n    actual_qty,\n    unit_price,\n    request_qty * unit_price AS total_amount,\n    CURRENT_TIMESTAMP() AS _dbtloadedat\nFROM shipping_with_ranking\nWHERE rn = 1\n\n", "relation_name": "\"tiptop_jp\".\"main_mart\".\"mart_shipping_wide\"", "batch_results": null}, {"status": "error", "timing": [{"name": "compile", "started_at": "2026-02-13T04:00:08.299554Z", "completed_at": "2026-02-13T04:00:08.314106Z"}, {"name": "execute", "started_at": "2026-02-13T04:00:08.315784Z", "completed_at": "2026-02-13T04:00:12.011056Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 3.73514461517334, "adapter_response": {}, "message": "Runtime Error in model mart_work_order_wide (models/marts/mart_work_order_wide.sql)\n  HTTP Error: HTTP GET error reading 's3://tiptop-raw/raw/v1/tiptop_jp/SFAA_T/year=/?encoding-type=url&list-type=2&prefix=raw%2Fv1%2Ftiptop_jp%2FSFAA_T%2Fyear%3D' in region '' (HTTP 404 Not Found)\n  \n  LINE 44:     FROM read_parquet('s3://tiptop-raw/raw/v1/tiptop_jp/SFAA_T/year...\n                    ^", "failures": null, "unique_id": "model.tiptop_jp.mart_work_order_wide", "compiled": true, "compiled_code": "-- mart_work_order_wide.sql\n-- \u4ee3\u78bc\u529f\u80fd\u8aaa\u660e: \u5de5\u55ae\u5bec\u8868 - \u5408\u4f75\u5de5\u55ae\u982d\u6a94\u3001\u5ba2\u6236\u4e3b\u6a94\u3001\u7269\u6599\u4e3b\u6a94\n-- \u5275\u5efa\u65e5\u671f: 2026-02-13\n-- \u5275\u5efa\u4eba: Daniel Chung\n\n\n\n-- \u5f9e S3 Parquet \u8b80\u53d6\u5de5\u55ae\u8cc7\u6599\nWITH source_work_order AS (\n    SELECT\n        -- SFAA_T \u5de5\u55ae\u982d\u6a94\u6b04\u4f4d\n        SFAAENT AS ent,\n        SFAASITE AS site,\n        SFAA010 AS item_no,\n        SFAA056 AS scrap_qty,\n        SFAA022 AS so_order,\n        SFAA023 AS so_line,\n        SFAA024 AS order_line_sn,\n        SFAA025 AS order_batch_seq,\n        SFAA009 AS customer_no,\n        SFAA034 AS location_no,\n        SFAA035 AS warehouse_no,\n        SFAASTUS AS status,\n\n        -- OOEFT_T \u5ba2\u6236\u4e3b\u6a94\u6b04\u4f4d (LEFT JOIN)\n        ooef001 AS oo_customer_no,\n        ooef011 AS customer_name,\n        ooef017 AS customer_short_name,\n\n        -- MA_T \u7269\u6599\u4e3b\u6a94\u6b04\u4f4d (LEFT JOIN)\n        ma001 AS ma_item_no,\n        ma002 AS item_name,\n        ma003 AS item_spec\n    FROM read_parquet('s3://tiptop-raw/raw/v1/tiptop_jp/SFAA_T/year=*/month=*/data.parquet', hive_partitioning=true)\n    LEFT JOIN (\n        SELECT\n            ooef001,\n            ooef011,\n            ooef017\n        FROM read_parquet('s3://tiptop-raw/raw/v1/tiptop_jp/OEEF_T/year=*/month=*/data.parquet', hive_partitioning=true)\n    ) ON SFAA009 = ooef001\n    LEFT JOIN (\n        SELECT\n            ma001,\n            ma002,\n            ma003\n        FROM read_parquet('s3://tiptop-raw/raw/v1/tiptop_jp/MA_T/year=*/month=*/data.parquet', hive_partitioning=true)\n    ) ON SFAA010 = ma001\n),\n\nwork_order_with_ranking AS (\n    SELECT\n        *,\n        ROW_NUMBER() OVER (PARTITION BY item_no ORDER BY status DESC) AS rn\n    FROM source_work_order\n)\n\nSELECT\n    md5(cast(coalesce(cast(item_no as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_no as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(status as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS work_order_key,\n    item_no,\n    customer_no,\n    customer_name,\n    customer_short_name,\n    ma_item_no,\n    item_name,\n    item_spec,\n    warehouse_no,\n    location_no,\n    status,\n    scrap_qty,\n    so_order,\n    so_line,\n    CURRENT_TIMESTAMP() AS _dbtloadedat\nFROM work_order_with_ranking\nWHERE rn = 1\n\n", "relation_name": "\"tiptop_jp\".\"main_mart\".\"mart_work_order_wide\"", "batch_results": null}, {"status": "error", "timing": [{"name": "compile", "started_at": "2026-02-13T04:00:08.293389Z", "completed_at": "2026-02-13T04:00:08.313223Z"}, {"name": "execute", "started_at": "2026-02-13T04:00:08.314371Z", "completed_at": "2026-02-13T04:00:12.013650Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.7364509105682373, "adapter_response": {}, "message": "Runtime Error in model mart_inventory_wide (models/marts/mart_inventory_wide.sql)\n  HTTP Error: HTTP GET error reading 's3://tiptop-raw/raw/v1/tiptop_jp/INAG_T/year=/?encoding-type=url&list-type=2&prefix=raw%2Fv1%2Ftiptop_jp%2FINAG_T%2Fyear%3D' in region '' (HTTP 404 Not Found)\n  \n  LINE 37:     FROM read_parquet('s3://tiptop-raw/raw/v1/tiptop_jp/INAG_T/year...\n                    ^", "failures": null, "unique_id": "model.tiptop_jp.mart_inventory_wide", "compiled": true, "compiled_code": "-- mart_inventory_wide.sql\n-- \u4ee3\u78bc\u529f\u80fd\u8aaa\u660e: \u5eab\u5b58\u5bec\u8868 - \u5408\u4f75\u5eab\u5b58\u660e\u7d30\u8207\u7269\u6599\u4e3b\u6a94\n-- \u5275\u5efa\u65e5\u671f: 2026-02-13\n-- \u5275\u5efa\u4eba: Daniel Chung\n\n\n\n-- \u5f9e S3 Parquet \u8b80\u53d6\u5eab\u5b58\u8cc7\u6599\uff0c\u95dc\u806f MA \u7269\u6599\u4e3b\u6a94\nWITH source_inventory AS (\n    SELECT\n        -- INAG_T \u5eab\u5b58\u660e\u7d30\u6b04\u4f4d\n        ent,\n        site,\n        INAG001 AS item_no,\n        INAG004 AS warehouse_no,\n        INAG005 AS location_no,\n        INAG007 AS unit,\n        INAG008 AS existing_stocks,\n\n        -- MA_T \u7269\u6599\u4e3b\u6a94\u6b04\u4f4d (LEFT JOIN)\n        ma001 AS ma_item_no,\n        ma002 AS item_name,\n        ma003 AS item_spec,\n        ma025 AS item_type,\n        ma026 AS item_category,\n        ma027 AS stock_unit\n    FROM read_parquet('s3://tiptop-raw/raw/v1/tiptop_jp/INAG_T/year=*/month=*/data.parquet', hive_partitioning=true)\n    LEFT JOIN (\n        SELECT\n            ma001,\n            ma002,\n            ma003,\n            ma025,\n            ma026,\n            ma027\n        FROM read_parquet('s3://tiptop-raw/raw/v1/tiptop_jp/MA_T/year=*/month=*/data.parquet', hive_partitioning=true)\n    ) ON INAG001 = ma001\n),\n\ninventory_with_ranking AS (\n    SELECT\n        *,\n        ROW_NUMBER() OVER (PARTITION BY item_no ORDER BY existing_stocks DESC) AS rn\n    FROM source_inventory\n)\n\nSELECT\n    md5(cast(coalesce(cast(item_no as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(warehouse_no as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS inventory_key,\n    item_no,\n    warehouse_no,\n    location_no,\n    unit,\n    existing_stocks,\n    ma_item_no,\n    item_name,\n    item_spec,\n    item_type,\n    item_category,\n    stock_unit,\n    CURRENT_TIMESTAMP() AS _dbtloadedat\nFROM inventory_with_ranking\nWHERE rn = 1  -- \u53bb\u91cd\uff0c\u6bcf\u500b\u6599\u865f\u53ea\u4fdd\u7559\u4e00\u7b46\u8a18\u9304\n\n", "relation_name": "\"tiptop_jp\".\"main_mart\".\"mart_inventory_wide\"", "batch_results": null}], "elapsed_time": 3.813615322113037, "args": {"require_yaml_configuration_for_mf_time_spines": false, "upload_to_artifacts_ingest_api": false, "log_format_file": "debug", "log_level_file": "debug", "use_colors": true, "send_anonymous_usage_stats": true, "strict_mode": false, "show_resource_report": false, "validate_macro_args": false, "print": true, "require_nested_cumulative_type_params": false, "require_unique_project_resource_names": false, "profiles_dir": "/home/daniel/.dbt", "favor_state": false, "quiet": false, "log_path": "/home/daniel/ai-box/datalake-system/dbt/logs", "select": ["marts"], "show_all_deprecations": false, "introspect": true, "log_file_max_bytes": 10485760, "exclude": [], "require_generic_test_arguments_property": true, "state_modified_compare_more_unrendered_values": false, "write_json": true, "use_colors_file": true, "require_ref_searches_node_package_before_root": false, "partial_parse": true, "indirect_selection": "eager", "project_dir": "/home/daniel/ai-box/datalake-system/dbt", "printer_width": 80, "require_batched_execution_for_custom_microbatch_strategy": false, "cache_selected_only": false, "require_explicit_package_overrides_for_builtin_materializations": true, "require_resource_names_without_spaces": true, "empty": false, "partial_parse_file_diff": true, "state_modified_compare_vars": false, "invocation_command": "dbt run --select marts", "populate_cache": true, "require_all_warnings_handled_by_warn_error": false, "macro_debugging": false, "log_level": "info", "log_format": "default", "version_check": true, "source_freshness_run_project_hooks": true, "use_fast_test_edges": false, "warn_error_options": {"error": [], "warn": [], "silence": []}, "skip_nodes_if_on_run_start_fails": false, "vars": {}, "defer": false, "which": "run", "static_parser": true}}